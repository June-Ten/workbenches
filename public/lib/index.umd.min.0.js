(("undefined"!==typeof self?self:this)["webpackJsonpavueData"]=("undefined"!==typeof self?self:this)["webpackJsonpavueData"]||[]).push([[0],{"113a":function(e,t,i){},"20f7":function(e,t,i){"use strict";i.r(t);i("ac1f"),i("841c");var a=function(){var e=this,t=e._self._c;return e.searchList.length?t("el-row",{staticClass:"JNPF-common-search-box",attrs:{gutter:16}},[t("el-form",{nativeOn:{submit:function(e){e.preventDefault()}}},[e._l(e.searchList,(function(i,a){return t("el-col",{key:a,attrs:{span:6}},[t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:a<3||a>=3&&e.showAll,expression:"index<3 || (index>=3 && showAll)"}],attrs:{label:i.label}},[e.useInputList.indexOf(i.__config__.jnpfKey)>-1?[t("el-input",{staticClass:"item",attrs:{placeholder:"请输入"+i.label,clearable:""},model:{value:i.value,callback:function(t){e.$set(i,"value",t)},expression:"item.value"}})]:e.useDateList.indexOf(i.__config__.jnpfKey)>-1?[t("el-date-picker",{staticClass:"item",attrs:{"value-format":"timestamp",format:"yyyy-MM-dd HH:mm:ss","start-placeholder":"开始日期","end-placeholder":"结束日期",type:"datetimerange",clearable:""},model:{value:i.value,callback:function(t){e.$set(i,"value",t)},expression:"item.value"}})]:e.useSelectList.indexOf(i.__config__.jnpfKey)>-1?[t("el-select",{staticClass:"item",attrs:{placeholder:"请选择"+i.label,clearable:"",filterable:"",multiple:i.searchMultiple},model:{value:i.value,callback:function(t){e.$set(i,"value",t)},expression:"item.value"}},e._l(i.options,(function(e,a){return t("el-option",{key:a,attrs:{label:e[i.props.label],value:e[i.props.value]}})})),1)]:["inputNumber"===i.__config__.jnpfKey?[t("num-range",{attrs:{precision:i.precision},model:{value:i.value,callback:function(t){e.$set(i,"value",t)},expression:"item.value"}})]:e._e(),"calculate"===i.__config__.jnpfKey?[t("num-range",{attrs:{precision:i.precision||0},model:{value:i.value,callback:function(t){e.$set(i,"value",t)},expression:"item.value"}})]:e._e(),"cascader"===i.__config__.jnpfKey?[t("JnpfCascader",{staticClass:"item",attrs:{options:i.options,clearable:"","show-all-levels":i.showAllLevels,props:i.props,filterable:"",placeholder:"请选择"+i.label},model:{value:i.value,callback:function(t){e.$set(i,"value",t)},expression:"item.value"}})]:e._e(),"timePicker"===i.__config__.jnpfKey||"timeRange"===i.__config__.jnpfKey?[t("el-time-picker",{staticClass:"item",attrs:{"start-placeholder":"开始时间","end-placeholder":"结束时间",clearable:"","value-format":i.format,format:i.format,"is-range":""},model:{value:i.value,callback:function(t){e.$set(i,"value",t)},expression:"item.value"}})]:e._e(),"datePicker"===i.__config__.jnpfKey?[t("JnpfDateRangePicker",{staticClass:"item",attrs:{type:i.type,clearable:"",format:i.format,startPlaceholder:"开始日期",endPlaceholder:"结束日期"},model:{value:i.value,callback:function(t){e.$set(i,"value",t)},expression:"item.value"}})]:e._e(),"dateRange"===i.__config__.jnpfKey?[t("el-date-picker",{staticClass:"item",attrs:{type:i.type,clearable:"","value-format":"timestamp",format:i.format,"start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:i.value,callback:function(t){e.$set(i,"value",t)},expression:"item.value"}})]:e._e(),"areaSelect"===i.__config__.jnpfKey?[t("JnpfAreaSelect",{staticClass:"item",attrs:{placeholder:"请选择"+i.label,level:i.level,clearable:""},model:{value:i.value,callback:function(t){e.$set(i,"value",t)},expression:"item.value"}})]:e._e(),"treeSelect"===i.__config__.jnpfKey?[t("JnpfTreeSelect",{staticClass:"item",attrs:{placeholder:"请选择"+i.label,options:i.options,props:i.props,clearable:""},model:{value:i.value,callback:function(t){e.$set(i,"value",t)},expression:"item.value"}})]:e._e(),"createUser"===i.__config__.jnpfKey||"modifyUser"===i.__config__.jnpfKey?[t("JnpfUserSelect",{staticClass:"item",attrs:{placeholder:"请选择"+i.label,clearable:"",ableIds:i.ableIds,selectType:i.selectType},model:{value:i.value,callback:function(t){e.$set(i,"value",t)},expression:"item.value"}})]:e._e(),"currOrganize"===i.__config__.jnpfKey||"organizeSelect"===i.__config__.jnpfKey?[t("JnpfOrganizeSelect",{staticClass:"item",attrs:{placeholder:"请选择"+i.label,clearable:"",multiple:i.searchMultiple,ableIds:i.ableIds,selectType:i.selectType},model:{value:i.value,callback:function(t){e.$set(i,"value",t)},expression:"item.value"}})]:e._e(),"currDept"===i.__config__.jnpfKey?[t("JnpfDepSelect",{staticClass:"item",attrs:{placeholder:"请选择"+i.label,clearable:"",ableIds:i.ableIds,selectType:i.selectType},model:{value:i.value,callback:function(t){e.$set(i,"value",t)},expression:"item.value"}})]:e._e(),"currPosition"===i.__config__.jnpfKey||"posSelect"===i.__config__.jnpfKey?[t("JnpfPosSelect",{staticClass:"item",attrs:{placeholder:"请选择"+i.label,clearable:"",multiple:i.searchMultiple,ableIds:i.ableIds,selectType:i.selectType},model:{value:i.value,callback:function(t){e.$set(i,"value",t)},expression:"item.value"}})]:e._e(),"groupSelect"===i.__config__.jnpfKey?[t("JnpfGroupSelect",{staticClass:"item",attrs:{placeholder:"请选择"+i.label,clearable:"",multiple:i.searchMultiple,selectType:i.selectType,ableIds:i.ableIds},model:{value:i.value,callback:function(t){e.$set(i,"value",t)},expression:"item.value"}})]:e._e(),"roleSelect"===i.__config__.jnpfKey?[t("JnpfRoleSelect",{staticClass:"item",attrs:{placeholder:"请选择"+i.label,clearable:"",multiple:i.searchMultiple,selectType:i.selectType,ableIds:i.ableIds},model:{value:i.value,callback:function(t){e.$set(i,"value",t)},expression:"item.value"}})]:e._e(),"userSelect"===i.__config__.jnpfKey?[t("JnpfUserSelect",{staticClass:"item",attrs:{placeholder:"请选择"+i.label,clearable:"",selectType:"all"!=i.selectType&&"custom"!=i.selectType?"all":i.selectType,ableIds:i.ableIds,multiple:i.searchMultiple},model:{value:i.value,callback:function(t){e.$set(i,"value",t)},expression:"item.value"}})]:e._e(),"usersSelect"===i.__config__.jnpfKey?[t("JnpfUsersSelect",{staticClass:"item",attrs:{placeholder:"请选择"+i.label,clearable:"",selectType:i.selectType,ableIds:i.ableIds,multiple:i.searchMultiple},model:{value:i.value,callback:function(t){e.$set(i,"value",t)},expression:"item.value"}})]:e._e(),"depSelect"===i.__config__.jnpfKey?[t("JnpfDepSelect",{staticClass:"item",attrs:{placeholder:"请选择"+i.label,clearable:"",selectType:i.selectType,ableIds:i.ableIds,multiple:i.searchMultiple},model:{value:i.value,callback:function(t){e.$set(i,"value",t)},expression:"item.value"}})]:e._e(),"autoComplete"===i.__config__.jnpfKey?[t("JnpfAutoComplete",{staticClass:"item",attrs:{placeholder:"请输入"+i.label,total:i.total,clearable:"",relationField:i.relationField,templateJson:i.templateJson,interfaceId:i.interfaceId},model:{value:i.value,callback:function(t){e.$set(i,"value",t)},expression:"item.value"}})]:e._e()]],2)],1)})),t("el-col",{attrs:{span:6}},[t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.search()}}},[e._v(e._s(e.$t("common.search"))+" ")]),t("el-button",{attrs:{icon:"el-icon-refresh-right"},on:{click:function(t){return e.reset()}}},[e._v(e._s(e.$t("common.reset"))+" ")]),e.searchList.length>3?[e.showAll?t("el-button",{attrs:{type:"text",icon:"el-icon-arrow-up"},on:{click:function(t){e.showAll=!1}}},[e._v(" 收起")]):t("el-button",{attrs:{type:"text",icon:"el-icon-arrow-down"},on:{click:function(t){e.showAll=!0}}},[e._v(" 展开 ")])]:e._e()],2)],1)],2)],1):e._e()},n=[],o=(i("b64b"),i("d3b7"),i("159b"),i("e9c4"),i("ed08")),l=i("100e"),r=i("9b6f"),s=i("17de"),c={props:["list","initDataJson"],data:function(){return{showAll:!1,searchList:[],useInputList:l["useInputList"],useDateList:l["useDateList"],useSelectList:l["useSelectList"],defSearchList:[]}},watch:{list:{handler:function(e){this.searchList=Object(o["b"])(e),this.defSearchList=Object(o["b"])(e),this.buildOptions(this.searchList)},deep:!0,immediate:!0},initDataJson:{handler:function(e){if(""!=e){var t=JSON.parse(e);if(Object.keys(t).length>0)for(var i in t)for(var a=0;a<this.searchList.length;a++){var n=this.searchList[a];if(n.id===i){n.searchMultiple?"organizeSelect"==n.jnpfKey?n.value=Array.isArray(t[i])&&Array.isArray(t[i][0])?t[i]:[t[i]]:n.value=Array.isArray(t[i])?t[i]:[t[i]]:n.value=t[i];break}}}}}},methods:{buildOptions:function(e){e.forEach((function(e){var t=e.__config__;if(l["dyOptionsList"].indexOf(t.jnpfKey)>-1&&("dictionary"===t.dataType&&t.dictionaryType&&(e.options=[],Object(r["i"])(t.dictionaryType).then((function(t){e.options=t.data.list}))),"dynamic"===t.dataType&&t.propsUrl)){e.options=[];var i={paramList:t.templateJson||[]};Object(s["i"])(t.propsUrl,i).then((function(t){e.options=Array.isArray(t.data)?t.data:[]}))}}))},search:function(){for(var e={},t=0;t<this.searchList.length;t++){var i=this.searchList[t];i.value&&(Array.isArray(i.value)?i.value.length&&(e[i.id]=i.value):e[i.id]=i.value)}var a="{}"===JSON.stringify(e)?"":JSON.stringify(e);this.$emit("search",a)},reset:function(){this.treeReset(),this.$emit("reset")},treeReset:function(){for(var e=0;e<this.defSearchList.length;e++)this.defSearchList[e].value&&(this.searchList[e].value=this.defSearchList[e].value)}}},d=c,u=i("2877"),p=Object(u["a"])(d,a,n,!1,null,null,null);t["default"]=p.exports},"34e8":function(e,t,i){"use strict";i.r(t);i("d3b7"),i("c7cd");var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"JNPF-common-layout"},[t("div",{staticClass:"JNPF-common-layout-center"},[t("Search",{ref:"Search",attrs:{list:e.columnData.searchList},on:{reset:e.reset,search:e.searchData}}),t("div",{staticClass:"JNPF-common-layout-main JNPF-flex-main"},[t("div",{staticClass:"JNPF-common-head"},[e.isPreview||!e.columnData.useBtnPermission?t("div",e._l(e.columnData.btnsList,(function(i,a){return t("el-button",{key:a,attrs:{type:0==a?"primary":"text",icon:i.icon},on:{click:function(t){return e.headBtnsHandel(i.value)}}},[e._v(" "+e._s(i.label))])})),1):t("div",e._l(e.columnData.btnsList,(function(i,a){return t("el-button",{directives:[{name:"has",rawName:"v-has",value:"btn_"+i.value,expression:"'btn_'+item.value"}],key:a,attrs:{type:0==a?"primary":"text",icon:i.icon},on:{click:function(t){return e.headBtnsHandel(i.value)}}},[e._v(" "+e._s(i.label))])})),1),t("div",{staticClass:"JNPF-common-head-right"},[t("el-tooltip",{attrs:{effect:"dark",content:e.$t("common.refresh"),placement:"top"}},[t("el-link",{attrs:{icon:"icon-ym icon-ym-Refresh JNPF-common-head-icon",underline:!1},on:{click:function(t){return e.initData()}}})],1)],1)]),e.refreshTable?t("JNPF-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"tableRef",attrs:{data:e.list,"row-key":"id","default-expand-all":2!==e.columnData.childTableStyle&&e.expandsTable,"tree-props":{children:"children",hasChildren:""},load:e.treeLoad,"row-style":e.rowStyle,"cell-style":e.cellStyle,"has-c":e.hasBatchBtn,"custom-column":"","span-method":e.arraySpanMethod,hasNO:!(2==e.columnData.childTableStyle&&e.childColumnList.length&&3!=e.columnData.type&&4!=e.columnData.type),hasNOFixed:e.columnList.some((function(e){return"left"==e.fixed})),"show-summary":e.columnData.showSummary&&!(3==e.columnData.type||5==e.columnData.type),"summary-method":e.getTableSummaries},on:{"sort-change":e.sortChange,"selection-change":e.handleSelectionChange}},[[e._l(e.columnList,(function(i,a){return["complexHeader"==i.jnpfKey?[t("el-table-column",{key:a,attrs:{prop:i.id,label:i.label,align:i.align}},[e._l(i.children,(function(e){return[t("el-table-column",{key:e.prop,attrs:{prop:e.id,label:e.label,align:e.align,width:e.width}})]}))],2)]:t("el-table-column",{key:a,attrs:{prop:i.prop,label:i.label,align:i.align,fixed:e.getFixed(i,a),width:i.width,sortable:i.sortable?"custom":i.sortable}})]}))],e.columnBtnsList.length||e.customBtnsList.length?t("el-table-column",{attrs:{label:"操作",fixed:(2!=e.columnData.childTableStyle||!e.childColumnList.length)&&"right",width:80},scopedSlots:e._u([{key:"default",fn:function(i){return i.row.top?void 0:[e.customBtnsList.length?[t("el-dropdown",{attrs:{"hide-on-click":""}},[t("span",{staticClass:"el-dropdown-link"},[t("el-button",{attrs:{type:"text",size:"mini"}},[e._v(" "+e._s(e.$t("common.moreBtn"))),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})])],1),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.customBtnsList,(function(a,n){return t("el-dropdown-item",{key:n,nativeOn:{click:function(t){return e.customBtnsHandel(a,i.row,i.$index)}}},[e._v(e._s(a.label)+" ")])})),1)],1)]:e._e()]}}],null,!0)}):e._e()],2):e._e(),3!==e.columnData.type&&5!==e.columnData.type&&e.columnData.hasPage&&e.refreshTable?[t("pagination",{attrs:{total:e.total,page:e.listQuery.currentPage,limit:e.listQuery.pageSize},on:{"update:page":function(t){return e.$set(e.listQuery,"currentPage",t)},"update:limit":function(t){return e.$set(e.listQuery,"pageSize",t)},pagination:e.initData}})]:e._e()],2)],1),e.exportBoxVisible?t("ExportBox",{ref:"ExportBox",on:{download:e.download}}):e._e(),e.customBoxVisible?t("CustomBox",{ref:"CustomBox",on:{close:function(t){e.customBoxVisible=!1}}}):e._e()],1)},n=[],o=i("ade3"),l=i("2909"),r=i("5530"),s=i("c7eb"),c=i("1da1"),d=(i("4de4"),i("4e82"),i("d81d"),i("e9c4"),i("159b"),i("caad"),i("2532"),i("a9e3"),i("b680"),i("13d5"),i("14d9"),i("ac1f"),i("5319"),i("3c65"),i("841c"),i("a434"),i("ef22")),u=i("826a4"),p=i("9b6f"),f=i("17de"),m=i("2934"),h=i("e200"),b=i("20f7"),_=i("0c2e"),g=i("1374"),y={name:"dynamicModel",props:["config","modelId","isPreview"],components:{Search:b["default"],ExportBox:_["default"],CustomBox:g["default"]},data:function(){return{keyword:"",treeProps:{children:"children",label:"fullName",value:"id",isLeaf:"isLeaf"},list:[],cacheList:[],total:0,listLoading:!1,listQuery:{currentPage:1,pageSize:20,sort:"desc",sidx:"",menuId:"",queryJson:"",superQueryJson:""},defaultListQuery:{pageSize:20,sort:"desc",sidx:""},treeData:[],expandsTree:!0,treeActiveId:"",columnData:{columnBtnsList:[]},formData:{},columnList:[],childColumnList:[],columnOptions:[],exportList:[],columnBtnsList:[],customBtnsList:[],hasBatchBtn:!1,refreshTable:!1,expandsTable:!0,multipleSelection:[],settingsColumnList:[],mergeList:[],expandObj:{},flowTemplateJson:{},isCustomCopy:!1,candidateVisible:!1,candidateType:1,branchList:[],candidateList:[],currRow:{},workFlowFormData:{},rowStyle:null,cellStyle:null,refreshTree:!0,exportBoxVisible:!1,customBoxVisible:!1}},watch:{keyword:function(e){1==this.columnData.treeMethod&&this.$refs.treeBox.filter(e)}},created:function(){this.init()},methods:{init:function(){var e=this;return Object(c["a"])(Object(s["a"])().mark((function t(){var i,a,n;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.listLoading=!0,e.listQuery.menuId=e.$route.meta.modelId,e.refreshTable=!1,e.config.columnData){t.next=5;break}return t.abrupt("return");case 5:if(e.columnData=JSON.parse(e.config.columnData),4==e.config.webType)for(i=0;i<e.columnData.searchList.length;i++)a=e.columnData.searchList[i],a.__config__.jnpfKey="input";return 3===e.columnData.type&&(e.columnData.columnList=e.columnData.columnList.filter((function(t){return t.prop!=e.columnData.groupField}))),1==e.config.enableFlow&&(e.flowTemplateJson=e.config.flowTemplateJson?JSON.parse(e.config.flowTemplateJson):{},e.isCustomCopy=e.flowTemplateJson.properties&&e.flowTemplateJson.properties.isCustomCopy),e.customBtnsList=e.columnData.customBtnsList||[],e.columnBtnsList=e.columnData.columnBtnsList||[],e.listLoading=!0,e.isPreview&&(e.listQuery.menuId="270579315303777093"),t.next=15,Object(m["c"])(e.listQuery.menuId);case 15:if(n=t.sent,e.settingsColumnList=n.data||[],e.rowStyle=e.jnpf.getScriptFunc.call(e,e.columnData.funcs&&e.columnData.funcs.rowStyle),e.cellStyle=e.jnpf.getScriptFunc.call(e,e.columnData.funcs&&e.columnData.funcs.cellStyle),e.getColumnList(),e.$nextTick((function(){e.refreshTable=!0})),!e.isPreview){t.next=23;break}return t.abrupt("return",e.listLoading=!1);case 23:e.listQuery.pageSize=e.columnData.pageSize,e.listQuery.sort=e.columnData.sort,e.listQuery.sidx=e.columnData.defaultSidx,e.defaultListQuery.pageSize=e.columnData.pageSize,e.defaultListQuery.sort=e.columnData.sort,e.defaultListQuery.sidx=e.columnData.defaultSidx,3!==e.columnData.type&&e.columnData.hasPage||(e.listQuery.pageSize=1e4),e.initData();case 31:case"end":return t.stop()}}),t)})))()},initData:function(){var e=this;this.isPreview||(this.listLoading=!0,Object(d["s"])(this.modelId,this.listQuery).then((function(t){4===e.columnData.type?(e.list=t.data.list.map((function(t){return Object(r["a"])(Object(r["a"])(Object(r["a"])({},t),e.expandObj),{},{rowEdit:!1})})),e.cacheList=JSON.parse(JSON.stringify(e.list))):e.list=t.data.list.map((function(t){return Object(r["a"])(Object(r["a"])(Object(r["a"])({},t),e.expandObj),{},{hasChildren:!0})})),3!==e.columnData.type&&e.columnData.hasPage&&(e.total=t.data.pagination.total),e.listLoading=!1,e.$nextTick((function(){e.columnData.funcs&&e.columnData.funcs.afterOnload&&e.setTableLoadFunc()}))})).catch((function(){e.listLoading=!1})))},getTreeView:function(){var e=this;if("dictionary"===this.columnData.treeDataSource){if(!this.columnData.treeDictionary)return;Object(p["i"])(this.columnData.treeDictionary).then((function(t){e.treeData=t.data.list,e.initData()}))}if("organize"===this.columnData.treeDataSource&&this.$store.dispatch("generator/getDepTree").then((function(t){e.treeData=t,e.initData()})),"department"===this.columnData.treeDataSource&&this.$store.dispatch("generator/getDepTree").then((function(t){e.treeData=t,e.initData()})),"api"===this.columnData.treeDataSource){if(!this.columnData.treePropsUrl)return;Object(f["i"])(this.columnData.treePropsUrl).then((function(t){var i=t.data;Array.isArray(i)?e.treeData=i:e.treeData=[],e.initData()}))}},getTableSummaries:function(e){var t=this,i=e.columns,a=e.data,n=[];return i.forEach((function(e,i){if(0!==i){if(t.columnData.summaryField.includes(e.property)){var o=a.map((function(t){return Number(t[e.property])}));o.every((function(e){return isNaN(e)}))?n[i]="":n[i]=o.reduce((function(e,t){var i=Number(t);return isNaN(i)?e:e+t}),0).toFixed(2)}}else n[i]="合计"})),n},getColumnList:function(){if(this.isPreview){var e=this.columnData.columnList;this.columnList=this.transformColumnList(e)}else{var t=[];if(this.columnData.useColumnPermission){for(var i=this.$store.getters.permissionList,a=this.$route.meta.modelId,n=i.filter((function(e){return e.modelId===a})),o=n[0]&&n[0].column?n[0].column:[],l=0;l<this.columnData.columnList.length;l++)e:for(var r=0;r<o.length;r++)if(this.columnData.columnList[l].prop===o[r].enCode){t.push(this.columnData.columnList[l]);break e}}else t=this.columnData.columnList;[3,5].includes(this.columnData.type)||(t=this.getComplexColumns(t)),this.columnList=this.transformColumnList(t)}},getComplexColumns:function(e){var t=this.columnData.complexHeaderList||[];if(!t.length)return e;for(var i=[],a=0;a<t.length;a++){var n=t[a];if(n.label=n.fullName,n.align=n.align,n.dataIndex=n.id,n.prop=n.id,n.children=[],n.jnpfKey="complexHeader",n.sortable=!1,n.childColumns&&n.childColumns.length){i.push.apply(i,Object(l["a"])(n.childColumns));for(var o=0;o<e.length;o++){var s=e[o];n.childColumns.includes(s.id)&&"left"!==s.fixed&&"right"!==s.fixed&&n.children.push(Object(r["a"])({},s))}}}t=t.filter((function(e){return e.children.length}));for(var c=0;c<e.length;c++){var d=e[c];i.includes(d.id)||t.push(d)}return console.log(t),t},transformColumnList:function(e){for(var t=this,i=[],a=0;a<e.length;a++){var n=e[a];n.prop.includes("-")?function(){var e=n.prop.split("-")[0],a=n.prop.split("-")[1],o=n.label.split("-")[0],l=n.label.replace(o+"-",""),r={align:"center",jnpfKey:"table",prop:e,label:o,children:[]};n.vModel=a,n.childLabel=l,t.expandObj.hasOwnProperty("".concat(e,"Expand"))||t.$set(t.expandObj,"".concat(e,"Expand"),!1),i.some((function(t){return t.prop===e}))||i.push(r);for(var s=0;s<i.length;s++)if(i[s].prop===e){i[s].children.push(n);break}}():i.push(n)}return this.getMergeList(i),this.getExportList(i),this.childColumnList=i.filter((function(e){return"table"===e.jnpfKey})),i},getExportList:function(e){for(var t=[],i=0;i<e.length;i++)"table"===e[i].jnpfKey?4!=this.columnData.type&&t.push.apply(t,Object(l["a"])(e[i].children)):"complexHeader"===e[i].jnpfKey?t.push.apply(t,Object(l["a"])(e[i].children)):t.push(e[i]);this.exportList=t},getMergeList:function(e){var t=this;e.forEach((function(e){e.children&&e.children.length>0&&"table"==e.jnpfKey?e.children.forEach((function(i,a){0==a?t.mergeList.push({prop:i.prop,rowspan:1,colspan:e.children.length}):t.mergeList.push({prop:i.prop,rowspan:0,colspan:0})})):t.mergeList.push({prop:e.prop,rowspan:1,colspan:1})}))},arraySpanMethod:function(e){for(var t=e.column,i=0;i<this.mergeList.length;i++)if(t.property==this.mergeList[i].prop)return[this.mergeList[i].rowspan,this.mergeList[i].colspan]},toggleExpand:function(e,t){e[t]=!e[t]},getNodePath:function(e){var t=[],i=function e(i){i.level&&t.unshift(i.data),i.parent&&e(i.parent)};return i(e),t},handleNodeClick:function(e,t){var i=this;if(this.treeActiveId!=e[this.treeProps.value]){this.treeActiveId=e[this.treeProps.value],this.$refs.Search.treeReset();var a={};if("organize"===this.columnData.treeDataSource){var n=this.getNodePath(t),l=n.map((function(e){return e[i.treeProps.value]}));a=Object(o["a"])({},this.columnData.treeRelation,l),this.treeActiveId=l}else a=Object(o["a"])({},this.columnData.treeRelation,e[this.treeProps.value]);this.search(JSON.stringify(a))}},handleDel:function(e,t){var i=this;this.$confirm(this.$t("common.delTip"),this.$t("common.tipTitle"),{type:"warning"}).then((function(){e?Object(d["j"])(i.modelId,e).then((function(e){i.$message({type:"success",message:e.msg,duration:1e3,onClose:function(){i.initData()}})})):i.list.splice(t,1)})).catch((function(){}))},saveForRowEdit:function(e,t,i){var a=this;if(this.isPreview)return this.$message({message:"功能预览不支持数据保存",type:"warning"});if(1==this.config.enableFlow){var n={id:e.id,status:t||"1",candidateType:this.candidateType,formData:e,flowId:this.config.flowId,flowUrgent:1};i&&(n=Object(r["a"])(Object(r["a"])({},n),i));var o=n.id?u["c"]:u["a"];o(n).then((function(e){a.$message({message:e.msg,type:"success",duration:1500,onClose:function(){a.candidateVisible=!1,a.initData()}})}))}else{var l={id:e.id,data:JSON.stringify(e)},s=l.id?d["y"]:d["i"];s(this.modelId,l).then((function(e){a.$message({message:e.msg,type:"success",duration:1500,onClose:function(){a.candidateVisible=!1,a.initData()}})}))}},submitForRowEdit:function(e){var t=this;if(this.currRow=e,this.isPreview)return this.$message({message:"功能预览不支持数据保存",type:"warning"});this.workFlowFormData={id:e.id,formData:e,flowId:this.config.flowId},Object(h["g"])(0,this.workFlowFormData).then((function(i){var a=i.data;if(t.candidateType=a.type,1==a.type)t.branchList=i.data.list.filter((function(e){return e.isBranchFlow})),t.candidateList=i.data.list.filter((function(e){return!e.isBranchFlow&&e.isCandidates})),t.candidateVisible=!0;else if(2==a.type)t.branchList=[],t.candidateList=i.data.list.filter((function(e){return e.isCandidates})),t.candidateVisible=!0;else{if(t.isCustomCopy)return t.branchList=[],t.candidateList=[],void(t.candidateVisible=!0);t.$confirm("您确定要提交当前流程吗, 是否继续?","提示",{type:"warning"}).then((function(){t.saveForRowEdit(e,"0")})).catch((function(){}))}})).catch((function(){}))},submitCandidate:function(e){this.saveForRowEdit(this.currRow,"0",e)},cancelRowEdit:function(e,t){if(!e.id)return this.list.splice(t,1);e.rowEdit=!1;var i=JSON.parse(JSON.stringify(this.cacheList[t]));this.$set(this.list,t,i)},handleSelectionChange:function(e){var t=e.map((function(e){return e.id}));this.multipleSelection=t},sortChange:function(e){e.column;var t=e.prop,i=e.order;this.listQuery.sort="ascending"==i?"asc":"desc",this.listQuery.sidx=i?t:"",this.initData()},reset:function(){if(this.listQuery.sort=this.defaultListQuery.sort,this.listQuery.sidx=this.defaultListQuery.sidx,2===this.columnData.type){var e=Object(o["a"])({},this.columnData.treeRelation,this.treeActiveId),t=this.treeActiveId?JSON.stringify(e):"";this.search(t)}else this.search("")},searchData:function(e){2===this.columnData.type&&this.treeActiveId&&(e=JSON.parse(e),e=Object(r["a"])(Object(o["a"])({},this.columnData.treeRelation,this.treeActiveId),e),e=JSON.stringify(e)),this.search(e)},search:function(e){this.isPreview||(e||this.$refs.treeBox&&this.$refs.treeBox.setCurrentKey(null),this.listQuery.queryJson=e,this.listQuery.currentPage=1,this.initData())},superQuery:function(e){this.isPreview||(this.listQuery.superQueryJson=e,this.listQuery.currentPage=1,this.initData())},customBtnsHandel:function(e,t,i){1==e.event.btnType&&this.handlePopup(e.event,t,i),2==e.event.btnType&&this.handleScriptFunc(e.event,t,i),3==e.event.btnType&&this.handleInterface(e.event,t,i)},handlePopup:function(e,t,i){var a=this;this.customBoxVisible=!0,this.$nextTick((function(){a.$refs.CustomBox.init(e,a.modelId,"",a.isPreview,t)}))},handleScriptFunc:function(e,t,i){var a={data:t,index:i,refresh:this.initData,onlineUtils:this.jnpf.onlineUtils},n=this.jnpf.getScriptFunc.call(this,e.func);n&&n.call(this,a)},handleInterface:function(e,t,i){var a=this,n=function(){e.templateJson&&e.templateJson.length&&e.templateJson.forEach((function(e){e.defaultValue=t[e.relationField]||""}));var i={paramList:e.templateJson||[]};Object(f["i"])(e.interfaceId,i).then((function(e){a.$message({message:e.msg,type:"success"})}))};if(!e.useConfirm)return n();this.$confirm(e.confirmTitle||"确认执行此操作","提示",{type:"warning"}).then((function(){n()})).catch((function(){}))},setTableLoadFunc:function(){var e=this.$refs.tableRef.$refs.JNPFTable,t={data:this.list,tableRef:e,onlineUtils:this.jnpf.onlineUtils},i=this.jnpf.getScriptFunc.call(this,this.columnData.funcs.afterOnload);i&&i.call(this,t)},toggleTreeExpand:function(e){var t=this;this.refreshTree=!1,this.expandsTree=e,this.$nextTick((function(){t.refreshTree=!0,t.$nextTick((function(){t.$refs.treeBox.setCurrentKey(null)}))}))},toggleExpandList:function(){var e=this;this.refreshTable=!1,this.expandsTable=!this.expandsTable,this.$nextTick((function(){e.refreshTable=!0}))},loadNode:function(e,t){var i=e.data,a=this.columnData;if(a.treeInterfaceId){if(a.treeTemplateJson&&a.treeTemplateJson.length)for(var n=0;n<a.treeTemplateJson.length;n++){var o=a.treeTemplateJson[n];o.defaultValue=i[o.relationField]||""}var l={paramList:a.treeTemplateJson||[]};Object(f["i"])(a.treeInterfaceId,l).then((function(e){var i=e.data;Array.isArray(i)?t(i):t([])}))}},treeLoad:function(e,t,i){var a=this;Object(d["t"])(this.modelId,e.id,this.listQuery).then((function(e){if(e.data.list&&Array.isArray(e.data.list)){var t=e.data.list.map((function(e){return Object(r["a"])(Object(r["a"])(Object(r["a"])({},e),a.expandObj),{},{hasChildren:!0})}));i(t)}else i([])}))},headBtnsHandel:function(e){var t=this;"download"==e&&(this.exportBoxVisible=!0,this.$nextTick((function(){t.$refs.ExportBox.init(t.exportList)})))},download:function(e){var t=this;if(this.isPreview)return this.$message({message:"功能预览不支持数据导出",type:"warning"});var i=Object(r["a"])(Object(r["a"])({},this.listQuery),e);Object(d["l"])(this.modelId,i).then((function(e){e.data.url&&(t.jnpf.downloadFile(e.data.url),t.$refs.ExportBox.visible=!1,t.exportBoxVisible=!1)}))},getFixed:function(e,t){return 0==t&&this.columnData.groupField&&3==this.columnData.type?!!this.columnList.some((function(e){return"left"==e.fixed}))&&"left":2!=this.columnData.childTableStyle&&("none"!=e.fixed&&e.fixed)}}},v=y,w=i("2877"),D=Object(w["a"])(v,a,n,!1,null,null,null);t["default"]=D.exports},"5a09":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"child-table-column"},[e.expand?e._e():e._l(e.fewData,(function(i,a){return t("tr",{key:a,staticClass:"child-table__row"},e._l(e.head,(function(a,n){return t("td",{key:n,class:{"td-flex-1":!a.width},style:{width:"".concat(a.width-1,"px"),"text-align":a.align}},["relationForm"===a.jnpfKey?t("div",{staticClass:"cell"},[t("el-link",{attrs:{underline:!1,type:"primary"},nativeOn:{click:function(t){return e.toDetail(a.modelId,i["".concat(a.vModel,"_id")])}}},[e._v(" "+e._s(i[a.vModel])+" ")])],1):"inputNumber"===a.jnpfKey||"calculate"===a.jnpfKey?t("div",{staticClass:"cell"},[t("JnpfNumber",{attrs:{thousands:a.thousands,precision:a.precision},model:{value:i[a.vModel],callback:function(t){e.$set(i,a.vModel,t)},expression:"item[headItem.vModel]"}})],1):t("div",{staticClass:"cell"},[e._v(" "+e._s(i[a.vModel])+" ")])])})),0)})),e.expand?e._l(e.data,(function(i,a){return t("tr",{key:a,staticClass:"child-table__row"},e._l(e.head,(function(a,n){return t("td",{key:n,class:{"td-flex-1":!a.width},style:{width:"".concat(a.width-1,"px"),"text-align":a.align}},["relationForm"===a.jnpfKey?t("div",{staticClass:"cell"},[t("el-link",{attrs:{underline:!1,type:"primary"},nativeOn:{click:function(t){return e.toDetail(a.modelId,i["".concat(a.vModel,"_id")])}}},[e._v(" "+e._s(i[a.vModel])+" ")])],1):"inputNumber"===a.jnpfKey||"calculate"===a.jnpfKey?t("div",{staticClass:"cell"},[t("JnpfNumber",{attrs:{thousands:a.thousands,precision:a.precision},model:{value:i[a.vModel],callback:function(t){e.$set(i,a.vModel,t)},expression:"item[headItem.vModel]"}})],1):t("div",{staticClass:"cell"},[e._v(" "+e._s(i[a.vModel])+" ")])])})),0)})):e._e(),e.data.length>e.defaultNumber?t("div",{staticClass:"expand-more-btn"},[e.expand?t("el-button",{attrs:{type:"text"},on:{click:e.toggleExpand}},[e._v("隐藏部分")]):e._e(),e.expand?e._e():t("el-button",{attrs:{type:"text"},on:{click:e.toggleExpand}},[e._v("加载更多")])],1):e._e()],2)},n=[],o=(i("a9e3"),i("fb6a"),{name:"childTableColumn",data:function(){return{}},props:{data:{type:Array,default:function(){return[]}},head:{type:Array,default:function(){return[]}},defaultNumber:{type:Number,default:3},rowEdit:{type:Boolean,default:!1},expand:{type:Boolean,default:!1}},computed:{fewData:function(){return this.data?this.data.slice(0,this.defaultNumber):[]}},methods:{toggleExpand:function(){this.$emit("toggleExpand")},toDetail:function(e,t){this.$emit("toDetail",e,t)}}}),l=o,r=i("2877"),s=Object(r["a"])(l,a,n,!1,null,null,null);t["default"]=s.exports},"63c9":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e._self._c;return t(e.currentView,{directives:[{name:"show",rawName:"v-show",value:e.showPage,expression:"showPage"}],tag:"component",attrs:{config:e.config,modelId:e.modelId,isPreview:e.isPreview}})},n=[],o=(i("ac1f"),i("5319"),i("ef22")),l=i("b4b7"),r=i("7292"),s=i("34e8"),c=i("3fa5"),d={name:"dynamicModel",components:{Form:l["default"],List:r["default"],ViewForm:s["default"]},data:function(){return{currentView:"",showPage:!1,isPreview:!1,modelId:"",config:{}}},created:function(){this.$store.dispatch("base/getDictionaryAll");var e=this.$route.query.isPreview||!1;e?(this.modelId=this.$route.query.id,this.isPreview=!0):this.modelId=this.$route.meta.relationId;var t=this.$route.query.previewType?this.$route.query.previewType:"";this.modelId&&this.getConfigData({type:t})},methods:{getConfigData:function(e){var t=this;Object(o["m"])(this.modelId,e).then((function(e){if(200!==e.code||!e.data)return t.$store.dispatch("tagsView/delView",t.$route),t.$router.replace("/404"),void Object(c["a"])({message:e.msg||"请求出错，请重试",type:"error",duration:1500});t.config=e.data,"1"==e.data.webType?t.currentView="Form":"4"==e.data.webType?t.currentView="ViewForm":t.currentView="List",t.showPage=!0})).catch((function(){}))}}},u=d,p=i("2877"),f=Object(p["a"])(u,a,n,!1,null,null,null);t["default"]=f.exports},7292:function(e,t,i){"use strict";i.r(t);i("d3b7"),i("c7cd"),i("caad"),i("2532"),i("a15b");var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"JNPF-common-layout"},[2===e.columnData.type?t("div",{staticClass:"JNPF-common-layout-left"},[e.columnData.treeTitle?t("div",{staticClass:"JNPF-common-title"},[t("h2",[e._v(e._s(e.columnData.treeTitle))]),0==e.columnData.treeSynType?t("el-dropdown",[t("el-link",{attrs:{icon:"icon-ym icon-ym-mpMenu",underline:!1}}),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{nativeOn:{click:function(t){return e.toggleTreeExpand(!0)}}},[e._v("展开全部")]),t("el-dropdown-item",{nativeOn:{click:function(t){return e.toggleTreeExpand(!1)}}},[e._v("折叠全部")])],1)],1):e._e()],1):e._e(),e.columnData.hasTreeQuery&&0==e.columnData.treeSynType?t("div",{staticClass:"JNPF-common-tree-search-box"},[t("el-input",{attrs:{placeholder:"输入关键字","suffix-icon":"el-icon-search",clearable:""},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1):e._e(),e.refreshTree?t("el-tree",{ref:"treeBox",staticClass:"JNPF-common-el-tree",attrs:{data:e.treeData,props:e.treeProps,"default-expand-all":0==e.columnData.treeSynType&&e.expandsTree,"highlight-current":"","expand-on-click-node":!1,"node-key":e.treeProps.value,"filter-node-method":e.filterNode,lazy:!!(1==e.columnData.treeSynType&"api"===e.columnData.treeDataSource),load:e.loadNode},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(i){var a=i.node,n=i.data;return t("span",{staticClass:"custom-tree-node"},[t("i",{class:n.icon}),t("span",{staticClass:"text"},[e._v(e._s(a.label))])])}}],null,!1,1575034392)}):e._e()],1):e._e(),t("div",{staticClass:"JNPF-common-layout-center"},[t("Search",{ref:"Search",attrs:{list:e.columnData.searchList,initDataJson:e.listQuery.queryJson},on:{reset:e.reset,search:e.searchData}}),t("div",{staticClass:"JNPF-common-layout-main JNPF-flex-main"},[t("div",{staticClass:"JNPF-common-head"},[e.isPreview||!e.columnData.useBtnPermission?t("div",e._l(e.columnData.btnsList,(function(i,a){return t("span",{key:a,staticStyle:{margin:"0 4px"}},[t("el-button",{attrs:{type:0==a?"primary":"text",icon:i.icon},on:{click:function(t){return e.headBtnsHandel(i.value)}}},[e._v(" "+e._s(i.label))])],1)})),0):t("div",e._l(e.columnData.btnsList,(function(i,a){return t("span",{key:a,staticStyle:{margin:"0 4px"}},[t("el-button",{directives:[{name:"has",rawName:"v-has",value:"btn_"+i.value,expression:"'btn_'+item.value"}],attrs:{type:0==a?"primary":"text",icon:i.icon},on:{click:function(t){return e.headBtnsHandel(i.value)}}},[e._v(" "+e._s(i.label))])],1)})),0),t("div",{staticClass:"JNPF-common-head-right"},[e.columnData.hasSuperQuery?t("el-tooltip",{attrs:{content:"高级查询",placement:"top"}},[t("el-link",{attrs:{icon:"icon-ym icon-ym-filter JNPF-common-head-icon",underline:!1},on:{click:function(t){return e.openSuperQuery()}}})],1):e._e(),5==e.columnData.type&&0==e.columnData.treeLazyType?[t("el-tooltip",{attrs:{effect:"dark",content:"展开",placement:"top"}},[t("el-link",{directives:[{name:"show",rawName:"v-show",value:!e.expandsTable,expression:"!expandsTable"}],attrs:{type:"text",icon:"icon-ym icon-ym-btn-expand JNPF-common-head-icon",underline:!1},on:{click:function(t){return e.toggleExpandList()}}})],1),t("el-tooltip",{attrs:{effect:"dark",content:"折叠",placement:"top"}},[t("el-link",{directives:[{name:"show",rawName:"v-show",value:e.expandsTable,expression:"expandsTable"}],attrs:{type:"text",icon:"icon-ym icon-ym-btn-collapse JNPF-common-head-icon",underline:!1},on:{click:function(t){return e.toggleExpandList()}}})],1)]:e._e(),t("el-tooltip",{attrs:{effect:"dark",content:e.$t("common.refresh"),placement:"top"}},[t("el-link",{attrs:{icon:"icon-ym icon-ym-Refresh JNPF-common-head-icon",underline:!1},on:{click:function(t){return e.initData()}}})],1)],2)]),e.refreshTable?t("JNPF-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"tableRef",attrs:{data:e.list,"row-key":"id","default-expand-all":2!==e.columnData.childTableStyle&&1!=e.columnData.treeLazyType&&e.expandsTable,lazy:5==e.columnData.type&&1==e.columnData.treeLazyType,"tree-props":{children:"children",hasChildren:1==e.columnData.treeLazyType?"hasChildren":""},load:e.treeLoad,"row-style":e.rowStyle,"cell-style":e.cellStyle,"has-c":e.hasBatchBtn,"custom-column":"","span-method":e.arraySpanMethod,hasNO:!(2==e.columnData.childTableStyle&&e.childColumnList.length&&3!=e.columnData.type)&&4!=e.columnData.type,hasNOFixed:e.columnList.some((function(e){return"left"==e.fixed})),"show-summary":e.columnData.showSummary&&!(3==e.columnData.type||5==e.columnData.type),"summary-method":e.getTableSummaries},on:{"sort-change":e.sortChange,"selection-change":e.handleSelectionChange}},[4===e.columnData.type?[t("el-table-column",{attrs:{width:"50",align:"center",label:"序号",fixed:e.columnList.some((function(e){return"left"==e.fixed}))},scopedSlots:e._u([{key:"default",fn:function(i){return[0==e.config.enableFlow?t("div",{staticClass:"row-action"},[t("span",{staticClass:"index"},[e._v(e._s(i.$index+1))]),t("i",{staticClass:"ym-custom ym-custom-arrow-expand",on:{click:function(t){return e.handleRowForm(i.$index)}}})]):t("div",[e._v(e._s(i.$index+1))])]}}],null,!1,1055398317)}),e._l(e.columnList,(function(i,a){return["table"!==i.jnpfKey?t("el-table-column",{key:a,attrs:{prop:i.prop,label:i.label,align:i.align,fixed:"none"!=i.fixed&&i.fixed,width:i.width,sortable:i.sortable?"custom":i.sortable},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.rowEdit?["inputNumber"===i.jnpfKey?[t("JnpfInputNumber",{staticStyle:{width:"100%"},attrs:{placeholder:i.placeholder,min:i.min,max:i.max,step:i.step,precision:i.precision,addonBefore:i.addonBefore,addonAfter:i.addonAfter,"controls-position":i["controls-position"],disabled:i.disabled,thousands:i.thousands},model:{value:a.row[i.prop],callback:function(t){e.$set(a.row,i.prop,t)},expression:"scope.row[item.prop]"}})]:["rate","slider"].includes(i.jnpfKey)?[t("el-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入","controls-position":"right",disabled:i.disabled},model:{value:a.row[i.prop],callback:function(t){e.$set(a.row,i.prop,t)},expression:"scope.row[item.prop]"}})]:"switch"===i.jnpfKey?t("div",{staticStyle:{"padding-top":"5px"}},[t("el-switch",{attrs:{activeValue:i.activeValue,inactiveValue:i.inactiveValue,disabled:i.disabled},model:{value:a.row[i.prop],callback:function(t){e.$set(a.row,i.prop,t)},expression:"scope.row[item.prop]"}})],1):"timePicker"===i.jnpfKey?[t("JnpfTimePicker",{staticStyle:{width:"100%"},attrs:{placeholder:i.placeholder,clearable:i.clearable,valueFormat:i.format,format:i.format,readonly:i.readonly,disabled:i.disabled,startTime:i.startTime,endTime:i.endTime},model:{value:a.row[i.prop],callback:function(t){e.$set(a.row,i.prop,t)},expression:"scope.row[item.prop]"}})]:"datePicker"===i.jnpfKey?[t("JnpfDatePicker",{staticStyle:{width:"100%"},attrs:{clearable:i.clearable,placeholder:i.placeholder,format:i.format,readonly:i.readonly,disabled:i.disabled,startTime:i.startTime,endTime:i.endTime},model:{value:a.row[i.prop],callback:function(t){e.$set(a.row,i.prop,t)},expression:"scope.row[item.prop]"}})]:["organizeSelect"].includes(i.jnpfKey)?[t("JnpfOrganizeSelect",{attrs:{placeholder:i.placeholder,multiple:i.multiple,clearable:i.clearable,disabled:i.disabled},model:{value:a.row[i.prop],callback:function(t){e.$set(a.row,i.prop,t)},expression:"scope.row[item.prop]"}})]:["depSelect"].includes(i.jnpfKey)?[t("JnpfDepSelect",{attrs:{placeholder:i.placeholder,selectType:i.selectType,ableDepIds:i.ableDepIds,multiple:i.multiple,clearable:i.clearable,disabled:i.disabled},model:{value:a.row[i.prop],callback:function(t){e.$set(a.row,i.prop,t)},expression:"scope.row[item.prop]"}})]:["userSelect"].includes(i.jnpfKey)?[t("JnpfUserSelect",{attrs:{placeholder:i.placeholder,selectType:i.selectType,ableDepIds:i.ableDepIds,ablePosIds:i.ablePosIds,ableUserIds:i.ableUserIds,ableRoleIds:i.ableRoleIds,ableGroupIds:i.ableGroupIds,multiple:i.multiple,clearable:i.clearable,disabled:i.disabled},model:{value:a.row[i.prop],callback:function(t){e.$set(a.row,i.prop,t)},expression:"scope.row[item.prop]"}})]:["usersSelect"].includes(i.jnpfKey)?[t("JnpfUsersSelect",{attrs:{placeholder:i.placeholder,selectType:i.selectType,ableIds:i.ableIds,multiple:i.multiple,clearable:i.clearable,disabled:i.disabled},model:{value:a.row[i.prop],callback:function(t){e.$set(a.row,i.prop,t)},expression:"scope.row[item.prop]"}})]:["posSelect"].includes(i.jnpfKey)?[t("JnpfPosSelect",{attrs:{placeholder:i.placeholder,selectType:i.selectType,ableDepIds:i.ableDepIds,ablePosIds:i.ablePosIds,multiple:i.multiple,clearable:i.clearable,disabled:i.disabled},model:{value:a.row[i.prop],callback:function(t){e.$set(a.row,i.prop,t)},expression:"scope.row[item.prop]"}})]:"groupSelect"===i.jnpfKey?[t("JnpfGroupSelect",{attrs:{placeholder:i.placeholder,multiple:i.multiple,clearable:i.clearable,disabled:i.disabled},model:{value:a.row[i.prop],callback:function(t){e.$set(a.row,i.prop,t)},expression:"scope.row[item.prop]"}})]:"roleSelect"===i.jnpfKey?[t("JnpfRoleSelect",{attrs:{placeholder:i.placeholder,multiple:i.multiple,clearable:i.clearable,disabled:i.disabled},model:{value:a.row[i.prop],callback:function(t){e.$set(a.row,i.prop,t)},expression:"scope.row[item.prop]"}})]:"areaSelect"===i.jnpfKey?[t("JnpfAreaSelect",{attrs:{level:i.level,placeholder:i.placeholder,multiple:i.multiple,clearable:i.clearable,disabled:i.disabled},model:{value:a.row[i.prop],callback:function(t){e.$set(a.row,i.prop,t)},expression:"scope.row[item.prop]"}})]:["select","radio","checkbox"].includes(i.jnpfKey)?[t("el-select",{attrs:{placeholder:i.placeholder,filterable:i.filterable,multiple:i.multiple||"checkbox"===i.jnpfKey,clearable:i.clearable,disabled:i.disabled},model:{value:a.row[i.prop],callback:function(t){e.$set(a.row,i.prop,t)},expression:"scope.row[item.prop]"}},e._l(i.options,(function(e,a){return t("el-option",{key:a,attrs:{label:e[i.props.label],value:e[i.props.value]}})})),1)]:"cascader"===i.jnpfKey?[t("JnpfCascader",{staticStyle:{width:"100%"},attrs:{options:i.options,clearable:i.clearable,"show-all-levels":i.showAllLevels,props:i.props,filterable:i.filterable,separator:i.separator,placeholder:i.placeholder,disabled:i.disabled,multiple:i.multiple},model:{value:a.row[i.prop],callback:function(t){e.$set(a.row,i.prop,t)},expression:"scope.row[item.prop]"}})]:"treeSelect"===i.jnpfKey?[t("JnpfTreeSelect",{attrs:{options:i.options,props:i.props,placeholder:i.placeholder,multiple:i.multiple,clearable:i.clearable,disabled:i.disabled},model:{value:a.row[i.prop],callback:function(t){e.$set(a.row,i.prop,t)},expression:"scope.row[item.prop]"}})]:"relationForm"===i.jnpfKey?[t("JnpfRelationForm",{attrs:{placeholder:i.placeholder,modelId:i.modelId,columnOptions:i.columnOptions,relationField:i.relationField,hasPage:i.hasPage,pageSize:i.pageSize,clearable:i.clearable,disabled:i.disabled},model:{value:a.row[i.prop],callback:function(t){e.$set(a.row,i.prop,t)},expression:"scope.row[item.prop]"}})]:"popupSelect"===i.jnpfKey?[t("JnpfPopupSelect",{attrs:{placeholder:i.placeholder,interfaceId:i.interfaceId,columnOptions:i.columnOptions,propsValue:i.propsValue,relationField:i.relationField,hasPage:i.hasPage,pageSize:i.pageSize,popupType:i.popupType,templateJson:i.templateJson,popupTitle:i.popupTitle,popupWidth:i.popupWidth,clearable:i.clearable,disabled:i.disabled},model:{value:a.row[i.prop],callback:function(t){e.$set(a.row,i.prop,t)},expression:"scope.row[item.prop]"}})]:"autoComplete"===i.jnpfKey?[t("JnpfAutoComplete",{attrs:{placeholder:i.placeholder,interfaceId:i.interfaceId,relationField:i.relationField,total:i.total,clearable:i.clearable,templateJson:i.templateJson,disabled:i.disabled},model:{value:a.row[i.prop],callback:function(t){e.$set(a.row,i.prop,t)},expression:"scope.row[item.prop]"}})]:"popupTableSelect"===i.jnpfKey?[t("JnpfPopupTableSelect",{attrs:{placeholder:i.placeholder,interfaceId:i.interfaceId,columnOptions:i.columnOptions,propsValue:i.propsValue,relationField:i.relationField,hasPage:i.hasPage,pageSize:i.pageSize,popupType:i.popupType,popupTitle:i.popupTitle,popupWidth:i.popupWidth,filterable:i.filterable,multiple:i.multiple,clearable:i.clearable,disabled:i.disabled,templateJson:i.templateJson},model:{value:a.row[i.prop],callback:function(t){e.$set(a.row,i.prop,t)},expression:"scope.row[item.prop]"}})]:["input","textarea"].includes(i.jnpfKey)?[t("JnpfInput",{attrs:{placeholder:i.placeholder,readonly:i.readonly,prefixIcon:i.prefixIcon,suffixIcon:i.suffixIcon,clearable:i.clearable,showWordLimit:i.showWordLimit,maxlength:i.maxlength,showPassword:i.showPassword,addonBefore:i.addonBefore,addonAfter:i.addonAfter,disabled:i.disabled},model:{value:a.row[i.prop],callback:function(t){e.$set(a.row,i.prop,t)},expression:"scope.row[item.prop]"}})]:e.systemComponentsList.includes(i.jnpfKey)?[e._v(" "+e._s(a.row[i.prop+"_name"]||a.row[i.prop])+" ")]:[e._v(" "+e._s(a.row[i.prop])+" ")]]:[["relationForm"].includes(i.jnpfKey)?[t("el-link",{attrs:{underline:!1,type:"primary"},nativeOn:{click:function(t){return e.toDetail(i.modelId,a.row["".concat(i.prop)])}}},[e._v(" "+e._s(a.row[i.prop+"_name"]||a.row[i.prop]))])]:e._e(),["inputNumber","calculate"].includes(i.jnpfKey)?[a.row[i.prop+"_name"]?[t("JnpfNumber",{attrs:{thousands:i.thousands,precision:i.precision},model:{value:a.row[i.prop+"_name"],callback:function(t){e.$set(a.row,i.prop+"_name",t)},expression:"scope.row[item.prop+'_name']"}})]:[t("JnpfNumber",{attrs:{thousands:i.thousands,precision:i.precision},model:{value:a.row[i.prop],callback:function(t){e.$set(a.row,i.prop,t)},expression:"scope.row[item.prop]"}})]]:[e._v(" "+e._s(a.row[i.prop+"_name"]||a.row[i.prop])+" ")]]]}}],null,!0)},["complexHeader"==i.jnpfKey&&i.children&&i.children.length?[e._l(i.children,(function(a){return[t("el-table-column",{key:a.prop,attrs:{prop:a.prop,label:a.label,width:a.width,align:a.align,sortable:a.sortable?"custom":a.sortable},scopedSlots:e._u([{key:"default",fn:function(n){return[n.row.rowEdit?["inputNumber"===a.jnpfKey?[t("JnpfInputNumber",{staticStyle:{width:"100%"},attrs:{placeholder:a.placeholder,min:a.min,max:a.max,step:a.step,precision:a.precision,addonBefore:a.addonBefore,addonAfter:a.addonAfter,"controls-position":a["controls-position"],disabled:a.disabled,thousands:a.thousands},model:{value:n.row[a.prop],callback:function(t){e.$set(n.row,a.prop,t)},expression:"scope.row[child.prop]"}})]:["rate","slider"].includes(a.jnpfKey)?[t("el-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入","controls-position":"right",disabled:a.disabled},model:{value:n.row[a.prop],callback:function(t){e.$set(n.row,a.prop,t)},expression:"scope.row[child.prop]"}})]:"switch"===a.jnpfKey?t("div",{staticStyle:{"padding-top":"5px"}},[t("el-switch",{attrs:{"active-value":a["active-value"],"inactive-value":a["inactive-value"],disabled:a.disabled},model:{value:n.row[a.prop],callback:function(t){e.$set(n.row,a.prop,t)},expression:"scope.row[child.prop]"}})],1):"timePicker"===a.jnpfKey?[t("JnpfTimePicker",{staticStyle:{width:"100%"},attrs:{placeholder:a.placeholder,clearable:a.clearable,valueFormat:a.format,format:a.format,readonly:a.readonly,disabled:a.disabled,startTime:a.startTime,endTime:a.endTime},model:{value:n.row[a.prop],callback:function(t){e.$set(n.row,a.prop,t)},expression:"scope.row[child.prop]"}})]:"datePicker"===a.jnpfKey?[t("JnpfDatePicker",{staticStyle:{width:"100%"},attrs:{clearable:a.clearable,placeholder:a.placeholder,format:a.format,readonly:a.readonly,disabled:a.disabled,startTime:a.startTime,endTime:a.endTime},model:{value:n.row[a.prop],callback:function(t){e.$set(n.row,a.prop,t)},expression:"scope.row[child.prop]"}})]:["organizeSelect"].includes(a.jnpfKey)?[t("JnpfOrganizeSelect",{attrs:{placeholder:a.placeholder,multiple:a.multiple,clearable:a.clearable,disabled:a.disabled,selectType:a.selectType,ableIds:a.ableIds},model:{value:n.row[a.prop],callback:function(t){e.$set(n.row,a.prop,t)},expression:"scope.row[child.prop]"}})]:["depSelect"].includes(a.jnpfKey)?[t("JnpfDepSelect",{attrs:{placeholder:a.placeholder,selectType:a.selectType,ableDepIds:a.ableDepIds,multiple:a.multiple,clearable:a.clearable,disabled:a.disabled,ableIds:a.ableIds},model:{value:n.row[a.prop],callback:function(t){e.$set(n.row,a.prop,t)},expression:"scope.row[child.prop]"}})]:["userSelect"].includes(a.jnpfKey)?[t("JnpfUserSelect",{attrs:{placeholder:a.placeholder,selectType:a.selectType,ableIds:a.ableIds,multiple:a.multiple,clearable:a.clearable,disabled:a.disabled},model:{value:n.row[a.prop],callback:function(t){e.$set(n.row,a.prop,t)},expression:"scope.row[child.prop]"}})]:["usersSelect"].includes(a.jnpfKey)?[t("JnpfUsersSelect",{attrs:{placeholder:a.placeholder,selectType:a.selectType,ableIds:a.ableIds,multiple:a.multiple,clearable:a.clearable,disabled:a.disabled},model:{value:n.row[a.prop],callback:function(t){e.$set(n.row,a.prop,t)},expression:"scope.row[child.prop]"}})]:["posSelect"].includes(a.jnpfKey)?[t("JnpfPosSelect",{attrs:{placeholder:a.placeholder,selectType:a.selectType,ableIds:a.ableIds,multiple:a.multiple,clearable:a.clearable,disabled:a.disabled},model:{value:n.row[a.prop],callback:function(t){e.$set(n.row,a.prop,t)},expression:"scope.row[child.prop]"}})]:"groupSelect"===a.jnpfKey?[t("JnpfGroupSelect",{attrs:{ableIds:a.ableIds,placeholder:a.placeholder,multiple:a.multiple,selectType:a.selectType,clearable:a.clearable,disabled:a.disabled},model:{value:n.row[a.prop],callback:function(t){e.$set(n.row,a.prop,t)},expression:"scope.row[child.prop]"}})]:"roleSelect"===a.jnpfKey?[t("JnpfRoleSelect",{attrs:{ableIds:a.ableIds,placeholder:a.placeholder,multiple:a.multiple,selectType:a.selectType,clearable:a.clearable,disabled:a.disabled},model:{value:n.row[a.prop],callback:function(t){e.$set(n.row,a.prop,t)},expression:"scope.row[child.prop]"}})]:"areaSelect"===a.jnpfKey?[t("JnpfAreaSelect",{attrs:{level:a.level,placeholder:a.placeholder,multiple:a.multiple,clearable:a.clearable,disabled:a.disabled},model:{value:n.row[a.prop],callback:function(t){e.$set(n.row,a.prop,t)},expression:"scope.row[child.prop]"}})]:["select","radio","checkbox"].includes(a.jnpfKey)?[t("el-select",{attrs:{placeholder:a.placeholder,filterable:a.filterable,multiple:a.multiple||"checkbox"===a.jnpfKey,clearable:a.clearable,disabled:a.disabled},model:{value:n.row[a.prop],callback:function(t){e.$set(n.row,a.prop,t)},expression:"scope.row[child.prop]"}},e._l(a.options,(function(e,i){return t("el-option",{key:i,attrs:{label:e[a.props.label],value:e[a.props.value]}})})),1)]:"cascader"===a.jnpfKey?[t("el-cascader",{staticStyle:{width:"100%"},attrs:{options:a.options,clearable:a.clearable,"show-all-levels":a.showAllLevels,props:a.props,filterable:a.filterable,separator:a.separator,placeholder:a.placeholder,disabled:a.disabled},model:{value:n.row[a.prop],callback:function(t){e.$set(n.row,a.prop,t)},expression:"scope.row[child.prop]"}})]:"treeSelect"===a.jnpfKey?[t("JnpfTreeSelect",{attrs:{options:a.options,props:a.props,placeholder:a.placeholder,multiple:a.multiple,clearable:a.clearable,disabled:a.disabled},model:{value:n.row[a.prop],callback:function(t){e.$set(n.row,a.prop,t)},expression:"scope.row[child.prop]"}})]:"relationForm"===a.jnpfKey?[t("JnpfRelationForm",{attrs:{placeholder:a.placeholder,modelId:a.modelId,columnOptions:a.columnOptions,relationField:a.relationField,hasPage:a.hasPage,pageSize:a.pageSize,clearable:a.clearable,disabled:a.disabled},model:{value:n.row[a.prop],callback:function(t){e.$set(n.row,a.prop,t)},expression:"scope.row[child.prop]"}})]:"popupSelect"===a.jnpfKey?[t("JnpfPopupSelect",{attrs:{placeholder:a.placeholder,interfaceId:a.interfaceId,columnOptions:a.columnOptions,propsValue:a.propsValue,relationField:a.relationField,hasPage:a.hasPage,pageSize:a.pageSize,popupType:a.popupType,templateJson:i.templateJson,popupTitle:a.popupTitle,popupWidth:a.popupWidth,clearable:a.clearable,disabled:a.disabled},model:{value:n.row[a.prop],callback:function(t){e.$set(n.row,a.prop,t)},expression:"scope.row[child.prop]"}})]:"autoComplete"===a.jnpfKey?[t("JnpfAutoComplete",{attrs:{placeholder:a.placeholder,interfaceId:a.interfaceId,relationField:a.relationField,total:a.total,clearable:a.clearable,templateJson:a.templateJson,disabled:a.disabled},model:{value:n.row[a.prop],callback:function(t){e.$set(n.row,a.prop,t)},expression:"scope.row[child.prop]"}})]:"popupTableSelect"===a.jnpfKey?[t("JnpfPopupTableSelect",{attrs:{placeholder:a.placeholder,interfaceId:a.interfaceId,multiple:a.multiple,columnOptions:a.columnOptions,propsValue:a.propsValue,relationField:a.relationField,hasPage:a.hasPage,pageSize:a.pageSize,popupType:a.popupType,popupTitle:a.popupTitle,popupWidth:a.popupWidth,filterable:a.filterable,disabled:a.disabled,clearable:"",templateJson:i.templateJson},model:{value:n.row[a.prop],callback:function(t){e.$set(n.row,a.prop,t)},expression:"scope.row[child.prop]"}})]:["input","textarea"].includes(a.jnpfKey)?[t("el-input",{attrs:{placeholder:a.placeholder,readonly:a.readonly,"prefix-icon":a["prefix-icon"],"suffix-icon":a["suffix-icon"],clearable:a.clearable,"show-word-limit":a["show-word-limit"],maxlength:a.maxlength,"show-password":a["show-password"],disabled:a.disabled},model:{value:n.row[a.prop],callback:function(t){e.$set(n.row,a.prop,t)},expression:"scope.row[child.prop]"}},[a.__slot__&&a.__slot__.prepend?t("template",{slot:"prepend"},[e._v(e._s(a.__slot__.prepend))]):e._e(),a.__slot__&&a.__slot__.append?t("template",{slot:"append"},[e._v(e._s(a.__slot__.append))]):e._e()],2)]:e.systemComponentsList.includes(a.jnpfKey)?[e._v(" "+e._s(n.row[a.prop+"_name"]||n.row[a.prop])+" ")]:[e._v(" "+e._s(n.row[a.prop])+" ")]]:[["relationForm"].includes(a.jnpfKey)?[t("el-link",{attrs:{underline:!1,type:"primary"},nativeOn:{click:function(t){return e.toDetail(a.modelId,n.row["".concat(a.prop)])}}},[e._v(" "+e._s(n.row[a.prop+"_name"]||n.row[a.prop]))])]:["inputNumber","calculate"].includes(a.jnpfKey)?[n.row[a.prop+"_name"]?[t("JnpfNumber",{attrs:{thousands:a.thousands,precision:a.precision},model:{value:n.row[a.prop+"_name"],callback:function(t){e.$set(n.row,a.prop+"_name",t)},expression:"scope.row[child.prop+'_name']"}})]:[t("JnpfNumber",{attrs:{thousands:a.thousands,precision:a.precision},model:{value:n.row[a.prop],callback:function(t){e.$set(n.row,a.prop,t)},expression:"scope.row[child.prop]"}})]]:[e._v(" "+e._s(n.row[a.prop+"_name"]||n.row[a.prop])+" ")]]]}}],null,!0)})]}))]:e._e()],2):e._e()]}))]:[2!=e.columnData.childTableStyle||!e.childColumnList.length||1!=e.columnData.type&&2!=e.columnData.type?e._e():[t("el-table-column",{attrs:{width:"0"}}),t("el-table-column",{attrs:{type:"expand",width:"40"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-tabs",e._l(e.childColumnList,(function(a,n){return t("el-tab-pane",{key:n,attrs:{label:a.label}},[t("el-table",{attrs:{data:i.row[a.prop],size:"mini"}},e._l(a.children,(function(i,a){return t("el-table-column",{key:a,attrs:{prop:i.vModel,label:i.childLabel,align:i.align,width:i.width},scopedSlots:e._u([{key:"default",fn:function(a){return["relationForm"===i.jnpfKey?[t("el-link",{attrs:{underline:!1,type:"primary"},nativeOn:{click:function(t){return e.toDetail(i.modelId,a.row["".concat(i.vModel,"_id")])}}},[e._v(" "+e._s(a.row[i.vModel])+" ")])]:"inputNumber"===i.jnpfKey||"calculate"===i.jnpfKey?[t("JnpfNumber",{attrs:{thousands:i.thousands,precision:i.precision},model:{value:a.row[i.vModel],callback:function(t){e.$set(a.row,i.vModel,t)},expression:"scope.row[childTable.vModel]"}})]:[e._v(" "+e._s(a.row[i.vModel])+" ")]]}}],null,!0)})})),1)],1)})),1)]}}],null,!1,2299262589)}),t("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}})],e._l(e.columnList,(function(i,a){return["table"===i.jnpfKey?[2!=e.columnData.childTableStyle||3==e.columnData.type?t("el-table-column",{key:a,attrs:{prop:i.prop,label:i.label,align:i.align}},e._l(i.children,(function(a,n){return t("el-table-column",{key:n,attrs:{prop:a.prop,label:a.childLabel,align:a.align,width:a.width,sortable:a.sortable?"custom":a.sortable,"class-name":"child-table-box"},scopedSlots:e._u([{key:"default",fn:function(a){return[n?e._e():t("child-table-column",{attrs:{data:a.row[i.prop],head:i.children,expand:a.row["".concat(i.prop,"Expand")]},on:{toggleExpand:function(t){return e.toggleExpand(a.row,"".concat(i.prop,"Expand"))},toDetail:e.toDetail}})]}}],null,!0)})})),1):e._e()]:"relationForm"===i.jnpfKey?[t("el-table-column",{key:a,attrs:{prop:i.prop,label:i.label,align:i.align,fixed:e.getFixed(i,a),width:i.width,sortable:i.sortable?"custom":i.sortable},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-link",{attrs:{underline:!1,type:"primary"},nativeOn:{click:function(t){return e.toDetail(i.modelId,a.row["".concat(i.prop,"_id")])}}},[e._v(" "+e._s(a.row[i.prop]))])]}}],null,!0)})]:"inputNumber"===i.jnpfKey||"calculate"===i.jnpfKey?[t("el-table-column",{key:a,attrs:{prop:i.prop,label:i.label,align:i.align,fixed:e.getFixed(i,a),width:i.width,sortable:i.sortable?"custom":i.sortable},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row[i.id]?[t("JnpfNumber",{attrs:{thousands:i.thousands,precision:i.precision},model:{value:a.row[i.id],callback:function(t){e.$set(a.row,i.id,t)},expression:"scope.row[item.id]"}})]:e._e()]}}],null,!0)})]:"complexHeader"==i.jnpfKey?[t("el-table-column",{key:a,attrs:{prop:i.prop,label:i.label,align:i.align,fixed:e.getFixed(i,a),width:i.width,sortable:i.sortable?"custom":i.sortable}},[i.children&&i.children.length?[e._l(i.children,(function(i){return["relationForm"==i.jnpfKey?t("el-table-column",{key:i.prop,attrs:{align:i.align,prop:i.prop,label:i.label,width:i.width,sortable:i.sortable?"custom":i.sortable},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-link",{attrs:{underline:!1,type:"primary"},nativeOn:{click:function(t){return e.toDetail(i.modelId,a.row["".concat(i.prop,"_id")])}}},[e._v(" "+e._s(a.row[i.prop]))])]}}],null,!0)}):"inputNumber"===i.jnpfKey||"calculate"===i.jnpfKey?t("el-table-column",{key:i.prop,attrs:{prop:i.prop,label:i.label,align:i.align,width:i.width,sortable:i.sortable?"custom":i.sortable},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row[i.id]?[t("JnpfNumber",{attrs:{thousands:i.thousands,precision:i.precision},model:{value:a.row[i.id],callback:function(t){e.$set(a.row,i.id,t)},expression:"scope.row[child.id]"}})]:e._e()]}}],null,!0)}):t("el-table-column",{key:i.prop,attrs:{prop:i.prop,label:i.label,width:i.width,align:i.align,sortable:i.sortable?"custom":i.sortable}})]}))]:e._e()],2)]:t("el-table-column",{key:a,attrs:{prop:i.prop,label:i.label,align:i.align,fixed:e.getFixed(i,a),width:i.width,sortable:i.sortable?"custom":i.sortable}})]}))],1==e.config.enableFlow?t("el-table-column",{attrs:{fixed:!(!e.columnList.some((function(e){return"right"==e.fixed}))||2==e.columnData.childTableStyle)&&"right",prop:"flowState",label:"状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(i){return i.row.top&&5!=e.columnData.type?void 0:[1==i.row.flowState?t("el-tag",[e._v("等待审核")]):2==i.row.flowState?t("el-tag",{attrs:{type:"success"}},[e._v("审核通过")]):3==i.row.flowState?t("el-tag",{attrs:{type:"danger"}},[e._v("审核退回")]):4==i.row.flowState?t("el-tag",{attrs:{type:"info"}},[e._v("流程撤回")]):5==i.row.flowState?t("el-tag",{attrs:{type:"info"}},[e._v("审核终止")]):6==i.row.flowState?t("el-tag",{attrs:{type:"danger"}},[e._v("已被挂起")]):t("el-tag",{attrs:{type:"warning"}},[e._v("等待提交")])]}}],null,!0)}):e._e(),e.columnBtnsList.length||e.customBtnsList.length?t("el-table-column",{attrs:{label:"操作",fixed:(2!=e.columnData.childTableStyle||!e.childColumnList.length)&&"right",width:e.operationWidth},scopedSlots:e._u([{key:"default",fn:function(i){return i.row.top&&5!=e.columnData.type?void 0:[i.row.rowEdit?[t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.saveForRowEdit(i.row,1)}}},[e._v(" 保存")]),t("el-button",{staticClass:"JNPF-table-delBtn",attrs:{size:"mini",type:"text"},on:{click:function(t){return e.cancelRowEdit(i.row,i.$index)}}},[e._v("取消")]),1==e.config.enableFlow?t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.submitForRowEdit(i.row)}}},[e._v("提交")]):e._e()]:[e.isPreview||!e.columnData.useBtnPermission?[e._l(e.columnBtnsList,(function(a,n){return["edit"==a.value?[4===e.columnData.type?[t("el-button",{key:n,attrs:{size:"mini",type:"text",disabled:1==e.config.enableFlow&&[1,2,4,5,6].indexOf(i.row.flowState)>-1},on:{click:function(t){return e.editForRowEdit(i.row)}}},[e._v(" "+e._s(a.label))])]:[t("el-button",{key:n,attrs:{size:"mini",type:"text",disabled:1==e.config.enableFlow&&[1,2,4,5,6].indexOf(i.row.flowState)>-1},on:{click:function(t){return e.columnBtnsHandel(a.value,i.row)}}},[e._v(" "+e._s(a.label))])]]:"remove"==a.value?[t("el-button",{key:n,staticClass:"JNPF-table-delBtn",attrs:{size:"mini",type:"text",disabled:1==e.config.enableFlow&&[1,2,3,5,6].indexOf(i.row.flowState)>-1},on:{click:function(t){return e.columnBtnsHandel(a.value,i.row,i.$index)}}},[e._v(" "+e._s(a.label))])]:"detail"==a.value?[i.row.id?t("el-button",{key:n,attrs:{size:"mini",type:"text",disabled:1==e.config.enableFlow&&!i.row.flowState},on:{click:function(t){return e.columnBtnsHandel(a.value,i.row)}}},[e._v(" "+e._s(a.label))]):e._e()]:e._e()]})),e.customBtnsList.length?[t("el-dropdown",{attrs:{"hide-on-click":""}},[t("span",{staticClass:"el-dropdown-link"},[t("el-button",{attrs:{type:"text",size:"mini"}},[e._v(" "+e._s(e.$t("common.moreBtn"))),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})])],1),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.customBtnsList,(function(a,n){return t("el-dropdown-item",{key:n,nativeOn:{click:function(t){return e.customBtnsHandel(a,i.row,i.$index)}}},[e._v(" "+e._s(a.label))])})),1)],1)]:e._e()]:[e._l(e.columnBtnsList,(function(a,n){return["edit"==a.value?[4===e.columnData.type?[t("el-button",{directives:[{name:"has",rawName:"v-has",value:"btn_"+a.value,expression:"'btn_'+item.value"}],key:n,attrs:{size:"mini",type:"text",disabled:1==e.config.enableFlow&&[1,2,4,5].indexOf(i.row.flowState)>-1},on:{click:function(e){i.row.rowEdit=!0}}},[e._v(" "+e._s(a.label))])]:[t("el-button",{directives:[{name:"has",rawName:"v-has",value:"btn_"+a.value,expression:"'btn_'+item.value"}],key:n,attrs:{size:"mini",type:"text",disabled:1==e.config.enableFlow&&[1,2,4,5].indexOf(i.row.flowState)>-1},on:{click:function(t){return e.columnBtnsHandel(a.value,i.row)}}},[e._v(" "+e._s(a.label))])]]:"remove"==a.value?[t("el-button",{directives:[{name:"has",rawName:"v-has",value:"btn_"+a.value,expression:"'btn_'+item.value"}],key:n,staticClass:"JNPF-table-delBtn",attrs:{size:"mini",type:"text",disabled:1==e.config.enableFlow&&[1,2,3,5].indexOf(i.row.flowState)>-1},on:{click:function(t){return e.columnBtnsHandel(a.value,i.row,i.$index)}}},[e._v(e._s(a.label))])]:"detail"==a.value?[t("el-button",{directives:[{name:"has",rawName:"v-has",value:"btn_"+a.value,expression:"'btn_'+item.value"}],key:n,attrs:{size:"mini",type:"text",disabled:1==e.config.enableFlow&&!i.row.flowState},on:{click:function(t){return e.columnBtnsHandel(a.value,i.row)}}},[e._v(" "+e._s(a.label))])]:e._e()]})),e.showMoreBtn?[t("el-dropdown",{attrs:{"hide-on-click":""}},[t("span",{staticClass:"el-dropdown-link"},[t("el-button",{attrs:{type:"text",size:"mini"}},[e._v(" "+e._s(e.$t("common.moreBtn"))+" "),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})])],1),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.customBtnsList,(function(a,n){return t("el-dropdown-item",{directives:[{name:"has",rawName:"v-has",value:a.value,expression:"item.value"}],key:n,nativeOn:{click:function(t){return e.customBtnsHandel(a,i.row,i.$index)}}},[e._v(e._s(a.label))])})),1)],1)]:e._e()]]]}}],null,!0)}):e._e()],2):e._e(),3!==e.columnData.type&&5!==e.columnData.type&&e.columnData.hasPage&&e.refreshTable?[t("pagination",{attrs:{total:e.total,page:e.listQuery.currentPage,limit:e.listQuery.pageSize},on:{"update:page":function(t){return e.$set(e.listQuery,"currentPage",t)},"update:limit":function(t){return e.$set(e.listQuery,"pageSize",t)},pagination:e.initData}})]:e._e()],2)],1),t("print-browse",{attrs:{visible:e.printBrowseVisible,id:e.printId,batchIds:e.multipleSelection.join()},on:{"update:visible":function(t){e.printBrowseVisible=t}}}),e.flowVisible?t("FlowBox",{ref:"FlowBox",on:{close:e.closeFlow}}):e._e(),t("Form",{directives:[{name:"show",rawName:"v-show",value:e.formVisible,expression:"formVisible"}],ref:"Form",on:{refreshDataList:e.refresh}}),t("extraForm",{directives:[{name:"show",rawName:"v-show",value:e.extraFormVisible,expression:"extraFormVisible"}],ref:"extraForm",on:{refreshDataList:e.refresh}}),e.detailVisible?t("Detail",{ref:"Detail",on:{close:function(t){e.detailVisible=!1}}}):e._e(),e.detailsVisible?t("RelevanceDetail",{ref:"RelevanceDetail",on:{close:function(t){e.detailsVisible=!1}}}):e._e(),e.exportBoxVisible?t("ExportBox",{ref:"ExportBox",on:{download:e.download}}):e._e(),e.uploadBoxVisible?t("ImportBox",{ref:"UploadBox",on:{refresh:e.initData}}):e._e(),e.customBoxVisible?t("CustomBox",{ref:"CustomBox",on:{close:function(t){e.customBoxVisible=!1}}}):e._e(),e.superQueryVisible?t("SuperQuery",{ref:"SuperQuery",attrs:{columnOptions:e.columnOptions},on:{superQuery:e.superQuery}}):e._e(),t("candidate-form",{attrs:{visible:e.candidateVisible,candidateList:e.candidateList,branchList:e.branchList,taskId:"0",formData:e.workFlowFormData,isCustomCopy:e.isCustomCopy},on:{"update:visible":function(t){e.candidateVisible=t},submitCandidate:e.submitCandidate}}),e.printDialogVisible?t("PrintDialog",{ref:"printDialog",on:{change:e.printBrowseHandle}}):e._e(),t("el-dialog",{staticClass:"JNPF-dialog template-dialog JNPF-dialog_center",attrs:{title:"请选择流程","close-on-click-modal":!1,"append-to-body":"",visible:e.flowListVisible,"lock-scroll":"",width:"400px"},on:{"update:visible":function(t){e.flowListVisible=t}}},[t("el-scrollbar",{staticClass:"template-list"},e._l(e.flowList,(function(i){return t("div",{key:i.id,staticClass:"template-item",on:{click:function(t){return e.selectFlow(i)}}},[e._v(e._s(i.fullName)+" ")])})),0)],1)],1)},n=[],o=i("ade3"),l=i("2909"),r=i("c7eb"),s=i("1da1"),c=i("5530"),d=(i("4de4"),i("4e82"),i("d81d"),i("e9c4"),i("159b"),i("14d9"),i("a9e3"),i("b680"),i("13d5"),i("ac1f"),i("5319"),i("3c65"),i("841c"),i("a434"),i("f41a")),u=i("30c2"),p=i("ef22"),f=i("826a4"),m=i("bb1a"),h=i("17de"),b=i("2934"),_=i("100e"),g=i("e200"),y=i("5451"),v=i("ba53"),w=i("c5c7"),D=i("226a"),x=i("841b"),T=i("aa06"),I=i("0c2e"),L=i("20f7"),F=i("5a09"),k=i("4d3d"),j=i("a7bd"),S=i("1374"),O=i("5880"),C=i("3424"),$={name:"dynamicModel",components:{PrintDialog:d["default"],PrintBrowse:u["default"],Form:v["default"],extraForm:w["default"],ExportBox:I["default"],Search:L["default"],Detail:x["default"],FlowBox:D["default"],ChildTableColumn:F["default"],SuperQuery:k["default"],CandidateForm:j["default"],CustomBox:S["default"],RelevanceDetail:T["default"]},props:["config","modelId","isPreview"],data:function(){return{printDialogVisible:!1,printBrowseVisible:!1,printId:"",printListOptions:[],systemComponentsList:_["systemComponentsList"],keyword:"",treeProps:{children:"children",label:"fullName",value:"id",isLeaf:"isLeaf"},list:[],cacheList:[],total:0,listLoading:!1,listQuery:{currentPage:1,pageSize:20,sort:"desc",sidx:"",menuId:"",queryJson:"",superQueryJson:""},defaultListQuery:{pageSize:20,sort:"desc",sidx:""},flowVisible:!1,formVisible:!1,extraFormVisible:!1,detailVisible:!1,detailsVisible:!1,importBoxVisible:!1,exportBoxVisible:!1,uploadBoxVisible:!1,customBoxVisible:!1,superQueryVisible:!1,treeData:[],expandsTree:!0,treeActiveId:"",columnData:{columnBtnsList:[]},formData:{},columnList:[],childColumnList:[],columnOptions:[],exportList:[],columnBtnsList:[],customBtnsList:[],hasBatchBtn:!1,refreshTable:!1,expandsTable:!0,multipleSelection:[],settingsColumnList:[],mergeList:[],expandObj:{},flowTemplateJson:{},isCustomCopy:!1,candidateVisible:!1,candidateType:1,branchList:[],candidateList:[],currRow:{},workFlowFormData:{},rowStyle:null,cellStyle:null,refreshTree:!0,flowList:[],flowListVisible:!1,currFlow:{}}},computed:Object(c["a"])(Object(c["a"])({},Object(O["mapGetters"])(["userInfo"])),{},{operationWidth:function(){var e=this.customBtnsList.length?50:0;return 4==this.columnData.type&&this.config.enableFlow&&(e+=50),50*this.columnBtnsList.length+e},showMoreBtn:function(){var e=this;return this.customBtnsList.length&&this.customBtnsList.some((function(t){return e.jnpf.hasBtnP(t.value)}))}}),watch:{keyword:function(e){0==this.columnData.treeSynType&&this.$refs.treeBox.filter(e)}},created:function(){this.init()},methods:{init:function(){var e=this;return Object(s["a"])(Object(r["a"])().mark((function t(){var i;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.listLoading=!0,e.listQuery.menuId=e.$route.meta.modelId,e.refreshTable=!1,e.config.columnData&&e.config.formData){t.next=5;break}return t.abrupt("return");case 5:return e.columnData=JSON.parse(e.config.columnData),e.columnData.printIds&&e.columnData.printIds.length>0&&e.getPrintListOptions(e.columnData.printIds),3===e.columnData.type&&(e.columnData.columnList=e.columnData.columnList.filter((function(t){return t.prop!=e.columnData.groupField}))),1==e.config.enableFlow&&e.config.flowId&&e.getFlowList(),e.hasBatchBtn=e.columnData.btnsList.some((function(e){return["batchRemove","batchPrint"].includes(e.value)})),e.formData=JSON.parse(e.config.formData),e.customBtnsList=e.columnData.customBtnsList||[],e.columnBtnsList=e.columnData.columnBtnsList||[],e.columnOptions=e.columnData.columnOptions||[],e.listLoading=!0,e.isPreview&&(e.listQuery.menuId="270579315303777093"),t.next=18,Object(b["c"])(e.listQuery.menuId);case 18:if(i=t.sent,e.settingsColumnList=i.data||[],e.rowStyle=e.jnpf.getScriptFunc.call(e,e.columnData.funcs&&e.columnData.funcs.rowStyle),e.cellStyle=e.jnpf.getScriptFunc.call(e,e.columnData.funcs&&e.columnData.funcs.cellStyle),e.getColumnList(),e.$nextTick((function(){e.refreshTable=!0})),4===e.columnData.type&&e.buildOptions(),!e.isPreview){t.next=27;break}return t.abrupt("return",e.listLoading=!1);case 27:e.initDefaultSearchData(),e.listQuery.pageSize=e.columnData.pageSize,e.listQuery.sort=e.columnData.sort,e.listQuery.sidx=e.columnData.defaultSidx,e.defaultListQuery.pageSize=e.columnData.pageSize,e.defaultListQuery.sort=e.columnData.sort,e.defaultListQuery.sidx=e.columnData.defaultSidx,3!==e.columnData.type&&e.columnData.hasPage||(e.listQuery.pageSize=1e4),2===e.columnData.type?(e.treeProps.value=e.columnData.treePropsValue||"id",e.treeProps.label=e.columnData.treePropsLabel||"fullName",e.treeProps.children=e.columnData.treePropsChildren||"children",e.getTreeView()):e.initData();case 36:case"end":return t.stop()}}),t)})))()},getPrintListOptions:function(e){var t=this;return Object(s["a"])(Object(r["a"])().mark((function i(){return Object(r["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:Object(m["l"])({ids:e}).then((function(e){t.printListOptions=e.data}));case 1:case"end":return i.stop()}}),i)})))()},printBrowseHandle:function(e){this.printDialogVisible=!1,this.handleBatchPrint(e)},printDialog:function(){var e=this;this.printDialogVisible=!0,this.$nextTick((function(){1!=e.printListOptions.length?e.$refs.printDialog.initOptions(e.printListOptions):e.printBrowseHandle(e.printListOptions[0].id)}))},handleBatchPrint:function(e){e?(this.printId=e,this.printBrowseVisible=!0):this.$message({type:"warning",message:"请配置打印模板",duration:1500})},initData:function(){var e=this;this.isPreview||(this.listLoading=!0,Object(p["s"])(this.modelId,this.listQuery).then((function(t){4===e.columnData.type?(e.list=t.data.list.map((function(t){return Object(c["a"])(Object(c["a"])(Object(c["a"])({},t),e.expandObj),{},{rowEdit:!1})})),e.cacheList=JSON.parse(JSON.stringify(e.list))):(e.list=t.data.list.map((function(t){return Object(c["a"])(Object(c["a"])(Object(c["a"])({},t),e.expandObj),{},{hasChildren:!0})})),3===e.columnData.type&&e.list.map((function(t){t.children&&t.children.length&&(t.children=t.children.map((function(t){return Object(c["a"])(Object(c["a"])({},t),e.expandObj)})))}))),3!==e.columnData.type&&e.columnData.hasPage&&(e.total=t.data.pagination.total),e.listLoading=!1,e.$nextTick((function(){e.columnData.funcs&&e.columnData.funcs.afterOnload&&e.setTableLoadFunc()}))})))},getTableSummaries:function(e){var t=this,i=[];this.columnList.forEach((function(e){e.thousands&&i.push(e.id)}));var a=e.columns,n=e.data,o=[];return a.forEach((function(e,a){if(0!==a){if(t.columnData.summaryField.includes(e.property)){var l=n.map((function(t){return Number(t[e.property])}));l.every((function(e){return isNaN(e)}))?o[a]="":(o[a]=l.reduce((function(e,t){var i=Number(t);return isNaN(i)?e:e+t}),0).toFixed(2),i.includes(e.property)&&(o[a]=Object(C["thousandsFormat"])(o[a])))}}else o[a]="合计"})),o},toDetail:function(e,t){var i=this;t&&(this.mainLoading=!0,Object(p["m"])(e).then((function(a){if(i.mainLoading=!1,a.data&&a.data.formData){var n=JSON.parse(a.data.formData);n.popupType="general",i.detailsVisible=!0,i.$nextTick((function(){i.$refs.RelevanceDetail.init(n,e,t)}))}})).catch((function(){i.mainLoading=!1})))},getTreeView:function(){var e=this;if("dictionary"===this.columnData.treeDataSource){if(!this.columnData.treeDictionary)return;this.$store.dispatch("base/getDicDataSelector",this.columnData.treeDictionary).then((function(t){e.treeData=t,e.initData()}))}if("organize"===this.columnData.treeDataSource&&this.$store.dispatch("generator/getDepTree").then((function(t){e.treeData=t,e.initData()})),"department"===this.columnData.treeDataSource&&this.$store.dispatch("generator/getDepTree").then((function(t){e.treeData=t,e.initData()})),"api"===this.columnData.treeDataSource){if(!this.columnData.treePropsUrl)return;Object(h["i"])(this.columnData.treePropsUrl).then((function(t){e.treeData=Array.isArray(t.data)?t.data:[],e.initData()}))}},getColumnList:function(){if(this.isPreview){var e=this.columnData.columnList;this.columnList=this.transformColumnList(e)}else{var t=[];if(this.columnData.useColumnPermission){for(var i=this.$store.getters.permissionList,a=this.$route.meta.modelId,n=i.filter((function(e){return e.modelId===a})),o=n[0]&&n[0].column?n[0].column:[],l=0;l<this.columnData.columnList.length;l++)e:for(var r=0;r<o.length;r++)if(this.columnData.columnList[l].prop===o[r].enCode){t.push(this.columnData.columnList[l]);break e}}else t=this.columnData.columnList;[3,5].includes(this.columnData.type)||(t=this.getComplexColumns(t)),this.columnList=this.transformColumnList(t)}},getComplexColumns:function(e){var t=this.columnData.complexHeaderList||[];if(!t.length)return e;for(var i=[],a=0;a<t.length;a++){var n=t[a];if(n.label=n.fullName,n.align=n.align,n.dataIndex=n.id,n.prop=n.id,n.children=[],n.jnpfKey="complexHeader",n.sortable=!1,n.childColumns&&n.childColumns.length){i.push.apply(i,Object(l["a"])(n.childColumns));for(var o=0;o<e.length;o++){var r=e[o];n.childColumns.includes(r.id)&&"left"!==r.fixed&&"right"!==r.fixed&&n.children.push(Object(c["a"])({},r))}}}t=t.filter((function(e){return e.children.length}));for(var s=0;s<e.length;s++){var d=e[s];i.includes(d.id)||t.push(d)}return t},transformColumnList:function(e){for(var t=this,i=[],a=0;a<e.length;a++){var n=e[a];n.prop.includes("-")?function(){var e=n.prop.split("-")[0],a=n.prop.split("-")[1],o=n.label.split("-")[0],l=n.label.replace(o+"-",""),r={align:"center",jnpfKey:"table",prop:e,label:o,children:[]};n.vModel=a,n.childLabel=l,t.expandObj.hasOwnProperty("".concat(e,"Expand"))||t.$set(t.expandObj,"".concat(e,"Expand"),!1),i.some((function(t){return t.prop===e}))||i.push(r);for(var s=0;s<i.length;s++)if(i[s].prop===e){i[s].children.push(n);break}}():i.push(n)}return this.getMergeList(i),this.getExportList(i),this.childColumnList=i.filter((function(e){return"table"===e.jnpfKey})),i},getExportList:function(e){for(var t=[],i=0;i<e.length;i++)"table"===e[i].jnpfKey?4!=this.columnData.type&&t.push.apply(t,Object(l["a"])(e[i].children)):"complexHeader"===e[i].jnpfKey?t.push.apply(t,Object(l["a"])(e[i].children)):t.push(e[i]);this.exportList=t},initDefaultSearchData:function(){var e=this.columnData.searchList;if(null!=e&&e.length>0){for(var t={},i=0;i<e.length;i++){var a=e[i];a.value&&(Array.isArray(a.value)?a.value.length&&(t[a.id]=a.value):t[a.id]=a.value)}this.listQuery.queryJson="{}"===JSON.stringify(t)?"":JSON.stringify(t)}},getMergeList:function(e){var t=this;e.forEach((function(e){e.children&&e.children.length>0&&"table"==e.jnpfKey?e.children.forEach((function(i,a){0==a?t.mergeList.push({prop:i.prop,rowspan:1,colspan:e.children.length}):t.mergeList.push({prop:i.prop,rowspan:0,colspan:0})})):t.mergeList.push({prop:e.prop,rowspan:1,colspan:1})}))},arraySpanMethod:function(e){for(var t=e.column,i=0;i<this.mergeList.length;i++)if(t.property==this.mergeList[i].prop)return[this.mergeList[i].rowspan,this.mergeList[i].colspan]},toggleExpand:function(e,t){e[t]=!e[t]},getNodePath:function(e){var t=[],i=function e(i){i.level&&t.unshift(i.data),i.parent&&e(i.parent)};return i(e),t},handleNodeClick:function(e,t){var i=this;if(this.treeActiveId!=e[this.treeProps.value]){this.treeActiveId=e[this.treeProps.value],this.$refs.Search.treeReset();var a={};if("organize"===this.columnData.treeDataSource||e.parentId){var n=this.getNodePath(t),l=n.map((function(e){return e[i.treeProps.value]}));a=Object(o["a"])({},this.columnData.treeRelation,l),this.treeActiveId=l}else a=Object(o["a"])({},this.columnData.treeRelation,e[this.treeProps.value]);this.search(JSON.stringify(a))}},handleDel:function(e,t){var i=this;this.$confirm(this.$t("common.delTip"),this.$t("common.tipTitle"),{type:"warning"}).then((function(){e?Object(p["j"])(i.modelId,e).then((function(e){i.$message({type:"success",message:e.msg,duration:1e3,onClose:function(){i.initData()}})})):i.list.splice(t,1)})).catch((function(){}))},editForRowEdit:function(e){if(e.rowEdit=!0,this.addHandleForRowEdit(!0),4!==this.columnData.type){var t=e.flowId||this.flowList[0].id;if(t){var i=this.flowList.filter((function(e){return e.id===t}));this.currFlow=i.length?i[0]:this.flowList[0];var a=this.currFlow.flowTemplateJson?JSON.parse(this.currFlow.flowTemplateJson):{};this.isCustomCopy=a.properties&&a.properties.isCustomCopy}}},saveForRowEdit:function(e,t,i){var a=this;if(this.isPreview)return this.$message({message:"功能预览不支持数据保存",type:"warning"});if(1==this.config.enableFlow){var n={id:e.id,status:t||"1",candidateType:this.candidateType,formData:e,flowId:this.currFlow.id,flowUrgent:1};i&&(n=Object(c["a"])(Object(c["a"])({},n),i));var o=n.id?f["c"]:f["a"];o(n).then((function(e){a.$message({message:e.msg,type:"success",duration:1500,onClose:function(){a.candidateVisible=!1,a.initData()}})}))}else{var l={id:e.id,data:JSON.stringify(e)},r=l.id?p["y"]:p["i"];r(this.modelId,l).then((function(e){a.$message({message:e.msg,type:"success",duration:1500,onClose:function(){a.candidateVisible=!1,a.initData()}})}))}},submitForRowEdit:function(e){var t=this;if(this.currRow=e,this.isPreview)return this.$message({message:"功能预览不支持数据保存",type:"warning"});this.workFlowFormData={id:e.id,formData:e,flowId:this.currFlow.id},Object(g["g"])(0,this.workFlowFormData).then((function(i){var a=i.data;if(t.candidateType=a.type,1==a.type)t.branchList=i.data.list.filter((function(e){return e.isBranchFlow})),t.candidateList=i.data.list.filter((function(e){return!e.isBranchFlow&&e.isCandidates})),t.candidateVisible=!0;else if(2==a.type)t.branchList=[],t.candidateList=i.data.list.filter((function(e){return e.isCandidates})),t.candidateVisible=!0;else{if(t.isCustomCopy)return t.branchList=[],t.candidateList=[],void(t.candidateVisible=!0);t.$confirm("您确定要提交当前流程吗, 是否继续?","提示",{type:"warning"}).then((function(){t.saveForRowEdit(e,"0")})).catch((function(){}))}})).catch((function(){}))},submitCandidate:function(e){this.saveForRowEdit(this.currRow,"0",e)},cancelRowEdit:function(e,t){if(!e.id)return this.list.splice(t,1);e.rowEdit=!1;var i=JSON.parse(JSON.stringify(this.cacheList[t]));this.$set(this.list,t,i)},addHandleForRowEdit:function(e){for(var t={rowEdit:!0},i=0;i<this.columnData.columnList.length;i++){var a=this.columnData.columnList[i];t[a.id]=a.__config__.defaultValue;var n=a.__config__;if("date"===a.__config__.jnpfKey){if(1==a.__config__.defaultCurrent&&(t[a.id]=(new Date).getTime()),n.startTimeRule)if(1==n.startTimeType)a.startTime=n.startTimeValue;else if(3==n.startTimeType)a.startTime=(new Date).getTime();else if(4==n.startTimeType){var o="";1==n.startTimeTarget||2==n.startTimeTarget?(o=Object(C["getDateDay"])(n.startTimeTarget,n.startTimeType,n.startTimeValue),a.startTime=new Date(o).getTime()):3==n.startTimeTarget?(o=Object(C["getBeforeData"])(n.startTimeValue),a.startTime=new Date(o).getTime()):a.startTime=Object(C["getBeforeTime"])(n.startTimeTarget,n.startTimeValue).getTime()}else if(5==n.startTimeType){var l="";1==n.startTimeTarget||2==n.startTimeTarget?(l=Object(C["getDateDay"])(n.startTimeTarget,n.startTimeType,n.startTimeValue),a.startTime=new Date(l).getTime()):3==n.startTimeTarget?(l=Object(C["getLaterData"])(n.startTimeValue),a.startTime=new Date(l).getTime()):a.startTime=Object(C["getLaterTime"])(n.startTimeTarget,n.startTimeValue).getTime()}if(n.endTimeRule)if(1==n.endTimeType)a.endTime=n.endTimeValue;else if(3==n.endTimeType)a.endTime=(new Date).getTime();else if(4==n.endTimeType){var r="";1==n.endTimeTarget||2==n.endTimeTarget?(r=Object(C["getDateDay"])(n.endTimeTarget,n.endTimeType,n.endTimeValue),a.endTime=new Date(r).getTime()):3==n.endTimeTarget?(r=Object(C["getBeforeData"])(n.endTimeValue),a.endTime=new Date(r).getTime()):a.endTime=Object(C["getBeforeTime"])(n.endTimeTarget,n.endTimeValue).getTime()}else if(5==n.endTimeType){var s="";1==n.endTimeTarget||2==n.endTimeTarget?(s=Object(C["getDateDay"])(n.endTimeTarget,n.endTimeType,n.endTimeValue),a.endTime=new Date(s).getTime()):3==n.endTimeTarget?(s=Object(C["getLaterData"])(n.endTimeValue),a.endTime=new Date(s).getTime()):a.endTime=Object(C["getLaterTime"])(n.endTimeTarget,n.endTimeValue).getTime()}}else if("organizeSelect"===a.__config__.jnpfKey&&1==a.__config__.defaultCurrent)this.userInfo.organizeIdList instanceof Array&&this.userInfo.organizeIdList.length>0?t[a.id]=1==a.multiple?[this.userInfo.organizeIdList]:this.userInfo.organizeIdList:t[a.id]=[];else if("time"===a.__config__.jnpfKey){1==a.__config__.defaultCurrent&&(t[a.id]=this.jnpf.toDate(new Date,a.format));var c="HH:mm"===a.format?"HH:mm:00":a.format;if(n.startTimeRule)if(1==n.startTimeType)a.startTime=n.startTimeValue||"00:00:00",3==a.startTime.split(":").length?a.startTime=a.startTime:a.startTime=a.startTime+":00";else if(3==n.startTimeType)a.startTime=this.jnpf.toDate(new Date,c);else if(4==n.startTimeType){var d="";d=Object(C["getBeforeTime"])(n.startTimeTarget,n.startTimeValue),a.startTime=this.jnpf.toDate(d,c)}else if(5==n.startTimeType){var u="";u=Object(C["getLaterTime"])(n.startTimeTarget,n.startTimeValue),a.startTime=this.jnpf.toDate(u,c)}if(n.endTimeRule)if(1==n.endTimeType)a.endTime=n.endTimeValue||"23:59:59",3==a.endTime.split(":").length?a.endTime=a.endTime:a.endTime=a.endTime+":00";else if(3==n.endTimeType)a.endTime=this.jnpf.toDate(new Date,c);else if(4==n.endTimeType){var p="";p=Object(C["getBeforeTime"])(n.endTimeTarget,n.endTimeValue),a.endTime=this.jnpf.toDate(p,c)}else if(5==n.endTimeType){var f="";f=Object(C["getLaterTime"])(n.endTimeTarget,n.endTimeValue),a.endTime=this.jnpf.toDate(f,c)}}}e||this.list.unshift(t)},addHandle:function(){var e=this;1==this.config.enableFlow?this.flowList.length?1===this.flowList.length?this.selectFlow(this.flowList[0]):this.flowListVisible=!0:this.$message({type:"error",message:"流程不存在"}):4===this.columnData.type?this.addHandleForRowEdit():(this.formVisible=!0,this.$nextTick((function(){e.$refs.Form.init(e.formData,e.modelId,"",e.isPreview,e.columnData.useFormPermission,e.list,e.columnData.type)})))},selectFlow:function(e){var t=this;if(this.currFlow=e,4===this.columnData.type){var i=e.flowTemplateJson?JSON.parse(e.flowTemplateJson):{};this.isCustomCopy=i.properties&&i.properties.isCustomCopy,this.flowListVisible=!1,this.addHandleForRowEdit()}else{var a={id:"",flowId:e.id,opType:"-1",type:1,modelId:this.modelId,isPreview:this.isPreview};this.flowListVisible=!1,this.flowVisible=!0,this.$nextTick((function(){t.$refs.FlowBox.init(a)}))}},updateHandle:function(e){var t=this;if(1==this.config.enableFlow){var i={id:e.id,flowId:e.flowId||this.flowList[0].id,type:1,opType:"-1",modelId:this.modelId,isPreview:this.isPreview};this.flowVisible=!0,this.$nextTick((function(){t.$refs.FlowBox.init(i)}))}else this.formVisible=!0,this.$nextTick((function(){t.$refs.Form.init(t.formData,t.modelId,e.id,t.isPreview,t.columnData.useFormPermission,t.list,t.columnData.type)}))},headBtnsHandel:function(e){var t=this;if("add"===e&&this.addHandle(),"download"==e&&(this.exportBoxVisible=!0,this.$nextTick((function(){t.$refs.ExportBox.init(t.exportList)}))),"upload"==e&&(this.uploadBoxVisible=!0,this.$nextTick((function(){t.$refs.UploadBox.init(t.modelId,"",t.config.enableFlow,t.flowList)}))),!this.isPreview&&("batchRemove"===e&&this.batchRemove(),"batchPrint"===e)){if(!this.multipleSelection.length)return void this.$message({type:"error",message:"请选择一条数据",duration:1500});this.printDialog()}},handleSelectionChange:function(e){var t=e.map((function(e){return e.id}));this.multipleSelection=t},batchRemove:function(){var e=this;this.multipleSelection.length?this.$confirm("您确定要删除这些数据吗, 是否继续?","提示",{type:"warning"}).then((function(){Object(p["h"])(e.modelId,e.multipleSelection).then((function(t){e.$message({type:"success",message:t.msg,duration:1500,onClose:function(){e.initData()}})}))})).catch((function(){})):this.$message({type:"error",message:"请选择一条数据",duration:1500})},download:function(e){var t=this;if(this.isPreview)return this.$message({message:"功能预览不支持数据导出",type:"warning"});var i=Object(c["a"])(Object(c["a"])({},this.listQuery),e);Object(p["l"])(this.modelId,i).then((function(e){e.data.url&&(t.jnpf.downloadFile(e.data.url),t.$refs.ExportBox.visible=!1,t.exportBoxVisible=!1)}))},columnBtnsHandel:function(e,t,i){"edit"===e&&this.updateHandle(t),"detail"===e&&this.goDetail(t),"remove"==e&&this.handleDel(t.id,i)},goDetail:function(e){var t=this;if(1==this.config.enableFlow){var i={id:e.id,flowId:e.flowId,type:1,opType:0,modelId:this.modelId,isPreview:this.isPreview,status:e.flowState};this.flowVisible=!0,this.$nextTick((function(){t.$refs.FlowBox.init(i)}))}else this.detailVisible=!0,this.$nextTick((function(){t.$refs.Detail.init(t.formData,t.modelId,e.id,t.columnData.useFormPermission)}))},sortChange:function(e){e.column;var t=e.prop,i=e.order;this.listQuery.sort="ascending"==i?"asc":"desc",this.listQuery.sidx=i?t:"",this.initData()},refresh:function(e){this.formVisible=!1,this.extraFormVisible=!1,e&&this.initData()},closeFlow:function(e){this.flowVisible=!1,e&&this.initData()},reset:function(){var e=this;return Object(s["a"])(Object(r["a"])().mark((function t(){var i,a;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.listQuery.sort=e.defaultListQuery.sort,e.listQuery.sidx=e.defaultListQuery.sidx,2!==e.columnData.type){t.next=8;break}i=Object(o["a"])({},e.columnData.treeRelation,e.treeActiveId),a=e.treeActiveId?JSON.stringify(i):"",e.search(a),t.next=11;break;case 8:return t.next=10,e.initDefaultSearchData();case 10:e.search(e.listQuery.queryJson);case 11:case"end":return t.stop()}}),t)})))()},searchData:function(e){2===this.columnData.type&&this.treeActiveId&&(e=e?JSON.parse(e):"",e=Object(c["a"])(Object(o["a"])({},this.columnData.treeRelation,this.treeActiveId),e),e=JSON.stringify(e)),this.search(e)},search:function(e){this.isPreview||(e||this.$refs.treeBox&&this.$refs.treeBox.setCurrentKey(null),this.listQuery.queryJson=e,this.listQuery.currentPage=1,this.initData())},openSuperQuery:function(){var e=this;this.superQueryVisible=!0,this.$nextTick((function(){e.$refs.SuperQuery.init()}))},superQuery:function(e){this.isPreview||(this.listQuery.superQueryJson=e,this.listQuery.currentPage=1,this.initData())},customBtnsHandel:function(e,t,i){1==e.event.btnType&&this.handlePopup(e.event,t,i),2==e.event.btnType&&this.handleScriptFunc(e.event,t,i),3==e.event.btnType&&this.handleInterface(e.event,t,i)},handlePopup:function(e,t,i){var a=this;this.customBoxVisible=!0,this.$nextTick((function(){a.$refs.CustomBox.init(e,a.modelId,t.id,a.isPreview)}))},handleScriptFunc:function(e,t,i){var a={data:t,index:i,refresh:this.initData,onlineUtils:this.jnpf.onlineUtils},n=this.jnpf.getScriptFunc.call(this,e.func);n&&n.call(this,a)},handleInterface:function(e,t){var i=this,a=function(){Object(p["r"])(i.modelId,t.id).then((function(a){var n=a.data||{};if(n.data){var o=Object(c["a"])(Object(c["a"])({},JSON.parse(n.data)),{},{id:t.id});e.templateJson&&e.templateJson.length&&e.templateJson.forEach((function(e){e.defaultValue=1==e.sourceType?o[e.relationField]||"":e.relationField}));var l={paramList:e.templateJson||[]};Object(h["i"])(e.interfaceId,l).then((function(e){i.$message({message:e.msg,type:"success"})}))}}))};if(!e.useConfirm)return a();this.$confirm(e.confirmTitle||"确认执行此操作","提示",{type:"warning"}).then((function(){a()})).catch((function(){}))},setTableLoadFunc:function(){var e=this.$refs.tableRef.$refs.JNPFTable,t={data:this.list,tableRef:e,onlineUtils:this.jnpf.onlineUtils},i=this.jnpf.getScriptFunc.call(this,this.columnData.funcs.afterOnload);i&&i.call(this,t)},buildOptions:function(){var e=this;this.columnData.columnList.forEach((function(t){var i=t.__config__;if(_["dyOptionsList"].indexOf(i.jnpfKey)>-1){"treeSelect"===i.jnpfKey||i.jnpfKey;if("dictionary"===i.dataType){if(!i.dictionaryType)return;e.$store.dispatch("base/getDicDataSelector",i.dictionaryType).then((function(e){t.options=e}))}if("dynamic"===i.dataType){if(!i.propsUrl)return;var a={paramList:i.templateJson||[]};Object(h["i"])(i.propsUrl,a).then((function(e){var i=e.data;Array.isArray(i)?t.options=i:t.options=[]}))}}}))},filterNode:function(e,t){return!e||-1!==t[this.treeProps.label].indexOf(e)},toggleTreeExpand:function(e){var t=this;this.keyword="",this.refreshTree=!1,this.expandsTree=e,this.$nextTick((function(){t.refreshTree=!0,t.$nextTick((function(){t.$refs.treeBox.setCurrentKey(null)}))}))},toggleExpandList:function(){var e=this;this.refreshTable=!1,this.expandsTable=!this.expandsTable,this.$nextTick((function(){e.refreshTable=!0}))},loadNode:function(e,t){var i=e.data,a=this.columnData;if(a.treeInterfaceId){if(a.treeTemplateJson&&a.treeTemplateJson.length)for(var n=0;n<a.treeTemplateJson.length;n++){var o=a.treeTemplateJson[n];o.defaultValue=i[o.relationField]||""}var l={paramList:a.treeTemplateJson||[]};Object(h["i"])(a.treeInterfaceId,l).then((function(e){var i=e.data;Array.isArray(i)?t(i):t([])}))}},treeLoad:function(e,t,i){var a=this;Object(p["t"])(this.modelId,e.id,this.listQuery).then((function(e){if(e.data.list&&Array.isArray(e.data.list)){var t=e.data.list.map((function(e){return Object(c["a"])(Object(c["a"])(Object(c["a"])({},e),a.expandObj),{},{hasChildren:!0})}));i(t)}else i([])}))},getFlowList:function(){var e=this;Object(y["v"])(this.config.flowId,"1").then((function(t){e.flowList=t.data}))},handleRowForm:function(e){var t=this;this.extraFormVisible=!0;var i=[];this.$nextTick((function(){var a=t.columnList.filter((function(e){return"table"!=e.jnpfKey}));a.forEach((function(e){var t;"complexHeader"===e.jnpfKey?(t=i).push.apply(t,Object(l["a"])(e.children)):i.push(e)})),i=i.map((function(e){return e.__config__.span=24,e.__config__.label=e.label,e.__config__.templateJson&&e.__config__.templateJson.length&&(e.__config__.templateJson=e.__config__.templateJson.map((function(e){return Object(c["a"])(Object(c["a"])({},e),{},{relationField:""})}))),e.templateJson&&e.templateJson.length&&(e.templateJson=e.templateJson.map((function(e){return Object(c["a"])(Object(c["a"])({},e),{},{relationField:""})}))),e}));var n=Object(c["a"])(Object(c["a"])({},t.formData),{},{fields:i});t.$refs.extraForm.init(n,t.modelId,t.isPreview,t.columnData.useFormPermission,t.list[e])}))},getFixed:function(e,t){return 0==t&&this.columnData.groupField&&3==this.columnData.type?!!this.columnList.some((function(e){return"left"==e.fixed}))&&"left":2!=this.columnData.childTableStyle&&("none"!=e.fixed&&e.fixed)}}},P=$,B=(i("fb14"),i("2877")),J=Object(B["a"])(P,a,n,!1,null,"bc685dd2",null);t["default"]=J.exports},aa06:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{staticClass:"JNPF-dialog JNPF-dialog_center",attrs:{title:"详情","close-on-click-modal":!1,visible:e.visible,"lock-scroll":"",width:e.formData.generalWidth,"append-to-body":""},on:{"update:visible":function(t){e.visible=t}}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading||e.mainLoading,expression:"loading || mainLoading"}],staticClass:"dynamicDetail"},[e.loading?e._e():t("Parser",{attrs:{formConf:e.formData,relationData:e.relationData,formValue:e.formValue},on:{toDetail:e.toDetail}})],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.formData.hasPrintBtn&&e.formData.printId?[t("el-button",{attrs:{type:"primary"},on:{click:e.print}},[e._v(" "+e._s(e.formData.printButtonText||"打 印")+" ")])]:e._e(),t("el-button",{on:{click:function(t){e.visible=!1}}},[e._v(e._s(e.$t("common.cancelButton")))])],2)]),t("print-browse",{attrs:{visible:e.printBrowseVisible,id:e.printId,formId:e.dataForm.id},on:{"update:visible":function(t){e.printBrowseVisible=t}}}),e.printDialogVisible?t("PrintDialog",{ref:"printDialog",on:{change:e.printBrowseHandle}}):e._e()],1)},n=[],o=(i("d3b7"),i("159b"),i("caad"),i("2532"),i("e260"),i("4ec9"),i("3ca3"),i("ddb0"),i("4de4"),i("14d9"),i("f41a")),l=i("ef22"),r=i("17de"),s=i("ed08"),c=i("cb1d"),d=i("6637"),u={name:"RelevanceDetail",components:{Parser:c["default"],PrintBrowse:d["default"],PrintDialog:o["default"]},data:function(){return{printId:"",printDialogVisible:!1,visible:!1,dataForm:{id:"",data:""},modelId:"",formData:{},formValue:{},loading:!0,mainLoading:!1,detailVisible:!1,relationData:{},useFormPermission:!1,printBrowseVisible:!1,formOperates:[]}},methods:{goBack:function(){this.$emit("close")},printBrowseHandle:function(e){this.printDialogVisible=!1,this.printId=e,this.printBrowseVisible=!0},print:function(){var e=this;if(this.isPreview)return this.$message({message:"功能预览不支持打印",type:"warning"});this.printDialogVisible=!0,this.$nextTick((function(){1!=e.formData.printId.length?e.$refs.printDialog.init(e.formData.printId):e.printBrowseHandle(e.formData.printId[0])}))},init:function(e,t,i,a){var n=this;this.formData=Object(s["b"])(e),this.modelId=t,this.useFormPermission=a,this.dataForm.id=i||"",this.getFormOperates(),this.loading=!0,this.relationData={},this.$nextTick((function(){if(n.dataForm.id){var e={modelId:t,id:i,type:2};n.$store.commit("generator/SET_DYNAMIC_MODEL_EXTRA",e),Object(l["n"])(t,n.dataForm.id).then((function(e){n.dataForm=e.data,n.dataForm.data&&(n.formValue=JSON.parse(n.dataForm.data),n.fillFormData(n.formData,n.formValue),n.initRelationForm(n.formData.fields),n.visible=!0)}))}else n.formValue={},n.loading=!1,n.visible=!1,n.$emit("close")}))},initRelationForm:function(e){var t=this;e.forEach((function(i){var a=i.__config__;if("relationFormAttr"==a.jnpfKey||"popupAttr"==a.jnpfKey){var n=i.relationField.split("_jnpfTable_")[0];e.forEach((function(e){var t=Array.isArray(e.__config__.visibility)&&!e.__config__.visibility.includes("pc");n==e.__vModel__&&(t||e.__config__.noShow)&&(i.__config__.noShow=!0)}))}i.__config__.children&&i.__config__.children.length&&t.initRelationForm(i.__config__.children)}))},unique:function(e,t){var i=new Map;return e.filter((function(e){return!i.has(e[t])&&i.set(e[t],1)}))},handleAttrList:function(e){for(var t=this,i=this.unique(e,"relationField"),a=function(e){var a=i[e],n="",o="",s="",c="",d={},u=a.relationField.split("_jnpfTable_")[0],p=function e(t){for(var i=0;i<t.length;i++){if(u===t[i].__vModel__){c=t[i].__config__.jnpfKey,n="relationForm"===t[i].__config__.jnpfKey?t[i].modelId:t[i].interfaceId,o=t[i].__config__.defaultValue,s=t[i].__config__.tableName?t[i].__vModel__+"_jnpfTable_"+t[i].__config__.tableName+(t[i].__config__.isSubTable?"0":"1"):t[i].__vModel__,d=t[i];break}t[i].__config__&&"table"!==t[i].__config__.jnpfKey&&t[i].__config__.children&&Array.isArray(t[i].__config__.children)&&e(t[i].__config__.children)}};if(p(t.formData.fields),!o)return t.$set(t.relationData,s,""),"continue";if("relationForm"===c&&Object(l["n"])(n,o).then((function(e){if(e.data&&e.data.data){var i=JSON.parse(e.data.data);t.$set(t.relationData,s,i)}else t.$set(t.relationData,s,"")})).catch((function(){t.$set(t.relationData,s,"")})),"popupSelect"===c){var f=t.getParamList(d),m={ids:[o],interfaceId:n,propsValue:d.propsValue,relationField:d.relationField,paramList:f};Object(r["e"])(n,m).then((function(e){if(!e.data)return t.$set(t.relationData,s,"");t.$set(t.relationData,s,e.data&&e.data.length?e.data[0]:{})})).catch((function(){t.$set(t.relationData,s,"")}))}},n=0;n<i.length;n++)a(n)},getParamList:function(e){var t=e.templateJson;if(!this.formValue)return t;for(var i=0;i<t.length;i++)if(t[i].relationField)if(t[i].relationField.includes("-")){var a=t[i].relationField.split("-")[0],n=t[i].relationField.split("-")[1];t[i].defaultValue=this.formValue[a]&&this.formValue[a][this.rowIndex]&&this.formValue[a][this.rowIndex][n]||""}else t[i].defaultValue=this.formValue[t[i].relationField]||"";return t},toDetail:function(e){var t=this;e.__config__.defaultValue&&(this.mainLoading=!0,Object(l["m"])(e.modelId).then((function(i){if(t.mainLoading=!1,i.data&&i.data.formData){var a=JSON.parse(i.data.formData);a.popupType=t.formData.popupType,t.detailVisible=!0,t.$nextTick((function(){t.$refs.Detail.init(a,e.modelId,e.__config__.defaultValue)}))}})).catch((function(){t.mainLoading=!1})))},getFormOperates:function(){if(this.useFormPermission){var e=this.$store.getters.permissionList,t=this.$route.meta.modelId,i=e.filter((function(e){return e.modelId===t}));this.formOperates=i[0]&&i[0].form?i[0].form:[]}},fillFormData:function(e,t){var i=this,a=[],n=function e(n,o){for(var l=0;l<n.length;l++){var r=n[l];if(r.__vModel__){if("relationForm"===r.__config__.jnpfKey||"popupSelect"===r.__config__.jnpfKey)r.__config__.defaultValue=t[r.__vModel__+"_id"],i.$set(r,"name",t[r.__vModel__]||"");else{var s=t.hasOwnProperty(r.__vModel__)?t[r.__vModel__]:r.__config__.defaultValue;r.__config__.defaultValue=s}i.useFormPermission&&function(){var e=r.__config__.isSubTable?o.__vModel__+"-"+r.__vModel__:r.__vModel__,t=!0;i.formOperates&&i.formOperates.length&&(t=!i.formOperates.some((function(t){return t.enCode===e}))),t=r.__config__.noShow?r.__config__.noShow:t,i.$set(r.__config__,"noShow",t)}()}["relationFormAttr","popupAttr"].includes(r.__config__.jnpfKey)&&a.push(r),r.__config__&&r.__config__.children&&Array.isArray(r.__config__.children)&&e(r.__config__.children,r)}};n(e.fields),this.handleAttrList(a),this.loading=!1}}},p=u,f=i("2877"),m=Object(f["a"])(p,a,n,!1,null,null,null);t["default"]=m.exports},b4b7:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"JNPF-common-layout"},[e.config.enableFlow?[e.flowVisible?t("FlowBox",{ref:"FlowBox",on:{close:e.closeFlow}}):e._e(),t("el-dialog",{staticClass:"JNPF-dialog template-dialog JNPF-dialog_center",attrs:{title:"请选择流程","close-on-click-modal":!1,"append-to-body":"",visible:e.flowListVisible,"lock-scroll":"",width:"400px"},on:{"update:visible":function(t){e.flowListVisible=t}}},[t("el-scrollbar",{staticClass:"template-list"},e._l(e.flowList,(function(i){return t("div",{key:i.id,staticClass:"template-item",on:{click:function(t){return e.selectFlow(i)}}},[e._v(e._s(i.fullName)+" ")])})),0)],1)]:t("div",{staticClass:"JNPF-preview-main"},[t("div",{staticClass:"JNPF-common-page-header"},[t("p",[e._v(e._s(e.config.fullName))]),t("div",{staticClass:"options"},[t("el-button",{attrs:{type:"primary",loading:e.btnLoading},on:{click:function(t){return e.dataFormSubmit()}}},[e._v(" "+e._s(e.formConf.confirmButtonText||"确 定"))]),t("el-button",{attrs:{type:"warning"},on:{click:function(t){return e.resetForm()}}},[e._v("重置")])],1)]),t("div",{staticClass:"dynamic-form-main",style:{margin:"0 auto",width:e.formConf.fullScreenWidth}},[e.loading?e._e():t("parser",{key:e.key,ref:"dynamicForm",attrs:{"form-conf":e.formConf},on:{submit:e.submitForm}})],1)])],2)},n=[],o=i("5530"),l=(i("d81d"),i("caad"),i("e9c4"),i("ef22")),r=i("49aa"),s=i("226a"),c=i("5451"),d=i("5880"),u={components:{Parser:r["default"],FlowBox:s["default"]},props:["config","modelId","isPreview"],data:function(){return{visible:!1,dataForm:{data:""},btnLoading:!1,loading:!0,key:+new Date,formConf:{},flowVisible:!1,flowListVisible:!1,flowList:[],flowItem:{}}},computed:Object(o["a"])({},Object(d["mapGetters"])(["userInfo"])),created:function(){this.init()},methods:{init:function(e){var t=this;this.config.enableFlow?this.getFlowList(e):(this.formConf=JSON.parse(this.config.formData),this.fillFormData(this.formConf,{}),this.loading=!0,this.$nextTick((function(){t.visible=!0,t.loading=!1,t.key=+new Date})))},fillFormData:function(e,t,i){var a=this,n=function e(t,i){for(var n=0;n<t.length;n++){var o=t[n];if(o.__vModel__){if(o.__config__.defaultCurrent){if("datePicker"===o.__config__.jnpfKey){var l=o.format,r=a.jnpf.toDate((new Date).getTime(),l),s="yyyy"===l?"-01-01 00:00:00":"yyyy-MM"===l?"-01 00:00:00":"yyyy-MM-dd"===l?" 00:00:00":"",c=new Date(r+s).getTime();o.__config__.defaultValue=c}"timePicker"===o.__config__.jnpfKey&&(o.__config__.defaultValue=a.jnpf.toDate(new Date,o.format)),"organizeSelect"===o.__config__.jnpfKey&&a.userInfo.organizeIdList instanceof Array&&a.userInfo.organizeIdList.length>0&&(o.__config__.defaultValue=1==o.multiple?[a.userInfo.organizeIdList]:a.userInfo.organizeIdList),"depSelect"===o.__config__.jnpfKey&&a.userInfo.departmentId&&(o.__config__.defaultValue=o.multiple?[a.userInfo.departmentId]:a.userInfo.departmentId),"posSelect"===o.__config__.jnpfKey&&a.userInfo.positionIds instanceof Array&&a.userInfo.positionIds.length>0&&(o.__config__.defaultValue=o.multiple?a.userInfo.positionIds.map((function(e){return e.id})):a.userInfo.positionIds[0].id),"roleSelect"===o.__config__.jnpfKey&&a.userInfo.roleIds instanceof Array&&a.userInfo.roleIds.length>0&&(o.__config__.defaultValue=o.multiple?a.userInfo.roleIds:a.userInfo.roleIds[0]),"groupSelect"===o.__config__.jnpfKey&&a.userInfo.groupIds instanceof Array&&a.userInfo.groupIds.length>0&&(o.__config__.defaultValue=o.multiple?a.userInfo.groupIds:a.userInfo.groupIds[0]),["userSelect"].includes(o.__config__.jnpfKey)&&a.userInfo.userId&&(o.__config__.defaultValue=o.multiple?[a.userInfo.userId]:a.userInfo.userId),"usersSelect"===o.__config__.jnpfKey&&a.userInfo.userId&&(o.__config__.defaultValue=o.multiple?[a.userInfo.userId+"--user"]:a.userInfo.userId+"--user")}if("datePicker"===o.__config__.jnpfKey&&o.__config__.defaultCurrent){var d=o.format,u=a.jnpf.toDate((new Date).getTime(),d),p="yyyy"===d?"-01-01 00:00:00":"yyyy-MM"===d?"-01 00:00:00":"yyyy-MM-dd"===d?" 00:00:00":"",f=new Date(u+p).getTime();o.__config__.defaultValue=f}else"organizeSelect"===o.__config__.jnpfKey&&o.__config__.defaultCurrent?a.userInfo.organizeIdList instanceof Array&&a.userInfo.organizeIdList.length>0?o.__config__.defaultValue=1==o.multiple?[a.userInfo.organizeIdList]:a.userInfo.organizeIdList:o.__config__.defaultValue=[]:"timePicker"===o.__config__.jnpfKey&&o.__config__.defaultCurrent&&(o.__config__.defaultValue=a.jnpf.toDate(new Date,o.format))}o.__config__&&o.__config__.children&&Array.isArray(o.__config__.children)&&e(o.__config__.children,o)}};n(e.fields),e.formData=t},getFlowList:function(e){var t=this;Object(c["v"])(this.config.flowId,"1").then((function(i){return t.flowList=i.data,e&&t.flowItem.id?t.selectFlow(t.flowItem):t.flowList.length?1===t.flowList.length?t.selectFlow(t.flowList[0]):void(t.flowListVisible=!0):t.$message({type:"error",message:"流程不存在"})}))},selectFlow:function(e){var t=this;this.flowItem=e;var i={id:"",enCode:this.config.flowEnCode,flowId:e.id,formType:2,opType:"-1",type:1,modelId:this.modelId,isPreview:this.isPreview,fromForm:1,hideCancelBtn:!0};this.flowListVisible=!1,this.flowVisible=!0,this.$nextTick((function(){t.$refs.FlowBox.init(i)}))},submitForm:function(e,t){var i=this;e&&(this.btnLoading=!0,this.dataForm.data=JSON.stringify(e),Object(l["i"])(this.modelId,this.dataForm).then((function(e){i.$message({message:e.msg,type:"success",duration:1500,onClose:function(){t&&"function"===typeof t&&t(),i.btnLoading=!1,i.resetForm()}})})).catch((function(){i.btnLoading=!1})))},dataFormSubmit:function(){if(this.isPreview)return this.$message({message:"功能预览不支持数据保存",type:"warning"});this.$refs.dynamicForm&&this.$refs.dynamicForm.submitForm()},resetForm:function(){var e=this;this.formConf=JSON.parse(this.config.formData),this.fillFormData(this.formConf,{}),this.$nextTick((function(){e.$refs.dynamicForm&&e.$refs.dynamicForm.resetForm()}))},closeFlow:function(e){e&&this.init(!0)}}},p=u,f=i("2877"),m=Object(f["a"])(p,a,n,!1,null,null,null);t["default"]=m.exports},ba53:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e._self._c;return t("div",["general"===e.formConf.popupType&&e.dialogLoading?[t("el-dialog",{staticClass:"JNPF-dialog JNPF-dialog_center",attrs:{title:e.dataForm.id?"编辑":"新建","close-on-click-modal":!1,visible:e.visible,"lock-scroll":"",width:e.formConf.generalWidth},on:{"update:visible":function(t){e.visible=t},close:function(t){return e.goBack()}}},[e.loading?e._e():t("parser",{key:e.key,ref:"dynamicForm",attrs:{"form-conf":e.formConf},on:{submit:e.submitForm}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.dataForm.id&&e.showMoreBtn&&e.formConf.hasConfirmAndAddBtn?t("div",{staticClass:"upAndDown-button"},[t("el-button",{attrs:{disabled:e.prevDis},on:{click:e.prev}},[e._v(" "+e._s("上一条")+" ")]),t("el-button",{attrs:{disabled:e.nextDis},on:{click:e.next}},[e._v(" "+e._s("下一条")+" ")])],1):e._e(),(e.formConf.hasPrintBtn&&e.formConf.printId&&e.dataForm.id,e._e()),t("el-button",{on:{click:e.goBack}},[e._v(e._s(e.formConf.cancelButtonText||"取 消"))]),t("el-button",{attrs:{type:"primary",loading:e.btnLoading,disabled:e.continueBtnLoading},on:{click:function(t){return e.dataFormSubmit()}}},[e._v(" "+e._s(e.formConf.confirmButtonText||"确 定"))]),!e.formConf.hasConfirmAndAddBtn||e.dataForm.id&&5==e.type?e._e():t("el-button",{attrs:{type:"primary",loading:e.continueBtnLoading,disabled:e.btnLoading},on:{click:function(t){return e.dataFormSubmit(2)}}},[e._v(" "+e._s(e.dataForm.id?"确定并继续":"确定并新增"))])],2)],1)]:e._e(),"fullScreen"===e.formConf.popupType?[t("transition",{attrs:{name:"el-zoom-in-center"}},[t("div",{staticClass:"JNPF-preview-main"},[t("div",{staticClass:"JNPF-common-page-header"},[t("el-page-header",{attrs:{content:e.dataForm.id?"编辑":"新建"},on:{back:e.goBack}}),t("div",{staticClass:"options"},[e.formConf.hasConfirmAndAddBtn?t("el-dropdown",{staticClass:"dropdown",attrs:{placement:"bottom"}},[t("el-button",{staticStyle:{width:"70px"},attrs:{disabled:e.continueBtnLoading}},[e._v(" 更 多"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e.dataForm.id&&e.showMoreBtn?[t("el-dropdown-item",{attrs:{disabled:e.prevDis},nativeOn:{click:function(t){return e.prev.apply(null,arguments)}}},[e._v(" "+e._s("上一条")+" ")]),t("el-dropdown-item",{attrs:{disabled:e.nextDis},nativeOn:{click:function(t){return e.next.apply(null,arguments)}}},[e._v(" "+e._s("下一条")+" ")])]:e._e(),e.dataForm.id&&5==e.type?e._e():t("el-dropdown-item",{attrs:{type:"primary",loading:e.continueBtnLoading,disabled:e.btnLoading},nativeOn:{click:function(t){return e.dataFormSubmit(2)}}},[e._v(" "+e._s(e.dataForm.id?"确定并继续":"确定并新增"))])],2)],1):e._e(),(e.formConf.hasPrintBtn&&e.formConf.printId&&e.dataForm.id,e._e()),t("el-button",{attrs:{type:"primary",loading:e.btnLoading,disabled:e.continueBtnLoading},on:{click:function(t){return e.dataFormSubmit()}}},[e._v(" "+e._s(e.formConf.confirmButtonText||"确 定"))]),t("el-button",{attrs:{disabled:e.continueBtnLoading},on:{click:e.goBack}},[e._v(" "+e._s(e.formConf.cancelButtonText||"取 消"))])],2)],1),e.loading?e._e():t("div",{staticClass:"dynamic-form-main",style:{margin:"0 auto",width:e.formConf.fullScreenWidth}},[t("parser",{key:e.key,ref:"dynamicForm",attrs:{"form-conf":e.formConf},on:{submit:e.submitForm}})],1)])])]:e._e(),"drawer"===e.formConf.popupType?[t("el-drawer",{staticClass:"JNPF-common-drawer",attrs:{title:e.dataForm.id?"编辑":"新建",visible:e.visible,wrapperClosable:!1,size:e.formConf.drawerWidth,"append-to-body":""},on:{"update:visible":function(t){e.visible=t},close:function(t){return e.goBack()}}},[t("div",{staticClass:"JNPF-flex-main"},[t("div",{staticClass:"dynamicForm"},[e.loading?e._e():t("parser",{key:e.key,ref:"dynamicForm",attrs:{"form-conf":e.formConf},on:{submit:e.submitForm}})],1),t("div",{staticClass:"drawer-footer"},[e.dataForm.id&&e.showMoreBtn&&e.formConf.hasConfirmAndAddBtn?t("div",{staticClass:"upAndDown-button"},[t("el-button",{attrs:{disabled:e.prevDis},on:{click:e.prev}},[e._v(" "+e._s("上一条")+" ")]),t("el-button",{attrs:{disabled:e.nextDis},on:{click:e.next}},[e._v(" "+e._s("下一条")+" ")])],1):e._e(),(e.formConf.hasPrintBtn&&e.formConf.printId&&e.dataForm.id,e._e()),t("el-button",{on:{click:function(t){return e.goBack()}}},[e._v(e._s(e.formConf.cancelButtonText||"取 消"))]),t("el-button",{attrs:{type:"primary",loading:e.btnLoading,disabled:e.continueBtnLoading},on:{click:function(t){return e.dataFormSubmit()}}},[e._v(" "+e._s(e.formConf.confirmButtonText||"确 定"))]),e.dataForm.id&&5==e.type||!e.formConf.hasConfirmAndAddBtn?e._e():t("el-button",{attrs:{type:"primary",loading:e.continueBtnLoading,disabled:e.btnLoading},on:{click:function(t){return e.dataFormSubmit(2)}}},[e._v(" "+e._s(e.dataForm.id?"确定并继续":"确定并新增"))])],2)])])]:e._e(),e.printDialogVisible?t("PrintDialog",{ref:"printDialog",on:{change:e.printBrowseHandle}}):e._e(),t("print-browse",{attrs:{visible:e.printBrowseVisible,id:e.printId,formId:e.dataForm.id},on:{"update:visible":function(t){e.printBrowseVisible=t}}})],2)},n=[],o=i("5530"),l=(i("c740"),i("4de4"),i("d3b7"),i("d81d"),i("caad"),i("e9c4"),i("f41a")),r=i("ef22"),s=i("49aa"),c=i("6637"),d=i("ed08"),u=i("5880"),p={components:{Parser:s["default"],PrintBrowse:c["default"],PrintDialog:l["default"]},data:function(){return{printId:"",printDialogVisible:!1,visible:!1,key:+new Date,formConf:{},dataForm:{id:"",data:""},modelId:"",formData:{},btnLoading:!1,loading:!0,isPreview:!1,useFormPermission:!1,printBrowseVisible:!1,formOperates:[],dialogLoading:!1,continueBtnLoading:!1,index:0,prevDis:!1,nextDis:!1,allList:[],showMoreBtn:!0,type:1,refreshDataList:!1}},computed:Object(o["a"])({},Object(u["mapGetters"])(["userInfo"])),methods:{goBack:function(){this.destroyStyle(),this.visible=!1,this.$emit("refreshDataList",this.refreshDataList)},printBrowseHandle:function(e){this.printDialogVisible=!1,this.printId=e,this.printBrowseVisible=!0},print:function(){var e=this;if(this.isPreview)return this.$message({message:"功能预览不支持打印",type:"warning"});this.printDialogVisible=!0,this.$nextTick((function(){e.formConf.printId.length>1?e.$refs.printDialog.init(e.formConf.printId):e.printBrowseHandle(e.formConf.printId)}))},init:function(e,t,i,a,n,l,s){var c=this;this.formConf=Object(d["b"])(e),this.modelId=t,this.isPreview=a,this.useFormPermission=n,this.dataForm.id=i||"",this.getFormOperates(),this.loading=!0,this.dialogLoading=!1,this.prevDis=!1,this.nextDis=!1,this.allList=l||[],this.type=s,3==s||5==s?this.showMoreBtn=!1:this.allList.length?(this.index=this.allList.findIndex((function(e){return e.id===i})),0==this.index&&(this.prevDis=!0),this.index==this.allList.length-1&&(this.nextDis=!0)):(this.prevDis=!0,this.nextDis=!0),this.$nextTick((function(){if(c.dataForm.id){var e={modelId:t,id:i,type:2};c.$store.commit("generator/SET_DYNAMIC_MODEL_EXTRA",e),Object(r["r"])(t,c.dataForm.id).then((function(e){c.dataForm=e.data,c.dataForm.data&&(c.formData=Object(o["a"])(Object(o["a"])({},JSON.parse(c.dataForm.data)),{},{id:c.dataForm.id}),c.fillFormData(c.formConf,c.formData),c.dialogLoading=!0,c.$nextTick((function(){c.visible=!0,c.loading=!1})))}))}else c.$store.commit("generator/SET_DYNAMIC_MODEL_EXTRA",{}),c.formData={},c.fillFormData(c.formConf,c.formData,"add"),c.dialogLoading=!0,c.$nextTick((function(){c.visible=!0,c.loading=!1}));c.key=+new Date}))},prev:function(){this.index--,0===this.index&&(this.prevDis=!0),this.nextDis=!1,this.renewModelInfo()},next:function(){this.index++,this.index===this.allList.length-1&&(this.nextDis=!0),this.prevDis=!1,this.renewModelInfo()},renewModelInfo:function(){var e=this;Object(r["r"])(this.modelId,this.allList[this.index].id).then((function(t){if(e.dataForm=t.data,e.dataForm.data){e.resetForm();var i=Object(o["a"])(Object(o["a"])({},JSON.parse(e.dataForm.data)),{},{id:e.dataForm.id});e.fillFormData(e.formConf,i),e.$nextTick((function(){e.key=+new Date}))}}))},getFormOperates:function(){if(!this.isPreview&&this.useFormPermission){var e=this.$store.getters.permissionList,t=this.$route.meta.modelId,i=e.filter((function(e){return e.modelId===t}));this.formOperates=i[0]&&i[0].form?i[0].form:[]}},fillFormData:function(e,t,i){var a=this,n=function e(n,o){for(var l=0;l<n.length;l++){var r=n[l];if(r.__vModel__){var s=t.hasOwnProperty(r.__vModel__)?t[r.__vModel__]:r.__config__.defaultValue;if(r.__config__.isSubTable||(r.__config__.defaultValue=s),"add"==i&&r.__config__.defaultCurrent){if("datePicker"===r.__config__.jnpfKey){var c=r.format,d=a.jnpf.toDate((new Date).getTime(),c),u="yyyy"===c?"-01-01 00:00:00":"yyyy-MM"===c?"-01 00:00:00":"yyyy-MM-dd"===c?" 00:00:00":"";r.__config__.defaultValue=new Date(d+u).getTime()}"timePicker"===r.__config__.jnpfKey&&(r.__config__.defaultValue=a.jnpf.toDate(new Date,r.format)),"organizeSelect"===r.__config__.jnpfKey&&a.userInfo.organizeIdList instanceof Array&&a.userInfo.organizeIdList.length>0&&(r.__config__.defaultValue=1==r.multiple?[a.userInfo.organizeIdList]:a.userInfo.organizeIdList),"depSelect"===r.__config__.jnpfKey&&a.userInfo.departmentId&&(r.__config__.defaultValue=r.multiple?[a.userInfo.departmentId]:a.userInfo.departmentId),"posSelect"===r.__config__.jnpfKey&&a.userInfo.positionIds instanceof Array&&a.userInfo.positionIds.length>0&&(r.__config__.defaultValue=r.multiple?a.userInfo.positionIds.map((function(e){return e.id})):a.userInfo.positionIds[0].id),"roleSelect"===r.__config__.jnpfKey&&a.userInfo.roleIds instanceof Array&&a.userInfo.roleIds.length>0&&(r.__config__.defaultValue=r.multiple?a.userInfo.roleIds:a.userInfo.roleIds[0]),"groupSelect"===r.__config__.jnpfKey&&a.userInfo.groupIds instanceof Array&&a.userInfo.groupIds.length>0&&(r.__config__.defaultValue=r.multiple?a.userInfo.groupIds:a.userInfo.groupIds[0]),["userSelect"].includes(r.__config__.jnpfKey)&&a.userInfo.userId&&(r.__config__.defaultValue=r.multiple?[a.userInfo.userId]:a.userInfo.userId),"usersSelect"===r.__config__.jnpfKey&&a.userInfo.userId&&(r.__config__.defaultValue=r.multiple?[a.userInfo.userId+"--user"]:a.userInfo.userId+"--user")}!a.isPreview&&a.useFormPermission&&function(){var e=r.__config__.isSubTable?o.__vModel__+"-"+r.__vModel__:r.__vModel__,t=!0;a.formOperates&&a.formOperates.length&&(t=!a.formOperates.some((function(t){return t.enCode===e}))),t=r.__config__.noShow?r.__config__.noShow:t,a.$set(r.__config__,"noShow",t)}()}r.__config__&&r.__config__.children&&Array.isArray(r.__config__.children)&&e(r.__config__.children,r)}};n(e.fields),e.formData=t},resetForm:function(){var e=this;this.$nextTick((function(){e.$refs.dynamicForm&&e.$refs.dynamicForm.resetForm()}))},submitForm:function(e,t,i){var a=this;if(e){2==i?(this.refreshDataList=!0,this.continueBtnLoading=!0):this.btnLoading=!0;var n=Object(o["a"])(Object(o["a"])({},this.formData),e);this.dataForm.data=JSON.stringify(n);var l=this.dataForm.id?r["y"]:r["i"];l(this.modelId,this.dataForm).then((function(e){a.dataForm.id?a.$message({message:e.msg,type:"success",duration:1500,onClose:function(){t&&"function"===typeof t&&t(),a.$nextTick((function(){2==i?Object(r["r"])(a.modelId,a.dataForm.id).then((function(e){a.dataForm=e.data,a.continueBtnLoading=!1,a.dataForm.data&&(a.formData=Object(o["a"])(Object(o["a"])({},JSON.parse(a.dataForm.data)),{},{id:a.dataForm.id}),a.fillFormData(a.formConf,a.formData))})):(a.visible=!1,a.destroyStyle(),a.btnLoading=!1,a.$emit("refreshDataList",!0))}))}}):a.$message({message:e.msg,type:"success",duration:1500,onClose:function(){t&&"function"===typeof t&&t(),a.$nextTick((function(){if(a.continueBtnLoading=!1,2==i)return a.resetForm(),void a.$nextTick((function(){a.key=+new Date}));a.visible=!1,a.btnLoading=!1,a.$emit("refreshDataList",!0)}))}})})).catch((function(){a.continueBtnLoading=!1,a.btnLoading=!1}))}},dataFormSubmit:function(e){if(this.isPreview)return this.$message({message:"功能预览不支持数据保存",type:"warning"});this.$refs.dynamicForm&&this.$refs.dynamicForm.submitForm(e)},destroyStyle:function(){document.getElementById("styleId")&&document.getElementById("styleId").remove()}}},f=p,m=i("2877"),h=Object(m["a"])(f,a,n,!1,null,null,null);t["default"]=h.exports},c5c7:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e._self._c;return t("div",[e.dialogLoading?[t("el-dialog",{staticClass:"JNPF-dialog JNPF-dialog_center",attrs:{title:e.dataForm.id?"编辑":"新建","close-on-click-modal":!1,visible:e.visible,"lock-scroll":"",width:"600px"},on:{"update:visible":function(t){e.visible=t},close:function(t){return e.goBack()}}},[e.loading?e._e():t("parser",{key:e.key,ref:"dynamicForm",attrs:{"form-conf":e.formConf},on:{submit:e.submitForm}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.goBack}},[e._v(e._s(e.formConf.cancelButtonText||"取 消"))]),t("el-button",{attrs:{type:"primary",loading:e.btnLoading},on:{click:function(t){return e.dataFormSubmit()}}},[e._v(" "+e._s(e.formConf.confirmButtonText||"确 定"))])],1)],1)]:e._e()],2)},n=[],o=i("5530"),l=(i("4de4"),i("d3b7"),i("d81d"),i("caad"),i("e9c4"),i("ef22")),r=i("49aa"),s=i("ed08"),c=i("5880"),d={components:{Parser:r["default"]},data:function(){return{visible:!1,key:+new Date,formConf:{},dataForm:{id:"",data:""},modelId:"",formData:{},btnLoading:!1,loading:!0,isPreview:!1,useFormPermission:!1,formOperates:[],dialogLoading:!1}},computed:Object(o["a"])({},Object(c["mapGetters"])(["userInfo"])),methods:{goBack:function(){this.visible=!1},init:function(e,t,i,a,n){var o=this;this.formConf=Object(s["b"])(e),this.modelId=t,this.isPreview=i,this.useFormPermission=a,this.getFormOperates(),this.loading=!0,this.dialogLoading=!1,this.$nextTick((function(){o.$store.commit("generator/SET_DYNAMIC_MODEL_EXTRA",{}),o.formData={},n&&(o.formData=n,o.dataForm.id=n.id||"",o.showMoreBtn=!1),o.fillFormData(o.formConf,o.formData),o.dialogLoading=!0,o.$nextTick((function(){o.visible=!0,o.loading=!1})),o.key=+new Date}))},getFormOperates:function(){if(!this.isPreview&&this.useFormPermission){var e=this.$store.getters.permissionList,t=this.$route.meta.modelId,i=e.filter((function(e){return e.modelId===t}));this.formOperates=i[0]&&i[0].form?i[0].form:[]}},fillFormData:function(e,t){var i=this,a=function e(a,n){for(var o=0;o<a.length;o++){var l=a[o];if(l.__vModel__){if(l.__config__.defaultCurrent){if("datePicker"===l.__config__.jnpfKey){var r=l.format,s=i.jnpf.toDate((new Date).getTime(),r),c="yyyy"===r?"-01-01 00:00:00":"yyyy-MM"===r?"-01 00:00:00":"yyyy-MM-dd"===r?" 00:00:00":"";l.__config__.defaultValue=new Date(s+c).getTime()}"timePicker"===l.__config__.jnpfKey&&(l.__config__.defaultValue=i.jnpf.toDate(new Date,l.format)),"organizeSelect"===l.__config__.jnpfKey&&i.userInfo.organizeIdList instanceof Array&&i.userInfo.organizeIdList.length>0&&(l.__config__.defaultValue=1==l.multiple?[i.userInfo.organizeIdList]:i.userInfo.organizeIdList),"depSelect"===l.__config__.jnpfKey&&i.userInfo.departmentId&&(l.__config__.defaultValue=l.multiple?[i.userInfo.departmentId]:i.userInfo.departmentId),"posSelect"===l.__config__.jnpfKey&&i.userInfo.positionIds instanceof Array&&i.userInfo.positionIds.length>0&&(l.__config__.defaultValue=l.multiple?i.userInfo.positionIds.map((function(e){return e.id})):i.userInfo.positionIds[0].id),"roleSelect"===l.__config__.jnpfKey&&i.userInfo.roleIds instanceof Array&&i.userInfo.roleIds.length>0&&(l.__config__.defaultValue=l.multiple?i.userInfo.roleIds:i.userInfo.roleIds[0]),"groupSelect"===l.__config__.jnpfKey&&i.userInfo.groupIds instanceof Array&&i.userInfo.groupIds.length>0&&(l.__config__.defaultValue=l.multiple?i.userInfo.groupIds:i.userInfo.groupIds[0]),["userSelect"].includes(l.__config__.jnpfKey)&&i.userInfo.userId&&(l.__config__.defaultValue=l.multiple?[i.userInfo.userId]:i.userInfo.userId),"usersSelect"===l.__config__.jnpfKey&&i.userInfo.userId&&(l.__config__.defaultValue=l.multiple?[i.userInfo.userId+"--user"]:i.userInfo.userId+"--user")}var d=t.hasOwnProperty(l.__vModel__)?t[l.__vModel__]:l.__config__.defaultValue;l.__config__.isSubTable||(l.__config__.defaultValue=d),!i.isPreview&&i.useFormPermission&&function(){var e=l.__config__.isSubTable?n.__vModel__+"-"+l.__vModel__:l.__vModel__,t=!0;i.formOperates&&i.formOperates.length&&(t=!i.formOperates.some((function(t){return t.enCode===e}))),t=l.__config__.noShow?l.__config__.noShow:t,i.$set(l.__config__,"noShow",t)}()}l.__config__&&l.__config__.children&&Array.isArray(l.__config__.children)&&e(l.__config__.children,l)}};a(e.fields),e.formData=t},resetForm:function(){var e=this;this.$nextTick((function(){e.$refs.dynamicForm&&e.$refs.dynamicForm.resetForm()}))},submitForm:function(e,t,i){var a=this;if(e){this.btnLoading=!0;var n=Object(o["a"])(Object(o["a"])({},this.formData),e);this.dataForm.data=JSON.stringify(n);var r=this.dataForm.id?l["y"]:l["i"];r(this.modelId,this.dataForm).then((function(e){a.$message({message:e.msg,type:"success",duration:1500,onClose:function(){t&&"function"===typeof t&&t(),a.$nextTick((function(){a.visible=!1,a.btnLoading=!1,a.$emit("refreshDataList",!0)}))}})})).catch((function(){a.btnLoading=!1}))}},dataFormSubmit:function(e){if(this.isPreview)return this.$message({message:"功能预览不支持数据保存",type:"warning"});this.$refs.dynamicForm&&this.$refs.dynamicForm.submitForm(e)}}},u=d,p=i("2877"),f=Object(p["a"])(u,a,n,!1,null,null,null);t["default"]=f.exports},fb14:function(e,t,i){"use strict";i("113a")}}]);
//# sourceMappingURL=index.umd.min.0.js.map