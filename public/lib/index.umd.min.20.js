(("undefined"!==typeof self?self:this)["webpackJsonpavueData"]=("undefined"!==typeof self?self:this)["webpackJsonpavueData"]||[]).push([[20],{"0240":function(t,e,a){},"231c":function(t,e,a){"use strict";a("0240")},"3f2c":function(t,e,a){"use strict";a.r(e);var i,n,s=a("2877"),r={},o=Object(s["a"])(r,i,n,!1,null,null,null);e["default"]=o.exports},"421d":function(t,e,a){"use strict";a("ff46")},9406:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"dashboard-container"},[t.noData?[e("el-scrollbar",{staticClass:"dashboard-container"},[e("adminDashboard")],1)]:[t.ajaxing?t._e():[t.portalId?[0===t.type?e("PortalLayout",{attrs:{layout:t.layout,enabledLock:t.enabledLock},on:{layoutUpdatedEvent:t.layoutUpdatedEvent}}):t._e(),1===t.type?e("div",{staticClass:"custom-page"},[0===t.linkType?e(t.currentView,{tag:"component"}):t._e(),1===t.linkType?e("embed",{attrs:{src:t.url,width:"100%",height:"100%",type:"text/html"}}):t._e()],1):t._e()]:e("div",{staticClass:"portal-layout-nodata"},[e("img",{staticClass:"layout-nodata-img",attrs:{src:a("c13c"),alt:""}}),e("p",{staticClass:"layout-nodata-txt"},[t._v("暂无数据")])])],e("Setting",{ref:"Setting",on:{refresh:t.refresh}}),e("el-button",{staticClass:"setting-btn",attrs:{type:"primary",icon:"el-icon-arrow-left",size:"large"},on:{click:function(e){return t.$refs.Setting.init(t.portalId)}}})]],2)},n=[],s=(a("4de4"),a("d3b7"),a("cd3a")),r=a("3f2c"),o=a("c970"),l={components:{Setting:s["default"],adminDashboard:r["default"]},mixins:[o["default"]],created:function(){var t=this.userInfo.systemIds.filter((function(t){return t.currentSystem}))[0];this.systemId=t.id,this.portalId=this.userInfo.portalId,this.getData()},methods:{refresh:function(t){t&&(this.portalId=t,this.clearAutoRefresh(),this.getData())}}},c=l,d=(a("421d"),a("2877")),u=Object(d["a"])(c,i,n,!1,null,"2a49dd26",null);e["default"]=u.exports},c970:function(t,e,a){"use strict";a.r(e);var i=a("5530"),n=(a("e9c4"),a("caad"),a("2532"),a("a434"),a("d3b7"),a("159b"),a("14d9"),a("c797")),s=a("1641"),r=a("17de"),o=a("5880");e["default"]={components:{PortalLayout:n["default"]},data:function(){return{portalId:"",layout:[],type:null,linkType:null,currentView:null,url:"",ajaxing:!0,loading:!1,noData:!1,refreshData:{},timerList:[],formData:{},enabledLock:1,systemId:""}},computed:Object(i["a"])({},Object(o["mapGetters"])(["userInfo"])),destroyed:function(){this.clearAutoRefresh()},methods:{getData:function(){var t=this;if(this.loading=!0,this.layout=[],this.noData=!1,!this.portalId)return this.loading=!1,this.ajaxing=!1,void(this.noData=!0);Object(s["getAuthPortal"])(this.portalId,{platform:"Web",systemId:this.systemId}).then((function(e){200!=e.code&&t.$message({message:e.msg,type:"error",duration:1500,onClose:function(){t.loading=!1,t.ajaxing=!1,t.noData=!0}}),e.data&&(t.type=e.data.type||0,t.linkType=e.data.linkType||0,t.url=e.data.customUrl||"",t.enabledLock=e.data.enabledLock||0,1===e.data.type?e.data.customUrl&&1!==e.data.customUrl&&(t.currentView=function(t){return Promise.all([a.e(5),a.e(3),a.e(0),a.e(2),a.e(17)]).then(function(){var i=[a("4b3b")("./".concat(e.data.customUrl))];t.apply(null,i)}.bind(this)).catch(a.oe)}):e.data.formData&&(t.formData=JSON.parse(e.data.formData),t.layout=t.filterList(JSON.parse(JSON.stringify(t.formData.layout))||[]),t.refreshData=t.formData.refresh||{})),t.ajaxing=!1,setTimeout((function(){t.initAutoRefresh(),t.loading=!1}),500)})).catch((function(){t.loading=!1,t.ajaxing=!1,t.noData=!0}))},filterList:function(t){var e=function t(e){for(var a=0;a<e.length;a++){var i=e[a];Array.isArray(i.visibility)&&i.visibility.includes("pc")||!i.jnpfKey||(e.splice(a,1),a--),i.children&&i.children.length&&t(i.children)}};return e(t),t},initAutoRefresh:function(){var t=this;if(this.layout.length){this.timerList=[];var e=function e(a){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;a.forEach((function(a){if(a.refresh&&a.refresh.autoRefresh&&a.refresh.autoRefreshTime||2==i){var n=setInterval((function(){a.renderKey=+new Date,t.autoRefresh(a)}),2==i?1e3*t.refreshData.autoRefreshTime*60:1e3*a.refresh.autoRefreshTime*60);t.timerList.push(n)}a.children&&a.children.length&&e(a.children,i)}))};this.refreshData.autoRefresh?e(this.layout,2):e(this.layout)}},autoRefresh:function(t){var e=["barChart","lineChart","pieChart","radarChart","mapChart"];if("dynamic"===t.dataType&&e.includes(t.jnpfKey)){if(!t.propsApi)return;Object(r["i"])(t.propsApi).then((function(e){var a=e.data;Array.isArray(a)?t.option.defaultValue=a:t.option.defaultValue=[]}))}},clearAutoRefresh:function(){this.timerList.length&&this.timerList.forEach((function(t){t&&clearInterval(t)}))},layoutUpdatedEvent:function(){this.formData.layout=this.layout;var t={formData:JSON.stringify(this.formData),systemId:this.systemId};Object(s["UpdateCustomPortal"])(this.portalId,t).then((function(t){}))}}}},cd3a:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("el-drawer",{staticClass:"JNPF-common-drawer board",attrs:{title:"切换门户",visible:t.drawer,direction:"rtl",size:"260px"},on:{"update:visible":function(e){t.drawer=e}}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"main",attrs:{"element-loading-text":t.loadingText}},[t.list.length?e("div",t._l(t.list,(function(a,i){return e("div",{key:i,staticClass:"item"},[e("p",{staticClass:"item-title"},[t._v(t._s(a.fullName))]),e("div",{staticClass:"item-list"},t._l(a.children,(function(a,i){return e("div",{key:i,staticClass:"item-list-item",class:{active:t.activeId===a.id},on:{click:function(e){return t.selectItem(a.id)}}},[e("p",{staticClass:"com-hover"},[t._v(t._s(a.fullName))]),e("i",{staticClass:"el-icon-success"})])})),0)])})),0):e("p",{staticClass:"noData-txt"},[t._v(t._s(t.$t("common.noData")))])])])},n=[],s=a("1641"),r={name:"Setting",data:function(){return{drawer:!1,list:[],loading:!0,loadingText:"数据加载中",activeId:""}},methods:{init:function(t){this.drawer=!0,this.activeId=t,this.getList()},getList:function(){var t=this;this.loading=!0,this.loadingText="数据加载中",Object(s["getPortalSelector"])(1).then((function(e){t.list=e.data.list,t.loading=!1})).catch((function(){t.loading=!1}))},selectItem:function(t){var e=this;this.activeId!=t&&(this.loading=!0,this.loadingText="切换门户中",Object(s["SetDefault"])(t).then((function(a){e.activeId=t,e.$emit("refresh",t),e.loading=!1,e.$store.commit("user/SET_USERINFO_PORTALID",t),e.$message({message:a.msg,type:"success",duration:1e3})})).catch((function(){e.loading=!1})))}}},o=r,l=(a("231c"),a("2877")),c=Object(l["a"])(o,i,n,!1,null,"49056488",null);e["default"]=c.exports},ff46:function(t,e,a){}}]);
//# sourceMappingURL=index.umd.min.20.js.map