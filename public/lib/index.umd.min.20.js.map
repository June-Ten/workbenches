{"version":3,"sources":["webpack://avueData/./src/views/dashboard/Setting.vue?2003","webpack://avueData/./src/views/dashboard/admin/index.vue","webpack://avueData/./src/views/dashboard/index.vue?3c15","webpack://avueData/./src/views/dashboard/index.vue","webpack://avueData/src/views/dashboard/index.vue","webpack://avueData/./src/views/dashboard/index.vue?fa9f","webpack://avueData/./src/views/dashboard/index.vue?37a7","webpack://avueData/./src/views/dashboard/mixin.js","webpack://avueData/./src/views/dashboard/Setting.vue","webpack://avueData/src/views/dashboard/Setting.vue","webpack://avueData/./src/views/dashboard/Setting.vue?1bb3","webpack://avueData/./src/views/dashboard/Setting.vue?f918"],"names":["render","staticRenderFns","script","component","_vm","this","_c","_self","directives","name","rawName","value","loading","expression","staticClass","noData","ajaxing","_e","portalId","type","attrs","layout","enabledLock","on","layoutUpdatedEvent","linkType","currentView","tag","url","require","_v","ref","refresh","$event","$refs","Setting","init","components","adminDashboard","mixins","created","methods","id","PortalLayout","data","refreshData","timerList","formData","systemId","computed","mapGetters","destroyed","clearAutoRefresh","getData","getAuthPortal","platform","then","res","code","$message","message","msg","duration","onClose","customUrl","resolve","JSON","parse","filterList","stringify","setTimeout","initAutoRefresh","catch","loop","list","i","length","item","Array","isArray","visibility","includes","jnpfKey","splice","children","forEach","ele","autoRefresh","autoRefreshTime","timer","setInterval","renderKey","Date","push","chartList","dataType","propsApi","getDataInterfaceRes","realData","option","defaultValue","clearInterval","query","UpdateCustomPortal","drawer","loadingText","_l","key","_s","fullName","child","ii","class","activeId","selectItem","$t","getList","getPortalSelector","SetDefault"],"mappings":"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","file":"index.umd.min.20.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Setting.vue?vue&type=style&index=0&id=49056488&prod&lang=scss&scoped=true&\"","var render, staticRenderFns\nvar script = {}\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=2a49dd26&prod&lang=scss&scoped=true&\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],staticClass:\"dashboard-container\"},[(!_vm.noData)?[(!_vm.ajaxing)?[(_vm.portalId)?[(_vm.type===0)?_c('PortalLayout',{attrs:{\"layout\":_vm.layout,\"enabledLock\":_vm.enabledLock},on:{\"layoutUpdatedEvent\":_vm.layoutUpdatedEvent}}):_vm._e(),(_vm.type===1)?_c('div',{staticClass:\"custom-page\"},[(_vm.linkType===0)?_c(_vm.currentView,{tag:\"component\"}):_vm._e(),(_vm.linkType===1)?_c('embed',{attrs:{\"src\":_vm.url,\"width\":\"100%\",\"height\":\"100%\",\"type\":\"text/html\"}}):_vm._e()],1):_vm._e()]:_c('div',{staticClass:\"portal-layout-nodata\"},[_c('img',{staticClass:\"layout-nodata-img\",attrs:{\"src\":require(\"@/assets/images/dashboard-nodata.png\"),\"alt\":\"\"}}),_c('p',{staticClass:\"layout-nodata-txt\"},[_vm._v(\"暂无数据\")])])]:_vm._e(),_c('Setting',{ref:\"Setting\",on:{\"refresh\":_vm.refresh}}),_c('el-button',{staticClass:\"setting-btn\",attrs:{\"type\":\"primary\",\"icon\":\"el-icon-arrow-left\",\"size\":\"large\"},on:{\"click\":function($event){return _vm.$refs.Setting.init(_vm.portalId)}}})]:[_c('el-scrollbar',{staticClass:\"dashboard-container\"},[_c('adminDashboard')],1)]],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"dashboard-container\" v-loading=\"loading\">\r\n    <template v-if=\"!noData\">\r\n      <template v-if=\"!ajaxing\">\r\n        <template v-if=\"portalId\">\r\n          <PortalLayout :layout=\"layout\" :enabledLock=\"enabledLock\" v-if=\"type===0\"\r\n            @layoutUpdatedEvent=\"layoutUpdatedEvent\" />\r\n          <div class=\"custom-page\" v-if=\"type===1\">\r\n            <component :is=\"currentView\" v-if=\"linkType===0\" />\r\n            <embed :src=\"url\" width=\"100%\" height=\"100%\" type=\"text/html\" v-if=\"linkType===1\" />\r\n          </div>\r\n        </template>\r\n        <div class=\"portal-layout-nodata\" v-else>\r\n          <img src=\"@/assets/images/dashboard-nodata.png\" alt=\"\" class=\"layout-nodata-img\">\r\n          <p class=\"layout-nodata-txt\">暂无数据</p>\r\n        </div>\r\n      </template>\r\n      <Setting ref=\"Setting\" @refresh=\"refresh\" />\r\n      <el-button type=\"primary\" icon=\"el-icon-arrow-left\" size=\"large\" class=\"setting-btn\"\r\n        @click=\"$refs.Setting.init(portalId)\"></el-button>\r\n    </template>\r\n    <template v-else>\r\n      <el-scrollbar class=\"dashboard-container\">\r\n        <adminDashboard />\r\n      </el-scrollbar>\r\n    </template>\r\n  </div>\r\n</template>\r\n<script>\r\nimport Setting from './Setting'\r\nimport adminDashboard from './admin'\r\nimport mixin from './mixin';\r\nexport default {\r\n  components: { Setting, adminDashboard },\r\n  mixins: [mixin],\r\n  created() {\r\n    const system = this.userInfo.systemIds.filter(o => o.currentSystem)[0]\r\n    this.systemId = system.id\r\n    this.portalId = this.userInfo.portalId\r\n    this.getData()\r\n  },\r\n  methods: {\r\n    refresh(id) {\r\n      if (!id) return\r\n      this.portalId = id\r\n      this.clearAutoRefresh()\r\n      this.getData()\r\n    },\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.dashboard-container {\r\n  width: 100%;\r\n  height: 100%;\r\n  background: #ebeef5;\r\n  position: relative;\r\n  .custom-page {\r\n    width: 100%;\r\n    height: 100%;\r\n  }\r\n  ::v-deep  .layout-area {\r\n    width: 100%;\r\n    border-radius: 4px;\r\n    overflow: hidden;\r\n  }\r\n  .setting-btn {\r\n    position: absolute;\r\n    top: 200px;\r\n    right: -10px;\r\n    height: 40px;\r\n    width: 40px;\r\n    text-align: center;\r\n    padding: 0;\r\n    border-radius: 20px 0 0 20px;\r\n    z-index: 100;\r\n    ::v-deep  i {\r\n      font-size: 20px;\r\n      font-weight: 580;\r\n    }\r\n  }\r\n  ::v-deep  .vue-grid-layout {\r\n    margin: -10px;\r\n  }\r\n  ::v-deep  .el-scrollbar__view {\r\n    overflow: hidden;\r\n  }\r\n}\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=2a49dd26&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=2a49dd26&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2a49dd26\",\n  null\n  \n)\n\nexport default component.exports","import PortalLayout from '@/components/VisualPortal/Layout'\r\nimport { getAuthPortal, UpdateCustomPortal } from '@/api/onlineDev/portal'\r\nimport { getDataInterfaceRes } from '@/api/systemData/dataInterface'\r\nimport { mapGetters } from 'vuex'\r\n\r\nexport default {\r\n  components: { PortalLayout },\r\n  data() {\r\n    return {\r\n      portalId: '',\r\n      layout: [],\r\n      type: null,\r\n      linkType: null,\r\n      currentView: null,\r\n      url: '',\r\n      ajaxing: true,\r\n      loading: false,\r\n      noData: false,\r\n      refreshData: {},\r\n      timerList: [],\r\n      formData: {},\r\n      enabledLock: 1,\r\n      systemId: ''\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters(['userInfo'])\r\n  },\r\n  destroyed() {\r\n    this.clearAutoRefresh()\r\n  },\r\n  methods: {\r\n    getData() {\r\n      this.loading = true\r\n      this.layout = []\r\n      this.noData = false\r\n      if (!this.portalId) {\r\n        this.loading = false\r\n        this.ajaxing = false\r\n        this.noData = true\r\n        return\r\n      }\r\n      getAuthPortal(this.portalId, { platform: 'Web', systemId: this.systemId }).then(res => {\r\n        if (res.code != 200) {\r\n          this.$message({\r\n            message: res.msg,\r\n            type: 'error',\r\n            duration: 1500,\r\n            onClose: () => {\r\n              this.loading = false\r\n              this.ajaxing = false\r\n              this.noData = true\r\n              return\r\n            }\r\n          })\r\n        }\r\n        if (res.data) {\r\n          this.type = res.data.type || 0\r\n          this.linkType = res.data.linkType || 0\r\n          this.url = res.data.customUrl || ''\r\n          this.enabledLock = res.data.enabledLock || 0\r\n          if (res.data.type === 1) {\r\n            if (res.data.customUrl && res.data.customUrl !== 1) {\r\n              this.currentView = (resolve) => require([`@/views/${res.data.customUrl}`], resolve)\r\n            }\r\n          } else {\r\n            if (res.data.formData) {\r\n              this.formData = JSON.parse(res.data.formData)\r\n              this.layout = this.filterList(JSON.parse(JSON.stringify(this.formData.layout)) || [])\r\n              this.refreshData = this.formData.refresh || {}\r\n            }\r\n          }\r\n        }\r\n        this.ajaxing = false\r\n        setTimeout(() => {\r\n          this.initAutoRefresh()\r\n          this.loading = false\r\n        }, 500);\r\n      }).catch(() => {\r\n        this.loading = false\r\n        this.ajaxing = false\r\n        this.noData = true\r\n      })\r\n    },\r\n    filterList(layout) {\r\n      const loop = list => {\r\n        for (let i = 0; i < list.length; i++) {\r\n          const item = list[i];\r\n          if (!(Array.isArray(item.visibility) && item.visibility.includes('pc')) && item.jnpfKey) {\r\n            list.splice(i, 1)\r\n            i--\r\n          }\r\n          if (item.children && item.children.length) loop(item.children)\r\n        }\r\n      }\r\n      loop(layout)\r\n      return layout\r\n    },\r\n    initAutoRefresh() {\r\n      if (!this.layout.length) return\r\n      this.timerList = []\r\n      const loop = (list, type = 1) => {\r\n        list.forEach(ele => {\r\n          if ((ele.refresh && ele.refresh.autoRefresh && ele.refresh.autoRefreshTime) || type == 2) {\r\n            var timer = setInterval(() => {\r\n              ele.renderKey = +new Date()\r\n              this.autoRefresh(ele)\r\n            }, type == 2 ? this.refreshData.autoRefreshTime * 1000 * 60 : ele.refresh.autoRefreshTime * 1000 * 60);\r\n            this.timerList.push(timer)\r\n          }\r\n          if (ele.children && ele.children.length) loop(ele.children, type)\r\n        });\r\n      }\r\n      if (this.refreshData.autoRefresh) {\r\n        loop(this.layout, 2)\r\n      } else {\r\n        loop(this.layout)\r\n      }\r\n    },\r\n    autoRefresh(item) {\r\n      const chartList = ['barChart', 'lineChart', 'pieChart', 'radarChart', 'mapChart']\r\n      if (item.dataType === 'dynamic' && chartList.includes(item.jnpfKey)) {\r\n        if (!item.propsApi) return\r\n        getDataInterfaceRes(item.propsApi).then(res => {\r\n          const realData = res.data\r\n          if (Array.isArray(realData)) {\r\n            item.option.defaultValue = realData\r\n          } else {\r\n            item.option.defaultValue = []\r\n          }\r\n        })\r\n      }\r\n    },\r\n    clearAutoRefresh() {\r\n      if (this.timerList.length) {\r\n        this.timerList.forEach((ele) => {\r\n          if (ele) clearInterval(ele)\r\n        })\r\n      }\r\n    },\r\n    layoutUpdatedEvent() {\r\n      this.formData.layout = this.layout\r\n      const query = { formData: JSON.stringify(this.formData), systemId: this.systemId }\r\n      UpdateCustomPortal(this.portalId, query).then(res => { })\r\n    }\r\n  }\r\n}","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('el-drawer',{staticClass:\"JNPF-common-drawer board\",attrs:{\"title\":\"切换门户\",\"visible\":_vm.drawer,\"direction\":\"rtl\",\"size\":\"260px\"},on:{\"update:visible\":function($event){_vm.drawer=$event}}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],staticClass:\"main\",attrs:{\"element-loading-text\":_vm.loadingText}},[(_vm.list.length)?_c('div',_vm._l((_vm.list),function(item,i){return _c('div',{key:i,staticClass:\"item\"},[_c('p',{staticClass:\"item-title\"},[_vm._v(_vm._s(item.fullName))]),_c('div',{staticClass:\"item-list\"},_vm._l((item.children),function(child,ii){return _c('div',{key:ii,staticClass:\"item-list-item\",class:{'active':_vm.activeId === child.id},on:{\"click\":function($event){return _vm.selectItem(child.id)}}},[_c('p',{staticClass:\"com-hover\"},[_vm._v(_vm._s(child.fullName))]),_c('i',{staticClass:\"el-icon-success\"})])}),0)])}),0):_c('p',{staticClass:\"noData-txt\"},[_vm._v(_vm._s(_vm.$t('common.noData')))])])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <el-drawer title=\"切换门户\" :visible.sync=\"drawer\" direction=\"rtl\" size=\"260px\"\r\n    class=\"JNPF-common-drawer board\">\r\n    <div class=\"main\" v-loading=\"loading\" :element-loading-text=\"loadingText\">\r\n      <div v-if=\"list.length\">\r\n        <div class=\"item\" v-for=\"(item,i) in list\" :key=\"i\">\r\n          <p class=\"item-title\">{{item.fullName}}</p>\r\n          <div class=\"item-list\">\r\n            <div class=\"item-list-item\" v-for=\"(child,ii) in  item.children\" :key=\"ii\"\r\n              @click=\"selectItem(child.id)\" :class=\"{'active':activeId === child.id}\">\r\n              <p class=\"com-hover\">{{child.fullName}}</p>\r\n              <i class=\"el-icon-success\"></i>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <p class=\"noData-txt\" v-else>{{$t('common.noData')}}</p>\r\n    </div>\r\n  </el-drawer>\r\n</template>\r\n\r\n<script>\r\n\r\nimport { getPortalSelector, SetDefault } from '@/api/onlineDev/portal'\r\nexport default {\r\n  name: 'Setting',\r\n  data() {\r\n    return {\r\n      drawer: false,\r\n      list: [],\r\n      loading: true,\r\n      loadingText: '数据加载中',\r\n      activeId: ''\r\n    }\r\n  },\r\n  methods: {\r\n    init(id) {\r\n      this.drawer = true\r\n      this.activeId = id\r\n      this.getList()\r\n    },\r\n    getList() {\r\n      this.loading = true\r\n      this.loadingText = '数据加载中'\r\n      getPortalSelector(1).then(res => {\r\n        this.list = res.data.list\r\n        this.loading = false\r\n      }).catch(() => { this.loading = false })\r\n    },\r\n    selectItem(id) {\r\n      if (this.activeId == id) return\r\n      this.loading = true\r\n      this.loadingText = '切换门户中'\r\n      SetDefault(id).then(res => {\r\n        this.activeId = id\r\n        this.$emit('refresh', id)\r\n        this.loading = false\r\n        this.$store.commit('user/SET_USERINFO_PORTALID', id)\r\n        this.$message({ message: res.msg, type: 'success', duration: 1000 })\r\n      }).catch(() => { this.loading = false })\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.board {\r\n  ::v-deep  .el-drawer__body {\r\n    overflow: hidden;\r\n  }\r\n  ::v-deep  .main {\r\n    padding: 10px 20px;\r\n    height: 100%;\r\n    overflow: auto;\r\n    overflow-x: hidden;\r\n    .item {\r\n      .item-title {\r\n        font-size: 12px;\r\n        line-height: 30px;\r\n        color: #999;\r\n      }\r\n      .item-list {\r\n        font-size: 14px;\r\n        color: #707070;\r\n        .item-list-item {\r\n          display: flex;\r\n          justify-content: space-between;\r\n          align-items: center;\r\n          height: 45px;\r\n          cursor: pointer;\r\n          i {\r\n            font-size: 20px;\r\n            color: #bdbdbd;\r\n          }\r\n          &.active i {\r\n            color: #1890ff;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    .noData-txt {\r\n      font-size: 14px;\r\n      color: #909399;\r\n      line-height: 20px;\r\n      text-align: center;\r\n      padding-top: 10px;\r\n    }\r\n  }\r\n}\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Setting.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Setting.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Setting.vue?vue&type=template&id=49056488&scoped=true&\"\nimport script from \"./Setting.vue?vue&type=script&lang=js&\"\nexport * from \"./Setting.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Setting.vue?vue&type=style&index=0&id=49056488&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"49056488\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}