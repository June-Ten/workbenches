{"version":3,"sources":["webpack://avueData/./node_modules/vue-esign/src/index.vue","webpack://avueData/node_modules/vue-esign/src/index.vue","webpack://avueData/./node_modules/vue-esign/src/index.vue?1a52","webpack://avueData/./node_modules/vue-esign/src/index.vue?e7be","webpack://avueData/./node_modules/vue-esign/src/index.js","webpack://avueData/./src/components/Process/FlowCard/util.js","webpack://avueData/src/components/Process/FlowCard/Preview.vue","webpack://avueData/./src/components/Process/FlowCard/Preview.vue","webpack://avueData/./src/components/Process/FlowCard/Preview.vue?c210","webpack://avueData/src/components/Process/FlowCard/PreviewT.vue","webpack://avueData/./src/components/Process/FlowCard/PreviewT.vue","webpack://avueData/./src/components/Process/FlowCard/PreviewT.vue?a321","webpack://avueData/./src/api/workFlow/FlowEngine.js","webpack://avueData/./src/components/Process/PreviewTransform.vue?8c35","webpack://avueData/./src/components/SignImgDialog/index.vue?26ca","webpack://avueData/./src/components/Process/PreviewTransform.vue","webpack://avueData/src/components/Process/PreviewTransform.vue","webpack://avueData/./src/components/Process/PreviewTransform.vue?d79a","webpack://avueData/./src/components/Process/Preview.vue?5772","webpack://avueData/./node_modules/vue-esign/src/index.vue?3b37","webpack://avueData/./src/components/Process/Preview.vue","webpack://avueData/src/components/Process/Preview.vue","webpack://avueData/./src/components/Process/Preview.vue?7cbe","webpack://avueData/./src/components/SignImgDialog/index.vue","webpack://avueData/src/components/SignImgDialog/index.vue","webpack://avueData/./src/components/SignImgDialog/index.vue?50fb","webpack://avueData/./src/components/SignImgDialog/index.vue?a083","webpack://avueData/./src/components/Process/FlowCard/config.js","webpack://avueData/./src/components/Process/FlowCard/PreviewT.vue?af5a","webpack://avueData/./src/components/Process/FlowCard/Preview.vue?b459"],"names":["render","_vm","this","_c","_self","ref","on","mouseDown","mouseMove","mouseUp","touchStart","touchMove","touchEnd","staticRenderFns","props","width","type","default","height","lineWidth","lineColor","bgColor","isCrop","isClearBgColor","format","quality","data","hasDrew","resultImg","points","canvasTxt","startX","startY","isDrawing","sratio","computed","ratio","stageInfo","myBg","watch","beforeMount","window","beforeDestroy","mounted","canvas","document","methods","$_resizeHandler","e","x","y","drawStart","obj","drawMove","drawEnd","generate","options","crop_canvas","crop_ctx","resolve","reject","reset","getCropArea","imgData","btnY","btmX","topY","topX","component","install","Vue","installed","isEmptyArray","Array","isArray","length","NodeUtils","quotient","Date","Math","ceil","random","chars","charArr","split","radix","res","mod","push","join","node","isInterflow","isBranchFlow","previousNodeId","JSON","parse","stringify","nodeConfig","nodeId","idGenerator","properties","title","prevId","processData","childNode","r1","getPreviousNode","conditionNodes","c","r2","nodeData","checkEmpty","prevNode","isConditionNode","isInterflowNode","isBranchFlowNode","willDelBranch","target","deleteNode","concatChild","prev","delNode","forEach","cons","index","findIndex","splice","anotherCon","conditionType","endNode","i","priority","isBranchAction","newChildNode","undefined","oldChildNode","createNode","map","emptyNode","addApprovalNode","conditions","defaultNodeIndex","isDefault","setDefaultCondition","isBottomBtnOfBranch","addEmptyNode","n","cnode","oldPriority","newPriority","branchData","lastNode","DEFAULT_TEXT","hasCondition","initiator","clearDefault","content","setDefault","count","slice","parent","valid","isStartNode","formId","isSubFlowNode","flowId","initiateType","initiatePos","initiateRole","initiateOrg","initiateGroup","isApproverNode","assigneeType","approvers","approverPos","approverRole","approverOrg","approverGroup","loop","callback","checkNode","getMockData","startNode","createNormalCard","ctx","conf","h","classList","arg","start","approver","copy","timer","subFlow","interflow","branchFlow","empty","condition","addNodeButton","NodeFactory","branchNode","selfNode","showErrorTip","nodes","addEndNode","required","verifyMode","eventLauncher","event","args","FlowEngineList","request","url","method","FlowEngineInfo","id","Delete","Create","Update","Copy","exportData","Release","Stop","getFlowIdByCode","enCode","FlowEngineListAll","FlowEnginePageList","FlowEnginePageChildList","getFlowFormInfo","getCommentList","createComment","delComment","flowJsonList","mainVersion","delVersion","FlowEngineAll","FlowEngineListByIds","getFlowList","name","scaleVal","step","updateId","activeData","isProcessCmp","getData","formData","eventReceiver","forceUpdate","changeScale","val","onPropEditConfirm","value","oldProp","onClosePanel","isFilledPCon","formIds","uesd","loopChild","transform","staticClass","attrs","signVisible","$event","directives","rawName","showTip","expression","_v","slot","handleReset","loading","handleGenerate","components","vueEsign","userInfo","signImg","init","createSign","message","duration","catch","defaultStartForm","errorRule","errorRuleUser","funcConfigRule","timeLimitConfig","nodeLimit","duringDeal","formField","overTimeConfig","firstOver","overTimeDuring","overNotice","overAutoApprove","overAutoApproveTime","overEvent","overEventTime","noticeConfig","overTimeFuncConfig","interfaceId","interfaceName","templateJson","noticeFuncConfig","initFuncConfig","endFuncConfig","flowRecallFuncConfig","waitMsgConfig","msgId","msgName","endMsgConfig","approveMsgConfig","rejectMsgConfig","copyMsgConfig","overTimeMsgConfig","noticeMsgConfig","hasSubmitBtn","submitBtnText","hasSaveBtn","saveBtnText","hasPressBtn","pressBtnText","hasRevokeBtn","revokeBtnText","hasPrintBtn","printBtnText","printId","isComment","isBatchApproval","isSummary","summaryType","titleType","defaultContent","titleContent","formOperates","circulateUser","isCustomCopy","extraCopyRule","hasSign","hasOpinion","formName","formFieldList","members","userOptional","day","hour","minute","second","matchLogic","branch"],"mappings":"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","file":"index.umd.min.6.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('canvas',{ref:\"canvas\",on:{\"mousedown\":_vm.mouseDown,\"mousemove\":_vm.mouseMove,\"mouseup\":_vm.mouseUp,\"touchstart\":_vm.touchStart,\"touchmove\":_vm.touchMove,\"touchend\":_vm.touchEnd}})\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <canvas ref=\"canvas\" @mousedown=\"mouseDown\" @mousemove=\"mouseMove\" @mouseup=\"mouseUp\"\n  @touchstart=\"touchStart\" @touchmove=\"touchMove\" @touchend=\"touchEnd\"></canvas>\n</template>\n\n<script>\nexport default {\n  props: {\n    width: {\n      type: Number,\n      default: 800\n    },\n    height: {\n      type: Number,\n      default: 300\n    },\n    lineWidth: {\n      type: Number,\n      default: 4\n    },\n    lineColor: {\n      type: String,\n      default: '#000000'\n    },\n    bgColor: {\n      type: String,\n      default: ''\n    },\n    isCrop: {\n      type: Boolean,\n      default: false\n    },\n    isClearBgColor: {\n      type: Boolean,\n      default: true\n    },\n    format: {\n      type: String,\n      default: 'image/png'\n    },\n    quality: {\n      type: Number,\n      default: 1\n    }\n  },\n  data () {\n    return {\n      hasDrew: false,\n      resultImg: '',\n      points: [],\n      canvasTxt: null,\n      startX: 0,\n      startY: 0,\n      isDrawing: false,\n      sratio: 1\n    }\n  },\n  computed: {\n    ratio () {\n      return this.height / this.width\n    },\n    stageInfo () {\n      return this.$refs.canvas.getBoundingClientRect()\n    },\n    myBg () {\n      return this.bgColor ? this.bgColor : 'rgba(255, 255, 255, 0)'\n    }\n  },\n  watch: {\n    'myBg': function (newVal) {\n      this.$refs.canvas.style.background = newVal\n    }\n  },\n  beforeMount () {\n    window.addEventListener('resize', this.$_resizeHandler)\n  },\n  beforeDestroy () {\n    window.removeEventListener('resize', this.$_resizeHandler)\n  },\n  mounted () {\n    const canvas = this.$refs.canvas\n    canvas.height = this.height\n    canvas.width = this.width\n    canvas.style.background = this.myBg\n    this.$_resizeHandler()\n    // 在画板以外松开鼠标后冻结画笔\n    document.onmouseup = () => {\n      this.isDrawing = false\n    }\n  },\n  methods: {\n    $_resizeHandler () {\n      const canvas = this.$refs.canvas\n      canvas.style.width = this.width + \"px\"\n      const realw = parseFloat(window.getComputedStyle(canvas).width)\n      canvas.style.height = this.ratio * realw + \"px\";\n      this.canvasTxt = canvas.getContext('2d')\n      this.canvasTxt.scale(1 * this.sratio, 1 * this.sratio)\n      this.sratio = realw / this.width\n      this.canvasTxt.scale(1 / this.sratio, 1 / this.sratio)\n    },\n    // pc\n    mouseDown (e) {\n      e = e || event\n      e.preventDefault()\n      this.isDrawing = true\n      this.hasDrew = true\n      let obj = {\n        x: e.offsetX,\n        y: e.offsetY\n      }\n      this.drawStart(obj)\n    },\n    mouseMove (e) {\n      e = e || event\n      e.preventDefault()\n      if (this.isDrawing) {\n        let obj = {\n          x: e.offsetX,\n          y: e.offsetY\n        }\n        this.drawMove(obj)\n      }\n    },\n    mouseUp (e) {\n      e = e || event\n      e.preventDefault()\n      let obj = {\n        x: e.offsetX,\n        y: e.offsetY\n      }\n      this.drawEnd(obj)\n      this.isDrawing = false\n    },\n    // mobile\n    touchStart (e) {\n      e = e || event\n      e.preventDefault()\n      this.hasDrew = true\n      if (e.touches.length === 1) {\n        let obj = {\n          x: e.targetTouches[0].clientX - this.$refs.canvas.getBoundingClientRect().left,\n          y: e.targetTouches[0].clientY - this.$refs.canvas.getBoundingClientRect().top\n        }\n        this.drawStart(obj)\n      }\n    },\n    touchMove (e) {\n      e = e || event\n      e.preventDefault()\n      if (e.touches.length === 1) {\n        let obj = {\n          x: e.targetTouches[0].clientX - this.$refs.canvas.getBoundingClientRect().left,\n          y: e.targetTouches[0].clientY - this.$refs.canvas.getBoundingClientRect().top\n        }\n        this.drawMove(obj)\n      }\n    },\n    touchEnd (e) {\n      e = e || event\n      e.preventDefault()\n      if (e.touches.length === 1) {\n        let obj = {\n          x: e.targetTouches[0].clientX - this.$refs.canvas.getBoundingClientRect().left,\n          y: e.targetTouches[0].clientY - this.$refs.canvas.getBoundingClientRect().top\n        }\n        this.drawEnd(obj)\n      }\n    },\n    // 绘制\n    drawStart (obj) {\n      this.startX = obj.x\n      this.startY = obj.y\n      this.canvasTxt.beginPath()\n      this.canvasTxt.moveTo(this.startX, this.startY)\n      this.canvasTxt.lineTo(obj.x, obj.y)\n      this.canvasTxt.lineCap = 'round'\n      this.canvasTxt.lineJoin = 'round'\n      this.canvasTxt.lineWidth = this.lineWidth * this.sratio\n      this.canvasTxt.stroke()\n      this.canvasTxt.closePath()\n      this.points.push(obj)\n    },\n    drawMove (obj) {\n      this.canvasTxt.beginPath()\n      this.canvasTxt.moveTo(this.startX, this.startY)\n      this.canvasTxt.lineTo(obj.x, obj.y)\n      this.canvasTxt.strokeStyle = this.lineColor\n      this.canvasTxt.lineWidth = this.lineWidth * this.sratio\n      this.canvasTxt.lineCap = 'round'\n      this.canvasTxt.lineJoin = 'round'\n      this.canvasTxt.stroke()\n      this.canvasTxt.closePath()\n      this.startY = obj.y\n      this.startX = obj.x\n      this.points.push(obj)\n    },\n    drawEnd (obj) {\n      this.canvasTxt.beginPath()\n      this.canvasTxt.moveTo(this.startX, this.startY)\n      this.canvasTxt.lineTo(obj.x, obj.y)\n      this.canvasTxt.lineCap = 'round'\n      this.canvasTxt.lineJoin = 'round'\n      this.canvasTxt.stroke()\n      this.canvasTxt.closePath()\n      this.points.push(obj)\n      this.points.push({x: -1, y: -1})\n    },\n    // 操作\n    generate (options) {\n      let imgFormat = options && options.format ? options.format: this.format\n      let imgQuality = options && options.quality ? options.quality: this.quality\n      const pm =  new Promise((resolve, reject) => {\n        if (!this.hasDrew) {\n          reject(`Warning: Not Signned!`)\n          return\n        }\n        var resImgData = this.canvasTxt.getImageData(0, 0, this.$refs.canvas.width, this.$refs.canvas.height)\n        this.canvasTxt.globalCompositeOperation = \"destination-over\"\n        this.canvasTxt.fillStyle = this.myBg\n        this.canvasTxt.fillRect(0,0,this.$refs.canvas.width ,this.$refs.canvas.height)\n        this.resultImg = this.$refs.canvas.toDataURL(imgFormat, imgQuality)\n        var resultImg = this.resultImg\n        this.canvasTxt.clearRect(0, 0, this.$refs.canvas.width ,this.$refs.canvas.height)\n        this.canvasTxt.putImageData(resImgData, 0, 0)\n        this.canvasTxt.globalCompositeOperation = \"source-over\"\n        if (this.isCrop) {\n          const crop_area = this.getCropArea(resImgData.data)\n          var crop_canvas = document.createElement('canvas')\n          const crop_ctx = crop_canvas.getContext('2d')\n          crop_canvas.width = crop_area[2] - crop_area[0]\n          crop_canvas.height = crop_area[3] - crop_area[1]\n          const crop_imgData = this.canvasTxt.getImageData(...crop_area)\n          crop_ctx.globalCompositeOperation = \"destination-over\"\n          crop_ctx.putImageData(crop_imgData, 0, 0)\n          crop_ctx.fillStyle = this.myBg\n          crop_ctx.fillRect(0, 0, crop_canvas.width , crop_canvas.height)\n          resultImg = crop_canvas.toDataURL(imgFormat, imgQuality)\n          crop_canvas = null\n        }\n        resolve(resultImg)\n      })\n      return pm\n    },\n    reset () {\n      this.canvasTxt.clearRect(\n        0,\n        0,\n        this.$refs.canvas.width,\n        this.$refs.canvas.height\n      )\n      if (this.isClearBgColor) {\n        this.$emit('update:bgColor', '')\n        this.$refs.canvas.style.background = 'rgba(255, 255, 255, 0)'\n      }\n      this.points = []\n      this.hasDrew = false\n      this.resultImg = ''\n    },\n    getCropArea (imgData) {\n      var topX = this.$refs.canvas.width; var btmX = 0; var topY = this.$refs.canvas.height; var btnY = 0\n      for (var i = 0; i < this.$refs.canvas.width; i++) {\n        for (var j = 0; j < this.$refs.canvas.height; j++) {\n          var pos = (i + this.$refs.canvas.width * j) * 4\n          if (imgData[pos] > 0 || imgData[pos + 1] > 0 || imgData[pos + 2] || imgData[pos + 3] > 0) {\n            btnY = Math.max(j, btnY)\n            btmX = Math.max(i, btmX)\n            topY = Math.min(j, topY)\n            topX = Math.min(i, topX)\n          }\n        }\n      }\n      topX++\n      btmX++\n      topY++\n      btnY++\n      const data = [topX, topY, btmX, btnY]\n      return data\n    }\n  }\n}\n</script>\n\n<style scoped>\ncanvas {\n  max-width: 100%;\n  display: block;\n}\n</style>\n","import mod from \"-!../../cache-loader/dist/cjs.js??ref--13-0!../../thread-loader/dist/cjs.js!../../babel-loader/lib/index.js!../../cache-loader/dist/cjs.js??ref--1-0!../../vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../cache-loader/dist/cjs.js??ref--13-0!../../thread-loader/dist/cjs.js!../../babel-loader/lib/index.js!../../cache-loader/dist/cjs.js??ref--1-0!../../vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=a1968bcc&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=a1968bcc&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"a1968bcc\",\n  null\n  \n)\n\nexport default component.exports","import vueEsign from './index.vue'\nvueEsign.install = function (Vue) {\n  if (this.installed) {\n    return\n  }\n  this.installed = true\n  Vue.component('vueEsign', vueEsign)\n}\nexport default vueEsign\n\n// if (typeof window !== 'undefined' && window.Vue) {\n//   window.Vue.use(vueEsign)\n// }","import nodeConfig from \"./config.js\";\r\nconst isEmpty = data => data === null || data === undefined || data === ''\r\nconst isEmptyArray = data => Array.isArray(data) ? data.length === 0 : true\r\n\r\nexport class NodeUtils {\r\n  /**\r\n   * 根据自增数生成64进制id\r\n   * @returns 64进制id字符串\r\n   */\r\n  static idGenerator() {\r\n    let quotient = (new Date() - new Date('2020-08-01'))\r\n    quotient += Math.ceil(Math.random() * 1000) // 防止重複\r\n    const chars = '0123456789ABCDEFGHIGKLMNOPQRSTUVWXYZabcdefghigklmnopqrstuvwxyz';\r\n    const charArr = chars.split(\"\")\r\n    const radix = chars.length;\r\n    const res = []\r\n    do {\r\n      let mod = quotient % radix;\r\n      quotient = (quotient - mod) / radix;\r\n      res.push(charArr[mod])\r\n    } while (quotient);\r\n    return res.join('')\r\n  }\r\n\r\n\r\n  /**\r\n   * 判断节点类型\r\n   * @param {Node} node - 节点数据\r\n   * @returns Boolean\r\n   */\r\n  static isConditionNode(node) {\r\n    return node && node.type === 'condition'\r\n  }\r\n  static isCopyNode(node) {\r\n    return node && node.type === 'copy'\r\n  }\r\n  static isStartNode(node) {\r\n    return node && node.type === 'start'\r\n  }\r\n  static isApproverNode(node) {\r\n    return node && node.type === 'approver'\r\n  }\r\n  static isTimerNode(node) {\r\n    return node && node.type === 'timer'\r\n  }\r\n  static isSubFlowNode(node) {\r\n    return node && node.type === 'subFlow'\r\n  }\r\n  static isInterflowNode(node) {\r\n    return node && node.type === 'approver' && node.isInterflow\r\n  }\r\n  static isBranchFlowNode(node) {\r\n    return node && node.type === 'approver' && node.isBranchFlow\r\n  }\r\n  /**\r\n   * 创建指定节点\r\n   * @param { String } type - 节点类型\r\n   * @param { Object } previousNodeId - 父节点id\r\n   * @returns { Object } 节点数据\r\n   */\r\n  static createNode(type, previousNodeId) {\r\n    let res = JSON.parse(JSON.stringify(nodeConfig[type]))\r\n    res.nodeId = this.idGenerator()\r\n    if (type !== 'start' && type !== 'timer') res.properties.title += res.nodeId\r\n    res.prevId = previousNodeId\r\n    return res\r\n  }\r\n  /**\r\n   * 获取指定节点的父节点（前一个节点）\r\n   * @param { String } prevId - 父节点id\r\n   * @param { Object } processData - 流程图全部数据\r\n   * @returns { Object } 父节点\r\n   */\r\n  static getPreviousNode(prevId, processData) {\r\n    if (processData.nodeId === prevId) return processData\r\n    if (processData.childNode) {\r\n      let r1 = this.getPreviousNode(prevId, processData.childNode)\r\n      if (r1) {\r\n        return r1\r\n      }\r\n    }\r\n    if (processData.conditionNodes) {\r\n      for (let c of processData.conditionNodes) {\r\n        let r2 = this.getPreviousNode(prevId, c)\r\n        if (r2) {\r\n          return r2\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * 删除节点\r\n   * @param { Object  } nodeData - 被删除节点的数据\r\n   * @param { Object  } processData - 流程图的所有节点数据\r\n   */\r\n  static deleteNode(nodeData, processData, checkEmpty = true) {\r\n    let prevNode = this.getPreviousNode(nodeData.prevId, processData)\r\n    if (checkEmpty && prevNode.type === 'empty') {\r\n      if (this.isConditionNode(nodeData) || this.isInterflowNode(nodeData) || this.isBranchFlowNode(nodeData)) {\r\n        const willDelBranch = prevNode.conditionNodes.length === 2\r\n        const target = willDelBranch ? prevNode : nodeData\r\n        this.deleteNode(target, processData, willDelBranch)\r\n      } else {\r\n        if (isEmptyArray(prevNode.conditionNodes)) {\r\n          this.deleteNode(prevNode, processData)\r\n        }\r\n        this.deleteNode(nodeData, processData, false)\r\n      }\r\n      // this.deleteNode( prevNode, processData )\r\n      // !this.isConditionNode(nodeData) && this.deleteNode(nodeData, processData)\r\n      return\r\n    }\r\n    let concatChild = (prev, delNode) => {\r\n      prev.childNode = delNode.childNode\r\n      isEmptyArray(prev.conditionNodes) && (prev.conditionNodes = delNode.conditionNodes)\r\n      prev.childNode && (prev.childNode.prevId = prev.nodeId)\r\n      prev.conditionNodes && prev.conditionNodes.forEach(c => c.prevId = prev.nodeId);\r\n    }\r\n    if (this.isConditionNode(nodeData) || this.isInterflowNode(nodeData) || this.isBranchFlowNode(nodeData)) {\r\n      let cons = prevNode.conditionNodes\r\n      let index = cons.findIndex(c => c.nodeId === nodeData.nodeId)\r\n      if (cons.length > 2) {\r\n        cons.splice(index, 1)\r\n      } else {\r\n        let anotherCon = cons[+(!index)]\r\n        delete prevNode.conditionNodes\r\n        delete prevNode.conditionType\r\n        if (prevNode.childNode) {\r\n          let endNode = anotherCon\r\n          while (endNode.childNode) {\r\n            endNode = endNode.childNode\r\n          }\r\n          endNode.childNode = prevNode.childNode\r\n          endNode.childNode.prevId = endNode.nodeId\r\n        }\r\n        concatChild(prevNode, anotherCon)\r\n        if (prevNode.childNode && prevNode.childNode.type === 'empty') {\r\n          this.deleteNode(prevNode.childNode, prevNode)\r\n        }\r\n      }\r\n      // 重新编排优先级\r\n      cons.forEach((c, i) => c.properties.priority = i)\r\n      return\r\n    }\r\n    concatChild(prevNode, nodeData)\r\n  }\r\n  // TODO:\r\n  // static copyNode ( nodeData, processData ) {\r\n  //   let prevNode = this.getPreviousNode( nodeData.prevId, processData )\r\n  //   let index = prevNode.conditionNodes.findIndex( c => c.nodeId === nodeData.nodeId )\r\n\r\n  // }\r\n  /**\r\n   * 添加审计节点（普通节点 approver）\r\n   * @param { Object } data - 目标节点数据，在该数据节点之后添加审计节点\r\n   * @param { Object } isBranchAction - 目标节点数据，是否是条件分支\r\n   * @param { Object } newChildNode - 传入的新的节点 用户操作均为空  删除操作/添加抄送人 会传入该参数 以模拟添加节点\r\n   */\r\n  static addApprovalNode(data, isBranchAction, newChildNode = undefined) {\r\n    let oldChildNode = data.childNode;\r\n    newChildNode = newChildNode || this.createNode(\"approver\", data.nodeId)\r\n    data.childNode = newChildNode\r\n    if (oldChildNode) {\r\n      newChildNode.childNode = oldChildNode\r\n      oldChildNode.prevId = newChildNode.nodeId\r\n    }\r\n    let conditionNodes = data.conditionNodes\r\n    if (Array.isArray(conditionNodes) && !isBranchAction && conditionNodes.length) {\r\n      newChildNode.conditionNodes = conditionNodes.map(c => {\r\n        c.prevId = newChildNode.nodeId\r\n        return c\r\n      })\r\n      delete data.conditionNodes\r\n    }\r\n    if (oldChildNode && oldChildNode.type === 'empty' && newChildNode.type !== 'empty' && oldChildNode.conditionNodes.length === 0) {\r\n      this.deleteNode(oldChildNode, data)\r\n    }\r\n  }\r\n  /**\r\n   * 添加空节点\r\n   * @param { Object } data - 空节点的父级节点\r\n   * @return { Object } emptyNode - 空节点数据\r\n   */\r\n  static addEmptyNode(data) {\r\n    let emptyNode = this.createNode('empty', data.nodeId)\r\n    this.addApprovalNode(data, true, emptyNode)\r\n    return emptyNode\r\n  }\r\n\r\n  static addCopyNode(data, isBranchAction) {\r\n    // 复用addApprovalNode  因为抄送人和审批人基本一致\r\n    this.addApprovalNode(data, isBranchAction, this.createNode('copy', data.nodeId))\r\n  }\r\n\r\n  static addTimerNode(data, isBranchAction) {\r\n    // 复用addApprovalNode  因为和审批人基本一致\r\n    this.addApprovalNode(data, isBranchAction, this.createNode('timer', data.nodeId))\r\n  }\r\n  static addSubFlowNode(data, isBranchAction) {\r\n    // 复用addApprovalNode  因为和审批人基本一致\r\n    this.addApprovalNode(data, isBranchAction, this.createNode('subFlow', data.nodeId))\r\n  }\r\n  /**\r\n   * 添加条件节点 condition 通过点击添加条件进入该操作\r\n   * @param { Object } data - 目标节点所在分支数据，在该分支最后添加条件节点\r\n   */\r\n  static appendConditionNode(data) {\r\n    const conditions = data.conditionNodes\r\n    let node = this.createNode('condition', data.nodeId)\r\n    let defaultNodeIndex = conditions.findIndex(node => node.properties.isDefault)\r\n    node.properties.priority = conditions.length\r\n    if (defaultNodeIndex > -1) {\r\n      conditions.splice(-1, 0, node) // 插在倒数第二个\r\n      //更新优先级\r\n      node.properties.priority = conditions.length - 2\r\n      conditions[conditions.length - 1].properties.priority = conditions.length - 1\r\n    } else {\r\n      conditions.push(node)\r\n    }\r\n    this.setDefaultCondition(node, data)\r\n  }\r\n  // 添加分流/合流 branch\r\n  static appendInterflowNode(data) {\r\n    const conditions = data.conditionNodes\r\n    let node = this.createNode('interflow', data.nodeId)\r\n    let defaultNodeIndex = conditions.findIndex(node => node.properties.isDefault)\r\n    node.properties.priority = conditions.length\r\n    if (defaultNodeIndex > -1) {\r\n      conditions.splice(-1, 0, node) // 插在倒数第二个\r\n      //更新优先级\r\n      node.properties.priority = conditions.length - 2\r\n      conditions[conditions.length - 1].properties.priority = conditions.length - 1\r\n    } else {\r\n      conditions.push(node)\r\n    }\r\n  }\r\n  // 添加选择分支 branch\r\n  static appendBranchFlowNode(data) {\r\n    const conditions = data.conditionNodes\r\n    let node = this.createNode('branchFlow', data.nodeId)\r\n    let defaultNodeIndex = conditions.findIndex(node => node.properties.isDefault)\r\n    node.properties.priority = conditions.length\r\n    if (defaultNodeIndex > -1) {\r\n      conditions.splice(-1, 0, node) // 插在倒数第二个\r\n      //更新优先级\r\n      node.properties.priority = conditions.length - 2\r\n      conditions[conditions.length - 1].properties.priority = conditions.length - 1\r\n    } else {\r\n      conditions.push(node)\r\n    }\r\n  }\r\n  /**\r\n   * 添加条件分支 branch \r\n   * @param { Object } data - 目标节点所在节点数据，在该节点最后添加分支节点\r\n   */\r\n  static appendBranch(data, isBottomBtnOfBranch) {\r\n    // isBottomBtnOfBranch 用户点击的是分支树下面的按钮\r\n    let nodeData = data\r\n    // 由于conditionNodes是数组 不能添加下级分支 故在两个分支树之间添加一个不会显示的正常节点 兼容此种情况\r\n    if (Array.isArray(data.conditionNodes) && data.conditionNodes.length) {\r\n      if (isBottomBtnOfBranch) {\r\n        // 添加一个模拟用的空白节点并返回这个节点，作为新分支的父节点\r\n        nodeData = this.addEmptyNode(nodeData, true)\r\n      } else {\r\n        let emptyNode = this.addEmptyNode(nodeData, true)\r\n        emptyNode.conditionNodes = nodeData.conditionNodes\r\n        emptyNode.conditionType = \"condition\"\r\n        emptyNode.conditionNodes.forEach(n => {\r\n          n.prevId = emptyNode.nodeId\r\n        })\r\n      }\r\n    }\r\n    let conditionNodes = [\r\n      this.createNode(\"condition\", nodeData.nodeId),\r\n      this.createNode(\"condition\", nodeData.nodeId)\r\n    ].map((c, i) => {\r\n      c.properties.priority = i;\r\n      return c\r\n    })\r\n    nodeData.conditionNodes = conditionNodes\r\n    nodeData.conditionType = \"condition\"\r\n  }\r\n  static appendInterflowBranch(data, isBottomBtnOfBranch) {\r\n    // isBottomBtnOfBranch 用户点击的是分支树下面的按钮\r\n    let nodeData = data\r\n    // 由于conditionNodes是数组 不能添加下级分支 故在两个分支树之间添加一个不会显示的正常节点 兼容此种情况\r\n    if (Array.isArray(data.conditionNodes) && data.conditionNodes.length) {\r\n      if (isBottomBtnOfBranch) {\r\n        // 添加一个模拟用的空白节点并返回这个节点，作为新分支的父节点\r\n        nodeData = this.addEmptyNode(nodeData, true)\r\n      } else {\r\n        let emptyNode = this.addEmptyNode(nodeData, true)\r\n        emptyNode.conditionNodes = nodeData.conditionNodes\r\n        emptyNode.conditionType = \"interflow\"\r\n        emptyNode.conditionNodes.forEach(n => {\r\n          n.prevId = emptyNode.nodeId\r\n        })\r\n      }\r\n    }\r\n    let conditionNodes = [\r\n      this.createNode(\"interflow\", nodeData.nodeId),\r\n      this.createNode(\"interflow\", nodeData.nodeId)\r\n    ]\r\n    nodeData.conditionNodes = conditionNodes\r\n    nodeData.conditionType = \"interflow\"\r\n  }\r\n  // 新增选择分支节点\r\n  static appendBranchFlowBranch(data, isBottomBtnOfBranch) {\r\n    // isBottomBtnOfBranch 用户点击的是分支树下面的按钮\r\n    let nodeData = data\r\n    // 由于conditionNodes是数组 不能添加下级分支 故在两个分支树之间添加一个不会显示的正常节点 兼容此种情况\r\n    if (Array.isArray(data.conditionNodes) && data.conditionNodes.length) {\r\n      if (isBottomBtnOfBranch) {\r\n        // 添加一个模拟用的空白节点并返回这个节点，作为新分支的父节点\r\n        nodeData = this.addEmptyNode(nodeData, true)\r\n      } else {\r\n        let emptyNode = this.addEmptyNode(nodeData, true)\r\n        emptyNode.conditionNodes = nodeData.conditionNodes\r\n        emptyNode.conditionType = \"branchFlow\"\r\n        emptyNode.conditionNodes.forEach(n => {\r\n          n.prevId = emptyNode.nodeId\r\n        })\r\n      }\r\n    }\r\n    let conditionNodes = [\r\n      this.createNode(\"branchFlow\", nodeData.nodeId),\r\n      this.createNode(\"branchFlow\", nodeData.nodeId)\r\n    ]\r\n    nodeData.conditionNodes = conditionNodes\r\n    nodeData.conditionType = \"branchFlow\"\r\n  }\r\n  /**\r\n   * 重设节点优先级（条件节点）\r\n   * @param {Node} cnode - 当前节点\r\n   * @param {Number} oldPriority - 替换前的优先级（在数组中的顺序）\r\n   * @param {Node} processData - 整个流程图节点数据\r\n   */\r\n  static resortPrioByCNode(cnode, oldPriority, processData) {\r\n    // 当前节点为默认节点 取消修改优先级\r\n    if (cnode.properties.isDefault) {\r\n      cnode.properties.priority = oldPriority\r\n      return\r\n    }\r\n    let prevNode = this.getPreviousNode(cnode.prevId, processData)\r\n    let newPriority = cnode.properties.priority\r\n    // 替换节点为默认节点 取消修改优先级\r\n    if (prevNode.conditionNodes[newPriority].properties.isDefault) {\r\n      cnode.properties.priority = oldPriority\r\n      return\r\n    }\r\n    let delNode = prevNode.conditionNodes.splice(newPriority, 1, cnode)[0]\r\n    delNode.properties.priority = oldPriority\r\n    prevNode.conditionNodes[oldPriority] = delNode\r\n  }\r\n\r\n  /**\r\n   * 提升条件节点优先级——排序在前\r\n   * @param { Object } data - 目标节点数据\r\n   * @param { Object  } processData - 流程图的所有节点数据\r\n   */\r\n  static increasePriority(data, processData) {\r\n    if (data.properties.isDefault) { // 默认节点不能修改优先级\r\n      return\r\n    }\r\n    // 分支节点数据 包含该分支所有的条件节点\r\n    let prevNode = this.getPreviousNode(data.prevId, processData)\r\n    let branchData = prevNode.conditionNodes\r\n    let index = branchData.findIndex(c => c === data)\r\n    if (index) {\r\n      // 和前一个数组项交换位置 Array.prototype.splice会返回包含被删除的项的集合（数组）\r\n      branchData[index - 1].properties.priority = index\r\n      branchData[index].properties.priority = index - 1\r\n      branchData[index - 1] = branchData.splice(index, 1, branchData[index - 1])[0]\r\n    }\r\n  }\r\n  /**\r\n   * 降低条件节点优先级——排序在后\r\n   * @param { Object } data - 目标节点数据\r\n   * @param { Object  } processData - 流程图的所有节点数据\r\n   */\r\n  static decreasePriority(data, processData) {\r\n    // 分支节点数据 包含该分支所有的条件节点\r\n    let prevNode = this.getPreviousNode(data.prevId, processData)\r\n    let branchData = prevNode.conditionNodes\r\n    let index = branchData.findIndex(c => c.nodeId === data.nodeId)\r\n    if (index < branchData.length - 1) {\r\n      let lastNode = branchData[index + 1]\r\n      if (lastNode.properties.isDefault) { // 默认节点不能修改优先级\r\n        return\r\n      }\r\n      // 和后一个数组项交换位置 Array.prototype.splice会返回包含被删除的项的集合（数组）\r\n      lastNode.properties.priority = index\r\n      branchData[index].properties.priority = index + 1\r\n      branchData[index + 1] = branchData.splice(index, 1, branchData[index + 1])[0]\r\n    }\r\n  }\r\n  /**\r\n   * 当有其他条件节点设置条件后 检查并设置最后一个节点为默认节点\r\n   * @param {Node} cnode  - 当前节点\r\n   * @param {Node} processData - 整个流程图节点数据或父级节点数据\r\n   */\r\n  static setDefaultCondition(cnode, processData) {\r\n    const DEFAULT_TEXT = '其他情况进入此流程'\r\n    const conditions = this.getPreviousNode(cnode.prevId, processData).conditionNodes\r\n    const hasCondition = node => node.properties && (node.properties.initiator || !isEmptyArray(node.properties.conditions))\r\n    const clearDefault = node => {\r\n      node.properties.isDefault = false\r\n      node.content === DEFAULT_TEXT && (node.content = '请设置条件')\r\n    }\r\n    const setDefault = node => {\r\n      node.properties.isDefault = true\r\n      node.content = DEFAULT_TEXT\r\n    }\r\n    let count = 0\r\n    conditions.slice(0, -1).forEach(node => {\r\n      hasCondition(node) && count++\r\n      clearDefault(node)\r\n    })\r\n    const lastNode = conditions[conditions.length - 1]\r\n    count > 0 && !hasCondition(lastNode) ? setDefault(lastNode) : clearDefault(lastNode)\r\n  }\r\n  /**\r\n   * 校验单个节点必填项完整性\r\n   * @param {Node} node - 节点数据\r\n   */\r\n  static checkNode(node, parent) {\r\n    let valid = true\r\n    const props = node.properties\r\n    this.isStartNode(node) &&\r\n      !props.formId &&\r\n      (valid = false)\r\n\r\n    this.isConditionNode(node) &&\r\n      !props.isDefault &&\r\n      isEmptyArray(props.conditions) &&\r\n      (valid = false)\r\n\r\n    this.isSubFlowNode(node) &&\r\n      (!props.flowId || props.initiateType === 6 && (isEmptyArray(props.initiator) && isEmptyArray(props.initiatePos) && isEmptyArray(props.initiateRole) && isEmptyArray(props.initiateOrg) && isEmptyArray(props.initiateGroup))) &&\r\n      (valid = false)\r\n\r\n    this.isApproverNode(node) &&\r\n      (!props.assigneeType || props.assigneeType === 6) &&\r\n      (isEmptyArray(props.approvers) && isEmptyArray(props.approverPos) && isEmptyArray(props.approverRole) && isEmptyArray(props.approverOrg) && isEmptyArray(props.approverGroup)) &&\r\n      (valid = false)\r\n    return valid\r\n  }\r\n  /**\r\n   * 判断所有节点是否信息完整\r\n   * @param {Node} processData - 整个流程图数据\r\n   * @returns {Boolean}\r\n   */\r\n  static checkAllNode(processData) {\r\n    let valid = true\r\n    const loop = (node, callback, parent) => {\r\n      !this.checkNode(node, parent) && callback()\r\n      if (node.childNode) loop(node.childNode, callback, parent)\r\n      if (!isEmptyArray(node.conditionNodes)) {\r\n        node.conditionNodes.forEach(n => loop(n, callback, node))\r\n      }\r\n    }\r\n    loop(processData, () => valid = false)\r\n    return valid\r\n  }\r\n}\r\n\r\n/**\r\n * 添模拟数据\r\n */\r\nexport function getMockData() {\r\n  let startNode = NodeUtils.createNode(\"start\");\r\n  startNode.childNode = NodeUtils.createNode(\"approver\", startNode.nodeId)\r\n  return startNode;\r\n}","<script>\r\nimport { NodeUtils } from \"./util.js\";\r\nconst isCondition = data => data.type === \"condition\" || (data.type === \"approver\" && (data.isInterflow || data.isBranchFlow));\r\nconst notEmptyArray = arr => Array.isArray(arr) && arr.length > 0;\r\nconst hasBranch = data => notEmptyArray(data.conditionNodes);\r\nconst stopPro = ev => ev.stopPropagation();\r\n\r\nfunction createNormalCard(ctx, conf, h) {\r\n  let classList = ['flow-path-card']\r\n  if (conf.state) classList.push(conf.state)\r\n  const afterTrue = (isTrue, name) => (isTrue && classList.push(name), isTrue)\r\n  const isStartNode = afterTrue(NodeUtils.isStartNode(conf), 'start-node')\r\n  const isApprNode = afterTrue(NodeUtils.isApproverNode(conf), 'approver')\r\n  const isCopyNode = afterTrue(NodeUtils.isCopyNode(conf), 'copy')\r\n  const isTimerNode = afterTrue(NodeUtils.isTimerNode(conf), 'timer')\r\n  const isSubFlowNode = afterTrue(NodeUtils.isSubFlowNode(conf), 'subFlow')\r\n  return (\r\n    <section class={classList.join(' ')} onClick={this.eventLauncher.bind(ctx, \"edit\", conf)} >\r\n      <header class=\"header\">\r\n        <div class=\"title-box\" style=\"height: 100%;width:190px;\">\r\n          <span class=\"title-text\">{conf.properties.title}</span>\r\n        </div>\r\n        {(isSubFlowNode) && (\r\n          <el-tag class=\"async-state\" size=\"mini\" effect=\"plain\" style=\"right:10px\">{conf.properties.isAsync ? '异步' : '同步'}</el-tag>\r\n        )}\r\n      </header>\r\n      <div class=\"body\">\r\n        <span class=\"text\">{conf.content}</span>\r\n      </div>\r\n    </section>\r\n  );\r\n}\r\n// arg = ctx, data, h\r\nconst createFunc = (...arg) => createNormalCard.call(arg[0], ...arg)\r\nlet nodes = {\r\n  start: createFunc,\r\n  approver: createFunc,\r\n  copy: createFunc,\r\n  timer: createFunc,\r\n  subFlow: createFunc,\r\n  interflow: createFunc,\r\n  branchFlow: createFunc,\r\n  empty: _ => '',\r\n  condition: function (ctx, conf, h) {\r\n    return (\r\n      <section class=\"flow-path-card condition\">\r\n        <header class=\"header\">\r\n          <div class=\"title-box\" style=\"height: 20px;width:160px;\">\r\n            <span class=\"title-text\">{conf.properties.title}</span>\r\n          </div>\r\n        </header>\r\n        <div class=\"body\">\r\n          <div class=\"text\">{conf.content}</div>\r\n        </div>\r\n      </section>\r\n    );\r\n  }\r\n};\r\n\r\nfunction addNodeButton(ctx, data, h, isBranch = false) {\r\n  // 只有非条件节点和条件分支树下面的那个按钮 才能添加新分支树\r\n  let couldAddBranch = !hasBranch(data) || isBranch;\r\n  let isEmpty = data.type === \"empty\";\r\n  if (isEmpty && !isBranch) {\r\n    return \"\";\r\n  }\r\n  return (\r\n    <div class=\"add-node-btn-box flex justify-center\"></div>\r\n  );\r\n}\r\n\r\nfunction NodeFactory(ctx, data, h) {\r\n  if (!data) return\r\n  const showErrorTip = ctx.verifyMode && NodeUtils.checkNode(data) === false\r\n  let res = [],\r\n    branchNode = \"\",\r\n    selfNode = (\r\n      <div class=\"node-wrap\">\r\n        <div class={`node-wrap-box ${data.type} ${NodeUtils.isInterflowNode(data) ? 'interflow' : ''} ${NodeUtils.isBranchFlowNode(data) ? 'branchFlow' : ''} ${showErrorTip ? 'error' : ''}`}>\r\n          {nodes[data.type].call(ctx, ctx, data, h)}\r\n          {addNodeButton.call(ctx, ctx, data, h)}\r\n        </div>\r\n      </div>\r\n    );\r\n\r\n  if (hasBranch(data)) {\r\n    // 如果节点是数组 一定为条件分支 添加分支样式包裹\r\n    // {data.childNode && NodeFactory.call(ctx, ctx, data.childNode, h)}\r\n    branchNode = (\r\n      <div class=\"branch-wrap\">\r\n        <div class=\"branch-box-wrap\">\r\n          <div class=\"branch-box flex justify-center relative\">\r\n            <span class=\"line\"></span>\r\n            {data.conditionNodes.map(d => NodeFactory.call(ctx, ctx, d, h))}\r\n          </div>\r\n        </div>\r\n        {addNodeButton.call(ctx, ctx, data, h, true)}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (isCondition(data)) {\r\n    return (\r\n      <div class=\"col-box\">\r\n        <div class=\"center-line\"></div>\r\n        <div class=\"top-cover-line\"></div>\r\n        <div class=\"bottom-cover-line\"></div>\r\n        {selfNode}\r\n        {branchNode}\r\n        {NodeFactory.call(ctx, ctx, data.childNode, h)}\r\n      </div>\r\n    );\r\n  }\r\n  res.push(selfNode);\r\n  branchNode && res.push(branchNode);\r\n  data.childNode && res.push(NodeFactory.call(ctx, ctx, data.childNode, h));\r\n  return res;\r\n}\r\n\r\nfunction addEndNode(h) {\r\n  return <section class=\"end-node\">流程结束</section>;\r\n}\r\n\r\nexport default {\r\n  props: {\r\n    data: { type: Object, required: true },\r\n    // 点击发布时需要校验节点数据完整性 此时打开校验模式\r\n    verifyMode: { type: Boolean, default: true },\r\n  },\r\n  watch: {\r\n\r\n  },\r\n  methods: {\r\n    /**\r\n     *事件触发器 统筹本组件所有事件并转发到父组件中\r\n     * @param { Object } 包含event（事件名）和args（事件参数）两个参数\r\n     */\r\n    eventLauncher(event, ...args) {\r\n      // args.slice(0,-1) vue 会注入MouseEvent到最后一个参数 去除事件对象\r\n      let param = { event, args: args.slice(0, -1) };\r\n      this.$emit(\"emits\", param);\r\n    }\r\n  },\r\n  render(h) {\r\n    return (\r\n      <div style=\"display: inline-flex; flex-direction: column; align-items: center;\">\r\n        {this.data && NodeFactory.call(this, this, this.data, h)}\r\n        {addEndNode(h)}\r\n      </div>\r\n    );\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import 'index.scss';\r\n</style>","var render, staticRenderFns\nimport script from \"./Preview.vue?vue&type=script&lang=js&\"\nexport * from \"./Preview.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Preview.vue?vue&type=style&index=0&id=35f08b94&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"35f08b94\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Preview.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Preview.vue?vue&type=script&lang=js&\"","<script>\r\nimport { NodeUtils } from \"./util.js\";\r\nconst isCondition = data => data.type === \"condition\" || (data.type === \"approver\" && (data.isInterflow || data.isBranchFlow));\r\nconst notEmptyArray = arr => Array.isArray(arr) && arr.length > 0;\r\nconst hasBranch = data => notEmptyArray(data.conditionNodes);\r\nconst stopPro = ev => ev.stopPropagation();\r\n\r\nfunction createNormalCard(ctx, conf, h) {\r\n  let classList = ['flow-path-card']\r\n  if (conf.state) classList.push(conf.state)\r\n  const afterTrue = (isTrue, name) => (isTrue && classList.push(name), isTrue)\r\n  const isStartNode = afterTrue(NodeUtils.isStartNode(conf), 'start-node')\r\n  const isApprNode = afterTrue(NodeUtils.isApproverNode(conf), 'approver')\r\n  const isCopyNode = afterTrue(NodeUtils.isCopyNode(conf), 'copy')\r\n  const isTimerNode = afterTrue(NodeUtils.isTimerNode(conf), 'timer')\r\n  const isSubFlowNode = afterTrue(NodeUtils.isSubFlowNode(conf), 'subFlow')\r\n  return (\r\n    <section class={classList.join(' ')} onClick={this.eventLauncher.bind(ctx, \"edit\", conf)} >\r\n      <header class=\"header\">\r\n        <div class=\"title-box\" style=\"height: 100%;width:190px;\">\r\n          <span class=\"title-text\">{conf.properties.title}</span>\r\n        </div>\r\n        {(isSubFlowNode) && (\r\n          <el-tag class=\"async-state\" size=\"mini\" effect=\"plain\" style=\"right:10px\">{conf.properties.isAsync ? '异步' : '同步'}</el-tag>\r\n        )}\r\n      </header>\r\n      <div class=\"body\">\r\n        <span class=\"text\">{conf.content}</span>\r\n      </div>\r\n    </section>\r\n  );\r\n}\r\n// arg = ctx, data, h\r\nconst createFunc = (...arg) => createNormalCard.call(arg[0], ...arg)\r\nlet nodes = {\r\n  start: createFunc,\r\n  approver: createFunc,\r\n  copy: createFunc,\r\n  timer: createFunc,\r\n  subFlow: createFunc,\r\n  interflow: createFunc,\r\n  branchFlow: createFunc,\r\n  empty: _ => '',\r\n  condition: function (ctx, conf, h) {\r\n    return (\r\n      <section class=\"flow-path-card condition\">\r\n        <header class=\"header\">\r\n          <div class=\"title-box\" style=\"height: 20px;width:160px;\">\r\n            <span class=\"title-text\">{conf.properties.title}</span>\r\n          </div>\r\n        </header>\r\n        <div class=\"body\">\r\n          <div class=\"text\">{conf.content}</div>\r\n        </div>\r\n      </section>\r\n    );\r\n  }\r\n};\r\n\r\nfunction addNodeButton(ctx, data, h, isBranch = false) {\r\n  // 只有非条件节点和条件分支树下面的那个按钮 才能添加新分支树\r\n  let couldAddBranch = !hasBranch(data) || isBranch;\r\n  let isEmpty = data.type === \"empty\";\r\n  if (isEmpty && !isBranch) {\r\n    return \"\";\r\n  }\r\n  return (\r\n    <div class=\"add-node-btn-box2 flex justify-center\"></div>\r\n  );\r\n}\r\n\r\nfunction NodeFactory(ctx, data, h) {\r\n  if (!data) return\r\n  const showErrorTip = ctx.verifyMode && NodeUtils.checkNode(data) === false\r\n  let res = [],\r\n    branchNode = \"\",\r\n    selfNode = (\r\n      <div class=\"node-wrap\">\r\n        <div class={`node-wrap-box ${data.type} ${NodeUtils.isInterflowNode(data) ? 'interflow' : ''} ${NodeUtils.isBranchFlowNode(data) ? 'branchFlow' : ''} ${showErrorTip ? 'error' : ''}`}>\r\n          {nodes[data.type].call(ctx, ctx, data, h)}\r\n          {addNodeButton.call(ctx, ctx, data, h)}\r\n        </div>\r\n      </div>\r\n    );\r\n\r\n  if (hasBranch(data)) {\r\n    // 如果节点是数组 一定为条件分支 添加分支样式包裹\r\n    // {data.childNode && NodeFactory.call(ctx, ctx, data.childNode, h)}\r\n    branchNode = (\r\n      <div class=\"branch-wrap\">\r\n        <div class=\"branch-box-wrap\">\r\n          <div class=\"branch-box flex justify-center relative\">\r\n            <span class=\"line\"></span>\r\n            {data.conditionNodes.map(d => NodeFactory.call(ctx, ctx, d, h))}\r\n          </div>\r\n        </div>\r\n        {addNodeButton.call(ctx, ctx, data, h, true)}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (isCondition(data)) {\r\n    return (\r\n      <div class=\"col-box\">\r\n        <div class=\"center-line\"></div>\r\n        <div class=\"top-cover-line\"></div>\r\n        <div class=\"bottom-cover-line\"></div>\r\n        {selfNode}\r\n        {branchNode}\r\n        {NodeFactory.call(ctx, ctx, data.childNode, h)}\r\n      </div>\r\n    );\r\n  }\r\n  res.push(selfNode);\r\n  branchNode && res.push(branchNode);\r\n  data.childNode && res.push(NodeFactory.call(ctx, ctx, data.childNode, h));\r\n  return res;\r\n}\r\n\r\nfunction addEndNode(h) {\r\n  return <section class=\"end-node\">流程结束</section>;\r\n}\r\n\r\nexport default {\r\n  props: {\r\n    data: { type: Object, required: true },\r\n    // 点击发布时需要校验节点数据完整性 此时打开校验模式\r\n    verifyMode: { type: Boolean, default: true },\r\n  },\r\n  watch: {\r\n\r\n  },\r\n  methods: {\r\n    /**\r\n     *事件触发器 统筹本组件所有事件并转发到父组件中\r\n     * @param { Object } 包含event（事件名）和args（事件参数）两个参数\r\n     */\r\n    eventLauncher(event, ...args) {\r\n      // args.slice(0,-1) vue 会注入MouseEvent到最后一个参数 去除事件对象\r\n      let param = { event, args: args.slice(0, -1) };\r\n      this.$emit(\"emits\", param);\r\n    }\r\n  },\r\n  render(h) {\r\n    return (\r\n      <div style=\"display: inline-flex; flex-direction: column; align-items: center;\">\r\n        {this.data && NodeFactory.call(this, this, this.data, h)}\r\n        {addEndNode(h)}\r\n      </div>\r\n    );\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import 'index.scss';\r\n</style>\r\n","var render, staticRenderFns\nimport script from \"./PreviewT.vue?vue&type=script&lang=js&\"\nexport * from \"./PreviewT.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PreviewT.vue?vue&type=style&index=0&id=0006e200&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0006e200\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PreviewT.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PreviewT.vue?vue&type=script&lang=js&\"","import request from '@/utils/request'\r\n\r\n// 获取流程引擎列表\r\nexport function FlowEngineList(data) {\r\n  return request({\r\n    url: `/api/workflow/Engine/flowTemplate`,\r\n    method: 'get',\r\n    data\r\n  })\r\n}\r\n// 获取流程引擎信息\r\nexport function FlowEngineInfo(id) {\r\n  return request({\r\n    url: `/api/workflow/Engine/flowTemplate/${id}`,\r\n    method: 'get'\r\n  })\r\n}\r\n// 删除流程引擎\r\nexport function Delete(id) {\r\n  return request({\r\n    url: `/api/workflow/Engine/flowTemplate/${id}`,\r\n    method: 'DELETE'\r\n  })\r\n}\r\n// 新建流程引擎\r\nexport function Create(data) {\r\n  return request({\r\n    url: `/api/workflow/Engine/flowTemplate`,\r\n    method: 'post',\r\n    data\r\n  })\r\n}\r\n//  更新流程引擎\r\nexport function Update(data) {\r\n  return request({\r\n    url: `/api/workflow/Engine/flowTemplate/${data.id}`,\r\n    method: 'PUT',\r\n    data\r\n  })\r\n}\r\n// 复制流程\r\nexport function Copy(id) {\r\n  return request({\r\n    url: `/api/workflow/Engine/flowTemplate/${id}/Actions/Copy`,\r\n    method: 'post'\r\n  })\r\n}\r\n// 导出流程\r\nexport function exportData(id) {\r\n  return request({\r\n    url: `/api/workflow/Engine/flowTemplate/${id}/Actions/ExportData`,\r\n    method: 'GET'\r\n  })\r\n}\r\n// 发布流程引擎\r\nexport function Release(id) {\r\n  return request({\r\n    url: `/api/workflow/Engine/flowTemplate/Release/${id}`,\r\n    method: 'post'\r\n  })\r\n}\r\n// 停止流程引擎\r\nexport function Stop(id) {\r\n  return request({\r\n    url: `/api/workflow/Engine/flowTemplate/Stop/${id}`,\r\n    method: 'post'\r\n  })\r\n}\r\n// 获取引擎id\r\nexport function getFlowIdByCode(enCode) {\r\n  return request({\r\n    url: `/api/workflow/Engine/flowTemplate/getFlowIdByCode/${enCode}`,\r\n    method: 'get'\r\n  })\r\n}\r\n// 列表ListAll\r\nexport function FlowEngineListAll() {\r\n  return request({\r\n    url: `/api/workflow/Engine/flowTemplate/ListAll`,\r\n    method: 'get'\r\n  })\r\n}\r\n// 列表ListAll\r\nexport function FlowEnginePageList(data) {\r\n  return request({\r\n    url: `/api/workflow/Engine/flowTemplate/PageListAll`,\r\n    method: 'get',\r\n    data\r\n  })\r\n}\r\n// 列表流程小idListAll\r\nexport function FlowEnginePageChildList(data) {\r\n  return request({\r\n    url: `/api/workflow/Engine/flowTemplate/PageChildListAll`,\r\n    method: 'get',\r\n    data\r\n  })\r\n}\r\n// 流程引擎下拉框\r\nexport function FlowEngineSelector(type) {\r\n  return request({\r\n    url: `/api/workflow/Engine/flowTemplate/Selector`,\r\n    method: 'get',\r\n    data: { type }\r\n  })\r\n}\r\n// 获取流程发起节点表单信息\r\nexport function getFlowFormInfo(id) {\r\n  return request({\r\n    url: `/api/workflow/Engine/flowTemplate/${id}/FormInfo`,\r\n    method: 'get'\r\n  })\r\n}\r\n// 获取流程评论列表\r\nexport function getCommentList(data) {\r\n  return request({\r\n    url: `/api/workflow/Engine/FlowComment`,\r\n    method: 'get',\r\n    data\r\n  })\r\n}\r\n// 新建流程评论\r\nexport function createComment(data) {\r\n  return request({\r\n    url: `/api/workflow/Engine/FlowComment`,\r\n    method: 'post',\r\n    data\r\n  })\r\n}\r\n// 删除流程评论\r\nexport function delComment(id) {\r\n  return request({\r\n    url: `/api/workflow/Engine/FlowComment/${id}`,\r\n    method: 'delete'\r\n  })\r\n}\r\n//流程版本列表\r\nexport function flowJsonList(id, data) {\r\n  return request({\r\n    url: `/api/workflow/Engine/flowTemplate/${id}/FlowJsonList`,\r\n    method: 'get',\r\n    data\r\n  })\r\n}\r\n\r\n//设置主版本\r\nexport function mainVersion(id) {\r\n  return request({\r\n    url: `/api/workflow/Engine/flowTemplate/${id}/MainVersion`,\r\n    method: 'post',\r\n  })\r\n}\r\n\r\n//设置主版本\r\nexport function delVersion(id) {\r\n  return request({\r\n    url: `/api/workflow/Engine/flowTemplate/${id}/FlowJson`,\r\n    method: 'delete',\r\n  })\r\n}\r\n\r\n// 委托可选全部流程\r\nexport function FlowEngineAll(data) {\r\n  return request({\r\n    url: `/api/workflow/Engine/flowTemplate/getflowAll`,\r\n    method: 'get',\r\n    data\r\n  })\r\n}\r\n\r\n// 委托 通过list<flowId>获取流程引擎列表\r\nexport function FlowEngineListByIds(data) {\r\n  return request({\r\n    url: `/api/workflow/Engine/flowTemplate/getflowList`,\r\n    method: 'post',\r\n    data\r\n  })\r\n}\r\n\r\n//设置协管\r\nexport function assist(data) {\r\n  return request({\r\n    url: `/api/workflow/Engine/flowTemplate/assist`,\r\n    method: 'post',\r\n    data\r\n  })\r\n}\r\n\r\n//获取协管接口\r\nexport function assistList(id) {\r\n  return request({\r\n    url: `/api/workflow/Engine/flowTemplate/${id}/assistList`,\r\n    method: 'get'\r\n  })\r\n}\r\n// 获取多流程流程列表\r\nexport function getFlowList(id, type = '') {\r\n  return request({\r\n    url: `/api/workflow/Engine/flowTemplate/FlowJsonList/${id}`,\r\n    method: 'get',\r\n    data: { type }\r\n  })\r\n}","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PreviewTransform.vue?vue&type=style&index=0&id=dc910eec&prod&scoped=true&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=229309b6&prod&lang=scss&scoped=true&\"","var render, staticRenderFns\nimport script from \"./PreviewTransform.vue?vue&type=script&lang=js&\"\nexport * from \"./PreviewTransform.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PreviewTransform.vue?vue&type=style&index=0&id=dc910eec&prod&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"dc910eec\",\n  null\n  \n)\n\nexport default component.exports","<script>\r\n// import FlowCard from \"./FlowCard/Preview\";\r\nimport FlowCardT from \"./FlowCard/PreviewT.vue\";\r\nimport { NodeUtils, getMockData } from \"./FlowCard/util.js\";\r\n\r\nexport default {\r\n  name: 'ProcessT',\r\n  props: ['tabName', 'conf'],\r\n  data() {\r\n    let data = {}\r\n    if (typeof this.conf === 'object' && this.conf !== null && JSON.stringify(this.conf) !== '{}') {\r\n      data = Object.assign(NodeUtils.createNode('start'), this.conf)\r\n    } else {\r\n      data = getMockData()\r\n    }\r\n    return {\r\n      data, // 流程图数据\r\n      scaleVal: 95, // 流程图缩放比例 100%\r\n      step: 5, // 缩放步长\r\n      updateId: 0, // key值 用于模拟$forceUpdate\r\n      activeData: null, // 被激活的流程卡片数据，用于属性面板编辑\r\n      isProcessCmp: true,\r\n      verifyMode: false\r\n    };\r\n  },\r\n  methods: {\r\n    // 给父级组件提供的获取流程数据得方法\r\n    getData() {\r\n      this.verifyMode = true\r\n      if (NodeUtils.checkAllNode(this.data)) {\r\n        return Promise.resolve({ formData: this.data })\r\n      } else {\r\n        return Promise.reject({ target: this.tabName })\r\n      }\r\n    },\r\n    /**\r\n     * 接收所有FlowCard事件触发\r\n     * @param { Object } data - 含有event(事件名称)/args(参数)两个属性\r\n     */\r\n    eventReceiver({ event, args }) {\r\n      this.$emit('subFlow', args[0].nodeId)\r\n      if (event === \"edit\") {\r\n        this.activeData = args[0]; // 打开属性面板\r\n        return;\r\n      }\r\n\r\n      // 本实例只监听了第一层数据（startNode）变动\r\n      // 为了实时更新  采用$forceUpdate刷新 但是由于某些条件下触发失效（未排除清除原因）\r\n      // 使用key + 监听父组件updateId方式强制刷新\r\n      NodeUtils[event](...args);\r\n      this.forceUpdate();\r\n    },\r\n\r\n    forceUpdate() {\r\n      this.updateId = this.updateId + 1;\r\n    },\r\n    /**\r\n     * 控制流程图缩放\r\n     * @param { Object } val - 缩放增量 是step的倍数 可正可负\r\n     */\r\n    changeScale(val) {\r\n      if (this.scaleVal >= 0 && this.scaleVal <= 200) {\r\n        if (this.scaleVal === 200 && this.scaleVal + val > 200) return\r\n        if (this.scaleVal === 0 && this.scaleVal + val < 0) return\r\n        // 缩放介于0%~200%\r\n        this.scaleVal += val;\r\n      }\r\n    },\r\n    /**\r\n     * 属性面板提交事件\r\n     * @param { Object } value - 被编辑的节点的properties属性对象\r\n     */\r\n    onPropEditConfirm(value, content) {\r\n      this.activeData.content = content || '请设置条件'\r\n      let oldProp = this.activeData.properties;\r\n      this.activeData.properties = value;\r\n      // 修改优先级\r\n      if (NodeUtils.isConditionNode(this.activeData)) {\r\n        value.priority !== oldProp.priority\r\n          && NodeUtils.resortPrioByCNode(\r\n            this.activeData,\r\n            oldProp.priority,\r\n            this.data\r\n          );\r\n        NodeUtils.setDefaultCondition(this.activeData, this.data)\r\n      }\r\n      if (NodeUtils.isStartNode(this.activeData)) this.$emit('startNodeChange', this.data)\r\n      this.onClosePanel();\r\n      this.forceUpdate();\r\n    },\r\n    /**\r\n     * 属性面板取消事件\r\n     */\r\n    onClosePanel() {\r\n      this.activeData = null;\r\n    },\r\n\r\n    // 传formIds 查询指定组件 未传时  判断所有组件\r\n    isFilledPCon(formIds) {\r\n      let res = false\r\n      const loopChild = (parent, callback) => parent.childNode && loop(parent.childNode, callback)\r\n      const loop = (data, callback) => {\r\n        if (res || !data) return // 查找到就退出\r\n        if (Array.isArray(data.conditionNodes)) {\r\n          const uesd = data.conditionNodes.some(c => {\r\n            const cons = c.properties.conditions || []\r\n            return Array.isArray(formIds)\r\n              ? cons.some(item => formIds.includes(item.formId)) // 查询特定组件\r\n              : cons.length > 0 // 只要有节点设置了条件 说明就有组件作为条件被使用\r\n          })\r\n          uesd ? callback() : data.conditionNodes.forEach(t => loopChild(t, callback))\r\n        }\r\n        loopChild(data, callback)\r\n      }\r\n      loop(this.data, () => res = true)\r\n      return res\r\n    }\r\n  },\r\n  render: function (h) {\r\n    return (\r\n      <div class=\"flow-container flow-container-preview\">\r\n        <div class=\"tips\">\r\n          <div class=\"tips-item\"><span class=\"icon success\">●</span>已完成</div>\r\n          <div class=\"tips-item\"><span class=\"icon current\">●</span>进行中</div>\r\n          <div class=\"tips-item\"><span class=\"icon\">●</span>无/未处理</div>\r\n        </div>\r\n        <FlowCardT\r\n          verifyMode={this.verifyMode}\r\n          key={this.updateId}\r\n          data={this.data}\r\n          onEmits={this.eventReceiver}\r\n          style={{ transform: `scale(${this.scaleVal / 100})` }}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n$bg-color: #fff;\r\n\r\n.flow-container {\r\n  display: inline-block;\r\n  background: $bg-color;\r\n  width: 100%;\r\n  box-sizing: border-box;\r\n  text-align: center;\r\n  overflow: auto;\r\n  &.flow-container-preview {\r\n    height: calc(100% - 10px);\r\n    ::v-deep .branch-wrap {\r\n      .branch-box {\r\n        background: $bg-color;\r\n\r\n        > .col-box {\r\n          &:first-of-type {\r\n            &::before,\r\n            &::after {\r\n              background: $bg-color !important;\r\n            }\r\n          }\r\n          &:last-of-type {\r\n            &::before,\r\n            &::after {\r\n              background: $bg-color;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    ::v-deep .node-wrap-box.approver::before {\r\n      background: #fff;\r\n    }\r\n    ::v-deep .flow-path-card {\r\n      &:hover {\r\n        .title-text {\r\n          border-bottom: none;\r\n        }\r\n      }\r\n      &.condition:hover,\r\n      &.timer:hover {\r\n        box-shadow: 0 0 0 2px #b6b6b6, 0 0 5px 4px rgb(0 0 0 / 20%);\r\n      }\r\n      &.start-node,\r\n      &.approver,\r\n      &.subFlow {\r\n        &:hover {\r\n          box-shadow: 0 0 0 2px #b6b6b6, 0 0 5px 4px rgb(0 0 0 / 20%);\r\n        }\r\n        .header {\r\n          background-color: #b6b6b6;\r\n        }\r\n      }\r\n      &.state-past {\r\n        .header {\r\n          background-color: #67c23a;\r\n        }\r\n        &:hover {\r\n          box-shadow: 0 0 0 2px #67c23a, 0 0 5px 4px rgb(103 194 58 / 20%);\r\n        }\r\n      }\r\n      &.state-curr {\r\n        .header {\r\n          background-color: #1890ff;\r\n        }\r\n        &:hover {\r\n          box-shadow: 0 0 0 2px #1890ff, 0 0 5px 4px rgb(24 144 255 / 20%);\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.scale-slider {\r\n  right: 10px;\r\n  z-index: 199;\r\n  position: fixed;\r\n\r\n  .btn {\r\n    display: inline-block;\r\n    padding: 4px;\r\n    border: 1px solid #cacaca;\r\n    border-radius: 3px;\r\n    background: #fff;\r\n    margin-left: 10px;\r\n    margin-right: 10px;\r\n    cursor: pointer;\r\n  }\r\n}\r\n.tips {\r\n  left: 20px;\r\n  top: 0px;\r\n  z-index: 199;\r\n  text-align: left;\r\n  .tips-item {\r\n    line-height: 20px;\r\n    font-size: 16px;\r\n    display: inline-block;\r\n    margin-right: 15px;\r\n    .icon {\r\n      font-size: 20px;\r\n      margin-right: 5px;\r\n      color: #b6b6b6;\r\n      &.success {\r\n        color: #67c23a;\r\n      }\r\n      &.current {\r\n        color: #1890ff;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PreviewTransform.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PreviewTransform.vue?vue&type=script&lang=js&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Preview.vue?vue&type=style&index=0&id=e75c0dc0&prod&scoped=true&lang=scss&\"","export * from \"-!../../mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../vue-loader/lib/loaders/stylePostLoader.js!../../postcss-loader/src/index.js??ref--7-oneOf-1-2!../../cache-loader/dist/cjs.js??ref--1-0!../../vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=a1968bcc&prod&scoped=true&lang=css&\"","var render, staticRenderFns\nimport script from \"./Preview.vue?vue&type=script&lang=js&\"\nexport * from \"./Preview.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Preview.vue?vue&type=style&index=0&id=e75c0dc0&prod&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"e75c0dc0\",\n  null\n  \n)\n\nexport default component.exports","<script>\r\nimport FlowCard from \"./FlowCard/Preview\";\r\nimport { NodeUtils, getMockData } from \"./FlowCard/util.js\";\r\n\r\nexport default {\r\n  name: 'Process',\r\n  props: ['tabName', 'conf'],\r\n  data() {\r\n    let data = {}\r\n    if (typeof this.conf === 'object' && this.conf !== null && JSON.stringify(this.conf) !== '{}') {\r\n      data = Object.assign(NodeUtils.createNode('start'), this.conf)\r\n    } else {\r\n      data = getMockData()\r\n    }\r\n    return {\r\n      data, // 流程图数据\r\n      scaleVal: 100, // 流程图缩放比例 100%\r\n      step: 5, // 缩放步长\r\n      updateId: 0, // key值 用于模拟$forceUpdate\r\n      activeData: null, // 被激活的流程卡片数据，用于属性面板编辑\r\n      isProcessCmp: true,\r\n      verifyMode: false\r\n    };\r\n  },\r\n  methods: {\r\n    // 给父级组件提供的获取流程数据得方法\r\n    getData() {\r\n      this.verifyMode = true\r\n      if (NodeUtils.checkAllNode(this.data)) {\r\n        return Promise.resolve({ formData: this.data })\r\n      } else {\r\n        return Promise.reject({ target: this.tabName })\r\n      }\r\n    },\r\n    /**\r\n     * 接收所有FlowCard事件触发\r\n     * @param { Object } data - 含有event(事件名称)/args(参数)两个属性\r\n     */\r\n    eventReceiver({ event, args }) {\r\n      this.$emit('subFlow', args[0].nodeId)\r\n      if (event === \"edit\") {\r\n        this.activeData = args[0]; // 打开属性面板\r\n        return;\r\n      }\r\n\r\n      // 本实例只监听了第一层数据（startNode）变动\r\n      // 为了实时更新  采用$forceUpdate刷新 但是由于某些条件下触发失效（未排除清除原因）\r\n      // 使用key + 监听父组件updateId方式强制刷新\r\n      NodeUtils[event](...args);\r\n      this.forceUpdate();\r\n    },\r\n\r\n    forceUpdate() {\r\n      this.updateId = this.updateId + 1;\r\n    },\r\n    /**\r\n     * 控制流程图缩放\r\n     * @param { Object } val - 缩放增量 是step的倍数 可正可负\r\n     */\r\n    changeScale(val) {\r\n      if (this.scaleVal >= 0 && this.scaleVal <= 200) {\r\n        if (this.scaleVal === 200 && this.scaleVal + val > 200) return\r\n        if (this.scaleVal === 0 && this.scaleVal + val < 0) return\r\n        // 缩放介于0%~200%\r\n        this.scaleVal += val;\r\n      }\r\n    },\r\n    /**\r\n     * 属性面板提交事件\r\n     * @param { Object } value - 被编辑的节点的properties属性对象\r\n     */\r\n    onPropEditConfirm(value, content) {\r\n      this.activeData.content = content || '请设置条件'\r\n      let oldProp = this.activeData.properties;\r\n      this.activeData.properties = value;\r\n      // 修改优先级\r\n      if (NodeUtils.isConditionNode(this.activeData)) {\r\n        value.priority !== oldProp.priority\r\n          && NodeUtils.resortPrioByCNode(\r\n            this.activeData,\r\n            oldProp.priority,\r\n            this.data\r\n          );\r\n        NodeUtils.setDefaultCondition(this.activeData, this.data)\r\n      }\r\n      if (NodeUtils.isStartNode(this.activeData)) this.$emit('startNodeChange', this.data)\r\n      this.onClosePanel();\r\n      this.forceUpdate();\r\n    },\r\n    /**\r\n     * 属性面板取消事件\r\n     */\r\n    onClosePanel() {\r\n      this.activeData = null;\r\n    },\r\n\r\n    // 传formIds 查询指定组件 未传时  判断所有组件\r\n    isFilledPCon(formIds) {\r\n      let res = false\r\n      const loopChild = (parent, callback) => parent.childNode && loop(parent.childNode, callback)\r\n      const loop = (data, callback) => {\r\n        if (res || !data) return // 查找到就退出\r\n        if (Array.isArray(data.conditionNodes)) {\r\n          const uesd = data.conditionNodes.some(c => {\r\n            const cons = c.properties.conditions || []\r\n            return Array.isArray(formIds)\r\n              ? cons.some(item => formIds.includes(item.formId)) // 查询特定组件\r\n              : cons.length > 0 // 只要有节点设置了条件 说明就有组件作为条件被使用\r\n          })\r\n          uesd ? callback() : data.conditionNodes.forEach(t => loopChild(t, callback))\r\n        }\r\n        loopChild(data, callback)\r\n      }\r\n      loop(this.data, () => res = true)\r\n      return res\r\n    }\r\n  },\r\n  render: function (h) {\r\n    return (\r\n      <div class=\"flow-container flow-container-preview\">\r\n        <div class=\"scale-slider\">\r\n          <i class=\"btn el-icon-minus\"\r\n            onClick={this.changeScale.bind(this, -this.step)}></i>\r\n          <span style=\"font-size:14px;\">{this.scaleVal}%</span>\r\n          <i class=\"btn el-icon-plus\"\r\n            onClick={this.changeScale.bind(this, this.step)}></i>\r\n        </div>\r\n        <div class=\"tips\">\r\n          <div class=\"tips-item\"><span class=\"icon success\">●</span>已完成</div>\r\n          <div class=\"tips-item\"><span class=\"icon current\">●</span>进行中</div>\r\n          <div class=\"tips-item\"><span class=\"icon\">●</span>无/未处理</div>\r\n        </div>\r\n        <FlowCard\r\n          verifyMode={this.verifyMode}\r\n          key={this.updateId}\r\n          data={this.data}\r\n          onEmits={this.eventReceiver}\r\n          style={{ transform: `scale(${this.scaleVal / 100})` }}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n$bg-color: #fff;\r\n\r\n.flow-container {\r\n  display: inline-block;\r\n  background: $bg-color;\r\n  width: 100%;\r\n  box-sizing: border-box;\r\n  text-align: center;\r\n  overflow: auto;\r\n  &.flow-container-preview {\r\n    height: calc(100% - 10px);\r\n    ::v-deep .branch-wrap {\r\n      .branch-box {\r\n        background: $bg-color;\r\n\r\n        > .col-box {\r\n          &:first-of-type {\r\n            &::before,\r\n            &::after {\r\n              background: $bg-color !important;\r\n            }\r\n          }\r\n          &:last-of-type {\r\n            &::before,\r\n            &::after {\r\n              background: $bg-color;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    ::v-deep .node-wrap-box.approver::before {\r\n      background: #fff;\r\n    }\r\n    ::v-deep .flow-path-card {\r\n      &:hover {\r\n        .title-text {\r\n          border-bottom: none;\r\n        }\r\n      }\r\n      &.condition:hover,\r\n      &.timer:hover {\r\n        box-shadow: 0 0 0 2px #b6b6b6, 0 0 5px 4px rgb(0 0 0 / 20%);\r\n      }\r\n      &.start-node,\r\n      &.approver,\r\n      &.subFlow {\r\n        &:hover {\r\n          box-shadow: 0 0 0 2px #b6b6b6, 0 0 5px 4px rgb(0 0 0 / 20%);\r\n        }\r\n        .header {\r\n          background-color: #b6b6b6;\r\n        }\r\n      }\r\n      &.state-past {\r\n        .header {\r\n          background-color: #67c23a;\r\n        }\r\n        &:hover {\r\n          box-shadow: 0 0 0 2px #67c23a, 0 0 5px 4px rgb(103 194 58 / 20%);\r\n        }\r\n      }\r\n      &.state-curr {\r\n        .header {\r\n          background-color: #1890ff;\r\n        }\r\n        &:hover {\r\n          box-shadow: 0 0 0 2px #1890ff, 0 0 5px 4px rgb(24 144 255 / 20%);\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.scale-slider {\r\n  right: 10px;\r\n  z-index: 199;\r\n  position: fixed;\r\n\r\n  .btn {\r\n    display: inline-block;\r\n    padding: 4px;\r\n    border: 1px solid #cacaca;\r\n    border-radius: 3px;\r\n    background: #fff;\r\n    margin-left: 10px;\r\n    margin-right: 10px;\r\n    cursor: pointer;\r\n  }\r\n}\r\n.tips {\r\n  left: 20px;\r\n  top: 0px;\r\n  z-index: 199;\r\n  text-align: left;\r\n  .tips-item {\r\n    line-height: 20px;\r\n    font-size: 16px;\r\n    display: inline-block;\r\n    margin-right: 15px;\r\n    .icon {\r\n      font-size: 20px;\r\n      margin-right: 5px;\r\n      color: #b6b6b6;\r\n      &.success {\r\n        color: #67c23a;\r\n      }\r\n      &.current {\r\n        color: #1890ff;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Preview.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Preview.vue?vue&type=script&lang=js&\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('el-dialog',{staticClass:\"JNPF-dialog JNPF-dialog_center sign-dialog\",attrs:{\"title\":\"请签名\",\"closeOnClickModal\":false,\"visible\":_vm.signVisible,\"append-to-body\":\"\",\"width\":\"600px\"},on:{\"update:visible\":function($event){_vm.signVisible=$event}}},[_c('div',{staticClass:\"sign-main-box\"},[_c('vue-esign',{ref:\"esign\",attrs:{\"height\":300,\"width\":560,\"lineWidth\":_vm.lineWidth}}),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showTip),expression:\"showTip\"}],staticClass:\"tip\"},[_vm._v(\"使用鼠标在此签名\")])],1),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":_vm.handleReset}},[_vm._v(\"清空\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"loading\":_vm.loading},on:{\"click\":function($event){return _vm.handleGenerate()}}},[_vm._v(\"确定签名\")])],1)])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <el-dialog title=\"请签名\" class=\"JNPF-dialog JNPF-dialog_center sign-dialog\"\r\n      :closeOnClickModal='false' :visible.sync=\"signVisible\" append-to-body width=\"600px\">\r\n      <div class=\"sign-main-box\">\r\n        <vue-esign ref=\"esign\" :height='300' :width=\"560\" :lineWidth=\"lineWidth\" />\r\n        <div class=\"tip\" v-show=\"showTip\">使用鼠标在此签名</div>\r\n      </div>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"handleReset\">清空</el-button>\r\n        <el-button type=\"primary\" :loading=\"loading\" @click=\"handleGenerate()\">确定签名</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { createSign } from '@/api/permission/userSetting'\r\nimport vueEsign from 'vue-esign'\r\nexport default {\r\n  name: 'SignImgDialog',\r\n  components: { vueEsign },\r\n  props: {\r\n    lineWidth: {\r\n      required: true,\r\n      type: Number\r\n    },\r\n    isDefault: {\r\n      required: true,\r\n      type: Number\r\n    },\r\n    userInfo: {\r\n      type: Object,\r\n      default() {\r\n        return {}\r\n      }\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      signVisible: false,\r\n      loading: false,\r\n      signImg: '',\r\n      showTip: true\r\n    }\r\n  },\r\n  methods: {\r\n    init() {\r\n      this.handleReset()\r\n      this.signVisible = true\r\n      this.showTip = true\r\n      this.$nextTick(() => {\r\n        this.$watch(\r\n          () => {\r\n            return this.$refs.esign.hasDrew\r\n          },\r\n          (val) => {\r\n            this.showTip = !val\r\n          }\r\n        )\r\n      })\r\n    },\r\n    handleReset() {\r\n      this.signImg = ''\r\n      this.$nextTick(() => {\r\n        this.$refs.esign && this.$refs.esign.reset()\r\n      })\r\n    },\r\n    handleGenerate() {\r\n      this.loading = true\r\n      this.$refs.esign.generate().then(res => {\r\n        if (res) this.signImg = res\r\n        let query = {\r\n          signImg: this.signImg,\r\n          isDefault: this.isDefault\r\n        }\r\n        createSign(query).then(res => {\r\n          if (this.isDefault == 0) {\r\n            this.$message({\r\n              message: res.msg,\r\n              type: 'success',\r\n              duration: 1500\r\n            })\r\n            if (!this.userInfo.signImg) this.$store.commit('user/SET_USERINFO_SIGNIMG', this.signImg)\r\n          }\r\n          if (this.isDefault == 1) {\r\n            this.$store.commit('user/SET_USERINFO_SIGNIMG', this.signImg)\r\n          }\r\n          this.signVisible = false\r\n          this.loading = false\r\n          this.$emit('close', this.signImg)\r\n          this.handleReset()\r\n\r\n        }).catch(err => {\r\n          this.signVisible = false\r\n          this.loading = false\r\n          this.$emit('close')\r\n          this.handleReset()\r\n        })\r\n      }).catch(err => {\r\n        this.loading = false\r\n        this.$message.warning(\"请签名\")\r\n      })\r\n    },\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.sign-dialog {\r\n  ::v-deep .el-dialog__body {\r\n    overflow: hidden;\r\n    height: 320px;\r\n    overflow: auto;\r\n    overflow-x: hidden;\r\n    padding: 23px 14px 2px !important;\r\n  }\r\n}\r\n\r\n.sign-main-box {\r\n  border: 1px solid rgb(224, 238, 238);\r\n  width: 100%;\r\n  height: 300px;\r\n  background-color: rgb(247, 247, 247);\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  margin-top: -10px;\r\n  margin-bottom: -10px;\r\n  position: relative;\r\n  .tip {\r\n    height: 300px;\r\n    line-height: 300px;\r\n    text-align: center;\r\n    position: absolute;\r\n    left: 0;\r\n    top: 0;\r\n    right: 0;\r\n    color: #9d9d9f;\r\n    font-size: 16px;\r\n    pointer-events: none;\r\n  }\r\n}\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=229309b6&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=229309b6&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"229309b6\",\n  null\n  \n)\n\nexport default component.exports","const defaultStartForm = {\r\n  initiator: [],\r\n  title: '流程发起',\r\n  errorRule: 1, // 异常处理规则\r\n  errorRuleUser: [], // 指定人员处理异常\r\n  funcConfigRule: 0,\r\n  // 限时设置\r\n  timeLimitConfig: {\r\n    on: 0,  // 开启\r\n    nodeLimit: 0, // 节点限定时长起始值类型\r\n    duringDeal: 24, // 节点处理限定时长(时)\r\n    formField: '',  // 请选择字段\r\n  },\r\n  overTimeConfig: {\r\n    on: 0, // 开启\r\n    firstOver: 0, // 第一次超时时间(时)\r\n    overTimeDuring: 2, // 超时间隔(时)\r\n    overNotice: false, // 超时事务-超时通知\r\n    overAutoApprove: false, // 超时事务-超时自动审批\r\n    overAutoApproveTime: 5, // 自动审批超时次数(次)\r\n    overEvent: false, // 超时事件\r\n    overEventTime: 5, // 超时事件超时次数(次)\r\n  },\r\n  noticeConfig: {\r\n    on: 0, // 开启\r\n    firstOver: 1, // 第一次提醒时间(时)\r\n    overTimeDuring: 2, // 提醒间隔(时)\r\n    overNotice: false, // 提醒事务-提醒通知\r\n    overEvent: false, // 提醒事件\r\n    overEventTime: 5, // 提醒次数(次)\r\n  },\r\n  // 流程事件\r\n  overTimeFuncConfig: {\r\n    on: false,     // 开启\r\n    interfaceId: '', // 接口id\r\n    interfaceName: '', // 接口名称\r\n    templateJson: [] // 模块json\r\n  },\r\n  noticeFuncConfig: {\r\n    on: false,     // 开启\r\n    interfaceId: '', // 接口id\r\n    interfaceName: '', // 接口名称\r\n    templateJson: [] // 模块json\r\n  },\r\n  initFuncConfig: {\r\n    on: false,\r\n    interfaceId: '',\r\n    interfaceName: '',\r\n    templateJson: []\r\n  },\r\n  endFuncConfig: {\r\n    on: false,\r\n    interfaceId: '',\r\n    interfaceName: '',\r\n    templateJson: []\r\n  },\r\n  flowRecallFuncConfig: {\r\n    on: false,\r\n    interfaceId: '',\r\n    interfaceName: '',\r\n    templateJson: []\r\n  },\r\n  waitMsgConfig: {\r\n    on: 3,\r\n    msgId: '',\r\n    msgName: '',\r\n    templateJson: []\r\n  },\r\n  endMsgConfig: {\r\n    on: 3,\r\n    msgId: '',\r\n    msgName: '',\r\n    templateJson: []\r\n  },\r\n  approveMsgConfig: {\r\n    on: 3,\r\n    msgId: '',\r\n    msgName: '',\r\n    templateJson: []\r\n  },\r\n  rejectMsgConfig: {\r\n    on: 3,\r\n    msgId: '',\r\n    msgName: '',\r\n    templateJson: []\r\n  },\r\n  copyMsgConfig: {\r\n    on: 3,\r\n    msgId: '',\r\n    msgName: '',\r\n    templateJson: []\r\n  },\r\n  overTimeMsgConfig: {\r\n    on: 3,\r\n    msgId: '',\r\n    msgName: '',\r\n    templateJson: []\r\n  },\r\n  noticeMsgConfig: {\r\n    on: 3,\r\n    msgId: '',\r\n    msgName: '',\r\n    templateJson: []\r\n  },\r\n  hasSubmitBtn: true,\r\n  submitBtnText: '提 交',\r\n  hasSaveBtn: true,\r\n  saveBtnText: '暂 存',\r\n  hasPressBtn: true,\r\n  pressBtnText: '催 办',\r\n  hasRevokeBtn: true,\r\n  revokeBtnText: '撤 回',\r\n  hasPrintBtn: false,\r\n  printBtnText: '打 印',\r\n  printId: '',\r\n  isComment: false,\r\n  isBatchApproval: false,\r\n  isSummary: false,\r\n  summaryType: 0,\r\n  titleType: 0,\r\n  defaultContent: '{发起用户名}的{流程名称}',\r\n  titleContent: '',\r\n  formOperates: [],\r\n  circulateUser: [],\r\n  isCustomCopy: false,\r\n  extraCopyRule: 1,\r\n  hasSign: false,\r\n  hasOpinion: true,\r\n  formId: \"\",\r\n  formName: \"\",\r\n  formFieldList: [],\r\n}\r\nexport default {\r\n  defaultStartForm,\r\n  start: {\r\n    type: \"start\",\r\n    content: \"所有人\",\r\n    properties: defaultStartForm\r\n  },\r\n  approver: {\r\n    type: \"approver\",\r\n    content: \"请设置审批人\",\r\n    properties: {\r\n      title: '审批节点'\r\n    }\r\n  },\r\n  copy: {\r\n    type: 'copy',\r\n    content: '发起人自选',\r\n    properties: {\r\n      title: '抄送人',\r\n      members: [],\r\n      userOptional: true\r\n    }\r\n  },\r\n  timer: {\r\n    type: 'timer',\r\n    content: '请设置时间',\r\n    properties: {\r\n      title: '定时器',\r\n      day: 0,\r\n      hour: 0,\r\n      minute: 0,\r\n      second: 0\r\n    }\r\n  },\r\n  subFlow: {\r\n    type: 'subFlow',\r\n    content: '请设置发起人',\r\n    properties: {\r\n      title: '子流程'\r\n    }\r\n  },\r\n  interflow: {\r\n    type: \"approver\",\r\n    content: \"请设置审批人\",\r\n    isInterflow: true,\r\n    properties: {\r\n      title: '审批节点'\r\n    }\r\n  },\r\n  branchFlow: {\r\n    type: \"approver\",\r\n    content: \"请设置审批人\",\r\n    isBranchFlow: true,\r\n    properties: {\r\n      title: '审批节点'\r\n    }\r\n  },\r\n  condition: {\r\n    type: \"condition\",\r\n    content: \"请设置条件\",\r\n    properties: {\r\n      title: '条件',\r\n      matchLogic: 'and',\r\n      conditions: [],\r\n      initiator: null\r\n    }\r\n  },\r\n  branch: {\r\n    type: \"branch\",\r\n    content: \"\",\r\n    properties: {}\r\n  },\r\n  empty: {\r\n    type: \"empty\",\r\n    content: \"\",\r\n    properties: {}\r\n  }\r\n}","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PreviewT.vue?vue&type=style&index=0&id=0006e200&prod&lang=scss&scoped=true&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Preview.vue?vue&type=style&index=0&id=35f08b94&prod&lang=scss&scoped=true&\""],"sourceRoot":""}